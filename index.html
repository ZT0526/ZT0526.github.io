
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>Hexo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="ZT0526">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://zt0526.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">

    
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Hexo" title="Hexo"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Hexo">Hexo</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:zt0526.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/22/five/" title="IOSæ’­æ”¾GIFåŠ¨ç”»çš„æ–¹å¼åŠæ‰‹åŠ¨å®ç°gifåŠ¨ç”»çš„æ’­æ”¾" itemprop="url">IOSæ’­æ”¾GIFåŠ¨ç”»çš„æ–¹å¼åŠæ‰‹åŠ¨å®ç°gifåŠ¨ç”»çš„æ’­æ”¾</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ZT0526" target="_blank" itemprop="author">ZT0526</a>
		
  <p class="article-time">
    <time datetime="2017-08-22T03:49:21.000Z" itemprop="datePublished"> Published 2017-08-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>###å†™åœ¨å‰é¢:<br>   è§†é¢‘æˆ–è€…åŠ¨ç”»å…¶å®å°±æ˜¯å¤šä¸ªå¸§ï¼ˆå¤šä¸ªç”»é¢ï¼‰ç»„åˆèµ·æ¥å½¢æˆçš„ï¼Œè¿™ä¸ªå¸§æ•°è‡³å°‘è¦è¾¾åˆ°30å¸§æ¯ç§’(30fps)ï¼Œçœ‹èµ·æ¥æ‰ä¼šè§‰å¾—æ˜¯æ­£å¸¸çš„ï¼Œè§†è§‰ä¸Šçœ‹èµ·æ¥æ‰æ˜¯åŠ¨çš„</p>
<p>##æ–¹æ³•ä¸€ï¼šUIViewæ’­æ”¾åŠ¨ç”»<br>      ä½¿ç”¨UIViewçš„åŠ¨ç”»æ¥æ’­æ”¾gifï¼ŒåŸç†æ˜¯å°†gifæ‰€ä½¿ç”¨çš„æ‰€æœ‰å›¾ç‰‡åšæˆä¸€ä¸ªåŠ¨ç”»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">UIImageView *view = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];</div><div class="line">view.animationImages= @[[UIImage imageNamed:@&quot;yaoyiyao1.jpg&quot;],</div><div class="line">                        [UIImage imageNamed:@&quot;yaoyiyao2.jpg&quot;],</div><div class="line">                       [UIImage imageNamed:@&quot;yaoyiyao3.jpg&quot;],</div><div class="line">                        [UIImage imageNamed:@&quot;yaoyiyao4.jpg&quot;],</div><div class="line">                       [UIImage imageNamed:@&quot;yaoyiyao5.jpg&quot;]];</div><div class="line">view.animationDuration = 0.45;</div><div class="line">view.animationRepeatCount = 0;</div><div class="line">[self.view addSubview:view];</div><div class="line">[view startAnimating];</div></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹æ³•ç¡®å®èƒ½å¤Ÿè®©gifåŠ¨èµ·æ¥ï¼Œä½†æ˜¯ä¼šä½¿ç”¨å¤šå¼ å›¾ç‰‡ï¼Œè‹¥æœæˆ‘ä»¬æ˜¯æ ¹æ®gifçš„å›¾ç‰‡é“¾æ¥æ¥æ’­æ”¾åŠ¨ç”»çš„è¯ï¼Œè¿™ç§æ–¹å¼å°±ä¸è¡Œäº†ã€‚å¹¶ä¸”è¯¥æ–¹å¼ä¸èƒ½å®Œå…¨æ¨¡æ‹Ÿå‡ºgifçš„æ•ˆæœ(æ¯”å¦‚gifçš„æŸå¤„ä¼šæœ‰åœé¡¿ä¸€ä¸‹ï¼Œè¿™ä¸ªåœé¡¿çš„å¤šå°‘  è¿™é‡Œå°±ä¸å¥½æ¨¡æ‹Ÿäº†)ã€‚</p>
<p>##æ–¹æ³•äºŒï¼šUIWebViewæ’­æ”¾åŠ¨ç”»<br>    UIWebViewæ¥æ’­æ”¾åŠ¨ç”»æ¯”è¾ƒçœäº‹å„¿ï¼Œå¯ä»¥ç›´æ¥æ’­æ”¾æœ¬åœ°çš„gifæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ’­æ”¾gifç½‘ç»œå›¾ç‰‡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">//å¾—åˆ°å›¾ç‰‡çš„è·¯å¾„</div><div class="line">  NSString *path = [[NSBundle mainBundle] pathForResource:@&quot;yaoyiyao&quot; ofType:@&quot;gif&quot;];</div><div class="line">  //å°†å›¾ç‰‡è½¬ä¸ºNSData</div><div class="line">  NSData *gifData = [NSData dataWithContentsOfFile:path];</div><div class="line">  //åˆ›å»ºä¸€ä¸ªwebViewï¼Œæ·»åŠ åˆ°ç•Œé¢</div><div class="line">  UIWebView *webView = [[UIWebView alloc] initWithFrame:CGRectMake(self.view.width - 200,self.view.height -  200, 160, 105)];</div><div class="line">  [self.view addSubview:webView];</div><div class="line">  //è‡ªåŠ¨è°ƒæ•´å°ºå¯¸</div><div class="line">  webView.scalesPageToFit = YES;</div><div class="line">  //ç¦æ­¢æ»šåŠ¨</div><div class="line">  webView.scrollView.scrollEnabled = NO;</div><div class="line">  //è®¾ç½®é€æ˜æ•ˆæœ</div><div class="line">  webView.backgroundColor = [UIColor clearColor];</div><div class="line">  webView.opaque = 0;</div><div class="line">  //åŠ è½½æ•°æ®</div><div class="line">  [webView loadData:gifData MIMEType:@&quot;image/gif&quot; textEncodingName:nil baseURL:nil];</div></pre></td></tr></table></figure></p>
<p>æ’­æ”¾gifç½‘ç»œå›¾ç‰‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];</div><div class="line">[_webView loadRequest:request];</div></pre></td></tr></table></figure></p>
<p>è¿™ç§æ–¹æ³•æ¥æ’­æ”¾gifè™½ç„¶èƒ½å¾ˆå¥½çš„æ’­æ”¾gifï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ã€‚ç‰¹åˆ«æ˜¯åœ¨gifå±•ç¤ºçš„å¤§å°ä¸Šè¾¾ä¸åˆ°å¾ˆå¥½çš„æ•ˆæœï¼Œå½“webViewæ¯”è¾ƒå°çš„æ—¶å€™ï¼Œgifæ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¸èƒ½å®Œæ•´çš„å°†gifå±•ç¤ºå‡ºæ¥</p>
<p>##æ–¹æ³•ä¸‰ï¼šä½¿ç”¨SDWebImage<br>   SDWebImageæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„ä¸‰æ–¹åº“ï¼Œèƒ½å¤Ÿå¼‚æ­¥çš„åŠ è½½å›¾ç‰‡å¹¶æä¾›äº†å®Œæ•´çš„å›¾ç‰‡çš„ä¸‹è½½ã€å­˜å‚¨ã€ç­‰äºå›¾ç‰‡ä¸‹è½½ç›¸å…³çš„åŠŸèƒ½æœåŠ¡ï¼ŒåŸºæœ¬ä¸Šå¾ˆå¤šåº”ç”¨éƒ½ä¼šä½¿ç”¨è¯¥ä¸‰æ–¹åº“ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[self.bgImageView sd_setImageWithURL:[NSURL URLWithString:self.model.picHomeUrl]];</div></pre></td></tr></table></figure></p>
<p>è¿™ç§æ–¹å¼ä¹Ÿä¼šæœ‰ç¼ºé™·ï¼Œæœ‰æ—¶å€™ä¸‹è½½ä¸‹æ¥çš„gifåŠ¨ä¸äº†ï¼å±…ç„¶åŠ¨ä¸äº†ï¼ã€‚(æœ‰å¯èƒ½æ˜¯æˆ‘ä½¿ç”¨çš„SDWebImageä¸æ˜¯æœ€æ–°çš„)</p>
<p>##æ–¹æ³•å››ï¼šä½¿ç”¨YLGIFImage<br><a href="https://github.com/liyong03/YLGIFImage" target="_blank" rel="external">YLGIFImage</a>æŸä¸ªå¤–å›½äººå†™çš„ä¸‰æ–¹åº“ï¼Œè¯¥åº“ä¸­å°±ä¸¤ä¸ªç±»YLGImageViewã€YLGIFImageã€‚æ˜¯ä¸“é—¨ç”¨æ¥æ’­æ”¾gifçš„ã€‚<br>é¦–å…ˆä½¿ç”¨NSURLSessionä¸‹è½½ç½‘ç»œå›¾ç‰‡ï¼Œä¸‹è½½å®Œæˆåå†åœ¨ä¸»çº¿ç¨‹ä¸­å»å±•ç¤ºgif<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"> NSURL *url = [NSURL URLWithString:self.model.picHomeUrl];</div><div class="line">        NSURLRequest *reque = [NSURLRequest requestWithURL:url];</div><div class="line">        NSURLSession *session = [NSURLSession sessionWithConfiguration:[NSURLSessionConfiguration ephemeralSessionConfiguration]];</div><div class="line">        NSURLSessionDownloadTask *task = [session downloadTaskWithRequest:reque completionHandler:^(NSURL *location, NSURLResponse *response, NSError *error) &#123;</div><div class="line">            NSLog(@&quot;%@&quot;, location);</div><div class="line">            if(error)&#123;</div><div class="line">                [self performSelectorOnMainThread:@selector(handleError:) withObject:error waitUntilDone:YES];</div><div class="line">            &#125;else&#123;</div><div class="line">                NSData *data = [NSData dataWithContentsOfURL:location];</div><div class="line">                [self performSelectorOnMainThread:@selector(setBgViewData:)</div><div class="line">                                       withObject:data</div><div class="line">                                    waitUntilDone:YES];</div><div class="line">            &#125;</div><div class="line">        &#125;];  </div><div class="line">        [task resume];  </div><div class="line"></div><div class="line">- (void)setBgViewData:(NSData *)data&#123;</div><div class="line">    [MBProgressHUD hideAllHUDsForView:self.bgImageView animated:YES];</div><div class="line">    [UIView animateWithDuration:0.2f animations:^&#123;</div><div class="line">       self.bgImageView.image = [YLGIFImage imageWithData:data];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)handleError:(NSError *)error&#123;</div><div class="line">    [MBProgressHUD hideAllHUDsForView:self.bgImageView animated:YES];</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨è¿™ç§æ–¹æ³•èƒ½å®Œç¾è§£å†³gifæ’­æ”¾çš„é—®é¢˜ã€‚æˆ‘åœ¨ç¼–è¯‘çš„æ—¶å€™é‡åˆ°è¿‡è¿™ä¸ªåœ°æ–¹æŠ¥é”™ï¼Œå°† [(UIImage <em>)[self.images objectAtIndex:0] size];æ”¹æˆ [(UIImage </em>)[self.images objectAtIndex:0] size];å°±å¯ä»¥äº†</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-571cc10fe5172a62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="55EA5F7F-B633-4EB0-94A3-2914050AB7BE.png"></p>
<p>ä½†æ˜¯ä½¿ç”¨YLGIFImageçš„æ—¶å€™  ä¼šåœ¨ios7ç³»ç»Ÿä¸Šå‡ºç°å¶ç°çš„å´©æºƒç°è±¡ã€‚æ‰€ä»¥è¿™ç§æ–¹æ³•è¿˜æ˜¯ä¸æ€ä¹ˆå¯å–ã€‚ğŸ˜”</p>
<p>##æ–¹æ³•äº”ï¼šä½¿ç”¨YYWebImage<br><a href="https://github.com/ibireme/YYWebImage" target="_blank" rel="external">YYWebImage</a>  æ˜¯ä¸€ä¸ªå¼‚æ­¥å›¾ç‰‡åŠ è½½æ¡†æ¶ (YYKit ç»„ä»¶ä¹‹ä¸€).å…·æœ‰è¯¸å¤šä¼˜ç‚¹ã€‚<br>æ”¯æŒå¼‚æ­¥çš„å›¾ç‰‡åŠ è½½ï¼Œ HTTP å’Œæœ¬åœ°æ–‡ä»¶ã€‚æ”¯æŒ GIFã€APNGã€WebP åŠ¨ç”»ï¼ˆåŠ¨æ€ç¼“å­˜ï¼Œä½å†…å­˜å ç”¨ï¼‰ã€‚é€‚ç”¨äºios6åŠä»¥ä¸Šçš„ç³»ç»Ÿï¼Œç»è¿‡å¤§é‡çš„ä½¿ç”¨ï¼Œç¨³å®šæ€§è¾ƒé«˜.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">ä» URL åŠ è½½å›¾ç‰‡</div><div class="line">// åŠ è½½ç½‘ç»œå›¾ç‰‡</div><div class="line">imageView.yy_imageURL = [NSURL URLWithString:@&quot;http://github.com/logo.png&quot;];</div><div class="line"></div><div class="line">// åŠ è½½æœ¬åœ°å›¾ç‰‡</div><div class="line">imageView.yy_imageURL = [NSURL fileURLWithPath:@&quot;/tmp/logo.png&quot;];</div><div class="line">åŠ è½½åŠ¨å›¾</div><div class="line"></div><div class="line">// åªéœ€è¦æŠŠ `UIImageView` æ›¿æ¢ä¸º `YYAnimatedImageView` å³å¯ã€‚</div><div class="line">UIImageView *imageView = [YYAnimatedImageView new];</div><div class="line">imageView.yy_imageURL = [NSURL URLWithString:@&quot;http://github.com/ani.webp&quot;];</div><div class="line">æ¸è¿›å¼å›¾ç‰‡åŠ è½½</div><div class="line"></div><div class="line">// æ¸è¿›å¼ï¼šè¾¹ä¸‹è½½è¾¹æ˜¾ç¤º</div><div class="line">[imageView yy_setImageWithURL:url options:YYWebImageOptionProgressive];</div><div class="line"></div><div class="line">// æ¸è¿›å¼åŠ è½½ï¼Œå¢åŠ æ¨¡ç³Šæ•ˆæœå’Œæ¸å˜åŠ¨ç”» ï¼ˆè§æœ¬é¡µæœ€ä¸Šæ–¹çš„GIFæ¼”ç¤ºï¼‰</div><div class="line">[imageView yy_setImageWithURL:url options:YYWebImageOptionProgressiveBlur ï½œ YYWebImageOptionSetImageWithFadeAnimation];</div><div class="line">åŠ è½½ã€å¤„ç†å›¾ç‰‡</div><div class="line"></div><div class="line">// 1. ä¸‹è½½å›¾ç‰‡</div><div class="line">// 2. è·å¾—å›¾ç‰‡ä¸‹è½½è¿›åº¦</div><div class="line">// 3. è°ƒæ•´å›¾ç‰‡å¤§å°ã€åŠ åœ†è§’</div><div class="line">// 4. æ˜¾ç¤ºå›¾ç‰‡æ—¶å¢åŠ ä¸€ä¸ªæ·¡å…¥åŠ¨ç”»ï¼Œä»¥è·å¾—æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</div><div class="line"></div><div class="line">[imageView yy_setImageWithURL:url</div><div class="line">    placeholder:nil</div><div class="line">    options:YYWebImageOptionSetImageWithFadeAnimation</div><div class="line">    progress:^(NSInteger receivedSize, NSInteger expectedSize) &#123;</div><div class="line">        progress = (float)receivedSize / expectedSize;</div><div class="line">    &#125;</div><div class="line">    transform:^UIImage *(UIImage *image, NSURL *url) &#123;</div><div class="line">        image = [image yy_imageByResizeToSize:CGSizeMake(100, 100) contentMode:UIViewContentModeCenter];</div><div class="line">        return [image yy_imageByRoundCornerRadius:10];</div><div class="line">    &#125;</div><div class="line">    completion:^(UIImage *image, NSURL *url, YYWebImageFromType from, YYWebImageStage stage, NSError *error) &#123;</div><div class="line">        if (from == YYWebImageFromDiskCache) &#123;</div><div class="line">            NSLog(@&quot;load from disk cache&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">å›¾ç‰‡ç¼“å­˜</div><div class="line"></div><div class="line">YYImageCache *cache = [YYWebImageManager sharedManager].cache;</div><div class="line"></div><div class="line">// è·å–ç¼“å­˜å¤§å°</div><div class="line">cache.memoryCache.totalCost;</div><div class="line">cache.memoryCache.totalCount;</div><div class="line">cache.diskCache.totalCost;</div><div class="line">cache.diskCache.totalCount;</div><div class="line"></div><div class="line">// æ¸…ç©ºç¼“å­˜</div><div class="line">[cache.memoryCache removeAllObjects];</div><div class="line">[cache.diskCache removeAllObjects];</div><div class="line"></div><div class="line">// æ¸…ç©ºç£ç›˜ç¼“å­˜ï¼Œå¸¦è¿›åº¦å›è°ƒ</div><div class="line">[cache.diskCache removeAllObjectsWithProgressBlock:^(int removedCount, int totalCount) &#123;</div><div class="line">    // progress</div><div class="line">&#125; endBlock:^(BOOL error) &#123;</div><div class="line">    // end</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>æ‰‹åŠ¨æ·»åŠ çš„æ—¶å€™ å¦‚æœä¸ä½¿ç”¨webp  é™¤äº†å°†YYWebImageæ‹–å…¥é¡¹ç›®ä¸­å¤–ï¼Œè¿˜éœ€è¦å°†#define YYIMAGE_WEBP_ENABLED 1æ”¹ä¸º#define YYIMAGE_WEBP_ENABLED 0   æˆ‘è§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¾ˆæœºæ™ºçš„å†™æ³•, æœ‰çš„ç±»æ–‡ä»¶ä¸­é€šè¿‡åˆ¤æ–­è¿™ä¸ªå®å®šä¹‰æ¥ç¡®å®šæ˜¯å¦ç¼–è¯‘æ”¯æŒwebpçš„æ–¹æ³•</p>
<p>æˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æ¢è®¨ä¸€ä¸‹ iosåŠ è½½gifåŠ¨ç”»çš„åŸç†</p>
<p>è¿™é‡Œæ˜¯è®²è§£iosæ’­æ”¾gifåŠ¨ç”»åŸç†çš„ä»£ç <a href="https://github.com/ZT0526/Gif-Animation" target="_blank" rel="external">https://github.com/ZT0526/Gif-Animation</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/22/fourthArticle/" title="IOSè‡ªå®šä¹‰ç›¸æœº,ä½¿ç”¨AVFoundation(é™„å®ç°éƒ¨åˆ†è…¾è®¯æ°´å°ç›¸æœºåŠŸèƒ½demo)" itemprop="url">IOSè‡ªå®šä¹‰ç›¸æœº,ä½¿ç”¨AVFoundation(é™„å®ç°éƒ¨åˆ†è…¾è®¯æ°´å°ç›¸æœºåŠŸèƒ½demo)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ZT0526" target="_blank" itemprop="author">ZT0526</a>
		
  <p class="article-time">
    <time datetime="2017-08-22T03:48:39.000Z" itemprop="datePublished"> Published 2017-08-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>åœ¨é¡¹ç›®ä¸­å½“æˆ‘ä»¬é‡åˆ°æ‹ç…§çš„åŠŸèƒ½æ¨¡å—çš„æ—¶å€™ï¼Œå¦‚æœä»…ä»…æ˜¯ç”¨æ¥æ‹ç…§ï¼Œç³»ç»Ÿæä¾›çš„UIImagePickerControllerè¶³å¤Ÿç”¨æ¥å®Œæˆæˆ‘ä»¬çš„ä»»åŠ¡ã€‚ä½†æ˜¯å½“æˆ‘ä»¬çš„åº”ç”¨åœºæ™¯ç¨ç¨å¤æ‚ç‚¹çš„æ—¶å€™ï¼Œå¦‚è¦å®ç°ç±»ä¼¼æ°´å°ç›¸æœºã€ç¾é¢œç›¸æœºçš„æ—¶å€™ï¼ŒUIImagePickerControllerå°±æœ‰ç‚¹åŠ›ä¸ä»å¿ƒäº†ï¼Œéœ€è¦è‡ªå·±å»diyä¸€ä¸ªè‡ªå®šä¹‰ç›¸æœºã€‚</p>
<p>UIImagePickerControllerä½¿ç”¨èµ·æ¥æ¯”è¾ƒç®€å•æ˜“ç”¨ï¼Œæ‹ç…§ï¼Œå½•åˆ¶è§†é¢‘ã€æ§åˆ¶é—ªå…‰ç¯ï¼Œå‰åæ‘„åƒå¤´çš„åˆ‡æ¢ä¸€åº”ä¿±å…¨ã€‚ä½†æ˜¯ç›¸æœºæ”¯æŒuiç•Œé¢çš„è‡ªå®šä¹‰å¹¶ä¸å¥½(è™½ç„¶å¯ä»¥æ”¯æŒè‡ªå®šä¹‰)ï¼Œåœ¨ä¸åŒçš„ç³»ç»Ÿä¸‹ç›¸æœºçš„åŠŸèƒ½ç•Œé¢è¿˜æœ‰æ‰€å·®åˆ«ã€‚</p>
<p>ä»¥æ°´å°ç›¸æœºä¸ºä¾‹ï¼Œåœ¨æ°´å°ç›¸æœºä¸­æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿè®©æ°´å°æ¨¡å¼å®æ—¶çš„æ˜¾ç¤ºåœ¨ç›¸æœºçš„å–æ™¯æ¡†ä¸­ï¼Œè€Œä¸”æ°´å°æ¨¡å¼è¿˜è¦å¯ä»¥å·¦å³æ»‘åŠ¨åˆ‡æ¢ï¼Œåœ¨æ¨ªå±çš„æ—¶å€™æ°´å°ä¹Ÿè¦è·Ÿç€æ¨ªå±ï¼Œè¿˜è¦æœ‰æ”¾å¤§ç¼©å°é•œå¤´çš„ä»¥åŠç‚¹å‡»å±å¹•èƒ½å¤Ÿèšç„¦ç­‰åŠŸèƒ½ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-12ea92d5ec98730c.gif?imageMogr2/auto-orient/strip" alt="è…¾è®¯æ°´å°ç›¸æœº.gif"></p>
<p>å½“ç„¶æœ‰äººå¯èƒ½ä¼šæƒ³ï¼Œå°†æ°´å°æ¨¡å¼åˆ†æˆä¸€ä¸ªè§†å›¾å±‚ç„¶åæ”¾åˆ°ç›¸æœºçš„æœ€ä¸Šå±‚ä¸å°±è¡Œäº†å—ï¼Ÿå½“ç„¶æ˜¯ä¸è¡Œçš„ï¼Œé¦–å…ˆUIImagePickerControlleråœ¨ä¸åŒç³»ç»Ÿä¸­çš„å°è£…æ˜¯ç•¥å¾®ä¸ä¸€æ ·çš„ï¼Œuiç•Œé¢æœ‰æ‰€å·®åˆ«ï¼Œç•Œé¢ä¸èƒ½å¤Ÿç»Ÿä¸€ï¼Œå³ä¾¿æ˜¯ç°åœ¨èŠ±äº†å¾ˆè¿‡ä»£ç ä¸€ä¸ªç³»ç»Ÿä¸€ä¸ªç³»ç»Ÿçš„é€‚é…ï¼Œä¹Ÿå¾ˆéš¾ä¿è¯ä»¥åä¸å‡ºé—®é¢˜ï¼Œå…¶æ¬¡æ˜¯æ‰‹åŠ¿çš„è¯†åˆ«ä¹Ÿæœ‰é—®é¢˜ï¼Œå³ä¾¿æ˜¯å¯¹æ‰‹åŠ¿è¿›è¡Œäº†æ‹¦æˆªå¤„ç†ï¼Œä¹Ÿä¸èƒ½è§£å†³ï¼Œè¯´ç™½äº†ä¹Ÿå°±æ˜¯ä¸æ˜¯è‡ªå·±å°è£…çš„ä¸œè¥¿ï¼Œéš¾ä»¥å¾—åˆ°å®Œç¾çš„æŒæ§ã€‚</p>
<p>ä¸‹é¢å°±å¼€å§‹è‡ªå®šä¹‰ä¸€ä¸ªç›¸æœºï¼Œå¹¶å®ç°æ‹ç…§ã€å–æ¶ˆã€é—ªå…‰ç¯æ§åˆ¶ã€å‰åæ‘„åƒå¤´æ§åˆ¶ã€èšç„¦ã€æ”¾å¤§ç¼©å°ã€æ‹ç…§åé¢„è§ˆã€é‡æ‹ã€ä½¿ç”¨ç…§ç‰‡ç­‰åŠŸèƒ½ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@property (nonatomic, strong) ZTImagePickerOverLayView  *overlayView;//é¢„è§ˆå›¾å±‚</div><div class="line"></div><div class="line">@property (nonatomic) dispatch_queue_t sessionQueue;</div><div class="line"></div><div class="line">@property (nonatomic, strong) AVCaptureSession* session;//ç”¨äºæ•æ‰è§†é¢‘å’ŒéŸ³é¢‘,åè°ƒè§†é¢‘å’ŒéŸ³é¢‘çš„è¾“å…¥å’Œè¾“å‡ºæµ</div><div class="line"></div><div class="line">@property (nonatomic, strong) AVCaptureDeviceInput* videoInput;</div><div class="line"></div><div class="line">@property (nonatomic, strong) AVCaptureStillImageOutput* stillImageOutput;//è¾“å‡ºé™æ€å½±åƒ</div><div class="line"></div><div class="line">@property (nonatomic, strong) AVCaptureDevice             *device;//ä¸»è¦ç”¨æ¥è·å–iphoneä¸€äº›å…³äºç›¸æœºè®¾å¤‡çš„å±æ€§</div><div class="line">@property (nonatomic, strong) AVCaptureVideoPreviewLayer* previewLayer;//é¢„è§ˆå›¾å±‚layer</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œå°†ç›¸æœºçš„æ§ä»¶ä»¥åŠç›¸æœºçš„å®æ—¶æ˜¾ç¤ºçš„å›¾å±‚æ”¾åœ¨ä¸€ä¸ªè§†å›¾ç±»ZTImagePickerOverLayViewä¸­ï¼Œæ‹å®Œç…§åçš„å›¾å±‚æ”¾åœ¨å¦å¤–ä¸€ä¸ªç±»ZTImagePickerPreImageViewä¸­,å„ä¸ªè§†å›¾é—´çš„åè°ƒåŠéƒ¨åˆ†é€»è¾‘æ”¾åœ¨æ§åˆ¶å™¨ä¸­ZTImagePickerControllerã€‚å°è£…å®Œæ•´ä¸ªç›¸æœºä¸è¿‡ç”¨äº†å‡ ç™¾è¡Œä»£ç ã€‚</p>
<p>1.åˆå§‹åŒ–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">self.session = [[AVCaptureSession alloc] init];</div><div class="line">   [self.session setSessionPreset:AVCaptureSessionPresetPhoto];</div><div class="line">   </div><div class="line">   NSError *error;</div><div class="line">   </div><div class="line">   self.device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];</div><div class="line">   </div><div class="line">   </div><div class="line">   self.videoInput = [[AVCaptureDeviceInput alloc] initWithDevice:self.device error:&amp;error];</div><div class="line">  </div><div class="line">   self.stillImageOutput = [[AVCaptureStillImageOutput alloc] init];</div><div class="line">   //è¾“å‡ºè®¾ç½®ã€‚AVVideoCodecJPEG   è¾“å‡ºjpegæ ¼å¼å›¾ç‰‡</div><div class="line">   NSDictionary * outputSettings = [[NSDictionary alloc] initWithObjectsAndKeys:AVVideoCodecJPEG,AVVideoCodecKey, nil];</div><div class="line">   [self.stillImageOutput setOutputSettings:outputSettings];</div><div class="line">   </div><div class="line">   if ([self.session canAddInput:self.videoInput]) &#123;</div><div class="line">       [self.session addInput:self.videoInput];</div><div class="line">   &#125;</div><div class="line">   if ([self.session canAddOutput:self.stillImageOutput]) &#123;</div><div class="line">       [self.session addOutput:self.stillImageOutput];</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   //åˆå§‹åŒ–é¢„è§ˆå›¾å±‚</div><div class="line">   self.previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:self.session];</div><div class="line">   [self.previewLayer setVideoGravity:AVLayerVideoGravityResizeAspect];</div><div class="line">   NSLog(@&quot;%f&quot;,ScreenWidth);</div><div class="line">   self.previewLayer.frame = CGRectMake(0, 0,ScreenWidth, ScreenHeight);</div><div class="line">   self.preview = [[ZTImagePickerOverLayView alloc] init];</div><div class="line">   self.preview.frame = CGRectMake(0, 0, ScreenWidth, ScreenHeight);</div><div class="line">   [self.preview layoutSubviews];</div><div class="line">   [self.preview.layer addSublayer:self.previewLayer];</div><div class="line">   [self.view addSubview:self.preview];</div><div class="line">   </div><div class="line">   //æ·»åŠ é¡¶éƒ¨ä»¥åŠåº•éƒ¨çš„è‡ªå®šä¹‰å·¥å…·æ¡</div><div class="line">   [self.view addSubview:self.preview.topbar];</div><div class="line">   [self.view addSubview:self.preview.buttomBar];</div><div class="line">   self.preview.topbar.frame = CGRectMake(0, 0, self.view.width, 64 * ScreenWidth/320.0);</div><div class="line">   self.preview.buttomBar.frame = CGRectMake(0, self.view.height - 70 * ScreenWidth/320.0 , self.view.width, 70* ScreenWidth/320.0);</div><div class="line">   [self.preview layoutSubviews];</div><div class="line">   //è®¾ç½®é—ªå…³ç¯æ¨¡å¼</div><div class="line">   if(self.device.isFlashAvailable)</div><div class="line">       [self.preview setFlashModel:self.device.flashMode];</div><div class="line">   else&#123;</div><div class="line">       self.preview.flashButton.hidden = YES;</div><div class="line">       self.preview.cameraSwitchButton.hidden = YES;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   //è®¾ç½®æ‹ç…§åé¢„è§ˆå›¾å±‚</div><div class="line">   self.preImageView = [[ZTImagePickerPreImageView alloc] initWithFrame:CGRectMake(0, 0, ScreenWidth, ScreenHeight)];</div><div class="line">   [self.preImageView layoutSubviews];</div><div class="line">   self.preImageView.hidden = YES;</div><div class="line">   [self.view addSubview:self.preImageView];</div></pre></td></tr></table></figure></p>
<p>2.æ·»åŠ æ‰‹åŠ¿<br>ç»™é¢„è§ˆå±‚æ·»åŠ æåˆæ‰‹åŠ¿æ§åˆ¶æ”¾å¤§ç¼©å°,æ·»åŠ ç‚¹å‡»æ‰‹åŠ¿æ¥èšç„¦<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">UIPinchGestureRecognizer *pinch = [[UIPinchGestureRecognizer alloc] initWithTarget:self</div><div class="line">                                                                               action:@selector(handlePinchGesture:)];</div><div class="line">   pinch.delegate = self;</div><div class="line">   [self.preview addGestureRecognizer:pinch];</div><div class="line">   </div><div class="line">   </div><div class="line">   UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self</div><div class="line">                                                                         action:@selector(focusAction:)];</div><div class="line">   [self.preview addGestureRecognizer:tap];</div></pre></td></tr></table></figure></p>
<p>3.ç»™æ§ä»¶æ·»åŠ å“åº”äº‹ä»¶<br>é—ªå…‰ç¯æ‰“å¼€ã€å…³é—­ã€è‡ªåŠ¨ï¼Œæ‘„åƒå¤´åˆ‡æ¢ã€å–æ¶ˆã€æ‹ç…§ã€é‡æ–°æ‹ç…§ã€ä½¿ç”¨ç…§ç‰‡ç­‰æŒ‰é’®æ·»åŠ å“åº”äº‹ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[self.preview.cameraSwitchButton addTarget:self action:@selector(switchCameraSegmentedControlClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    [self.preview.flashAutoButton addTarget:self action:@selector(flashButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    [self.preview.flashOpeanButton addTarget:self action:@selector(flashButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    [self.preview.flashCloseButton addTarget:self action:@selector(flashButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    </div><div class="line">    [self.preview.takePictureButton addTarget:self action:@selector(takePhotoButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    </div><div class="line">    [self.preview.cancelButton addTarget:self action:@selector(cancelButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    </div><div class="line">    [self.preImageView.reTakeButton addTarget:self action:@selector(retakeButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    [self.preImageView.useImageButton addTarget:self action:@selector(useImageButtonClick:) forControlEvents:UIControlEventTouchUpInside];</div></pre></td></tr></table></figure></p>
<p>4.é—ªå…‰ç¯æ§åˆ¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">- (void)flashButtonClick:(UIButton *)sender &#123;</div><div class="line">    //[self.preview reSetTopbar];</div><div class="line">    [self.preview chosedFlashButton:sender];</div><div class="line">    </div><div class="line">    NSLog(@&quot;flashButtonClick&quot;);</div><div class="line">    </div><div class="line">    AVCaptureDevice *device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];</div><div class="line">    </div><div class="line">    //ä¿®æ”¹å‰å¿…é¡»å…ˆé”å®š</div><div class="line">    [device lockForConfiguration:nil];</div><div class="line">    //å¿…é¡»åˆ¤å®šæ˜¯å¦æœ‰é—ªå…‰ç¯ï¼Œå¦åˆ™å¦‚æœæ²¡æœ‰é—ªå…‰ç¯ä¼šå´©æºƒ</div><div class="line">    if ([device hasFlash]) &#123;</div><div class="line">        if([sender.titleLabel.text isEqualToString:@&quot;æ‰“å¼€&quot;])&#123;</div><div class="line">            if([device isFlashModeSupported:AVCaptureFlashModeOn])</div><div class="line">                [device setFlashMode:AVCaptureFlashModeOn];</div><div class="line">        &#125;else if ([sender.titleLabel.text isEqualToString:@&quot;è‡ªåŠ¨&quot;])&#123;</div><div class="line">            if([device isFlashModeSupported:AVCaptureFlashModeAuto])</div><div class="line">                [device setFlashMode:AVCaptureFlashModeAuto];</div><div class="line">            </div><div class="line">        &#125;else if ([sender.titleLabel.text isEqualToString:@&quot;å…³é—­&quot;])&#123;</div><div class="line">            if([device isFlashModeSupported:AVCaptureFlashModeOff])</div><div class="line">                [device setFlashMode:AVCaptureFlashModeOff];</div><div class="line">        &#125;</div><div class="line">    &#125; else &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;è®¾å¤‡ä¸æ”¯æŒé—ªå…‰ç¯&quot;);</div><div class="line">    &#125;</div><div class="line">    [device unlockForConfiguration];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5.å‰åæ‘„åƒå¤´åˆ‡æ¢<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">- (void)switchCameraSegmentedControlClick:(id)sender &#123;</div><div class="line">    </div><div class="line">    //NSLog(@&quot;%ld&quot;,(long)sender.selectedSegmentIndex);</div><div class="line">    </div><div class="line">    AVCaptureDevicePosition desiredPosition;</div><div class="line">    AVCaptureDevice *device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];</div><div class="line">    if (isUsingFrontFacingCamera)&#123;</div><div class="line">        </div><div class="line">        if(device.isFlashAvailable) self.preview.flashButton.hidden = NO;</div><div class="line">        desiredPosition = AVCaptureDevicePositionBack;</div><div class="line">        </div><div class="line">    &#125;else&#123;</div><div class="line">        desiredPosition = AVCaptureDevicePositionFront;</div><div class="line">        [self.preview reSetTopbar];</div><div class="line">        self.preview.flashButton.hidden = YES;</div><div class="line">        </div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    for (AVCaptureDevice *d in [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo]) &#123;</div><div class="line">        if ([d position] == desiredPosition) &#123;</div><div class="line">            [self.previewLayer.session beginConfiguration];</div><div class="line">            AVCaptureDeviceInput *input = [AVCaptureDeviceInput deviceInputWithDevice:d error:nil];</div><div class="line">            for (AVCaptureInput *oldInput in self.previewLayer.session.inputs) &#123;</div><div class="line">                [[self.previewLayer session] removeInput:oldInput];</div><div class="line">            &#125;</div><div class="line">            [self.previewLayer.session addInput:input];</div><div class="line">            [self.previewLayer.session commitConfiguration];</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    isUsingFrontFacingCamera = !isUsingFrontFacingCamera;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>6.æ‹ç…§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">- (void)takePhotoButtonClick:(id )sender&#123;</div><div class="line">    </div><div class="line">    AVCaptureConnection *stillImageConnection = [self.stillImageOutput connectionWithMediaType:AVMediaTypeVideo];</div><div class="line">    UIDeviceOrientation curDeviceOrientation = [[UIDevice currentDevice] orientation];</div><div class="line">    AVCaptureVideoOrientation avcaptureOrientation = [self avOrientationForDeviceOrientation:curDeviceOrientation];</div><div class="line">    [stillImageConnection setVideoOrientation:avcaptureOrientation];</div><div class="line">    [stillImageConnection setVideoScaleAndCropFactor:self.effectiveScale];</div><div class="line">    </div><div class="line">    [self.stillImageOutput captureStillImageAsynchronouslyFromConnection:stillImageConnection completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, NSError *error) &#123;</div><div class="line">        </div><div class="line">        NSData *jpegData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageDataSampleBuffer];</div><div class="line">        self.imageData = jpegData;</div><div class="line">        CFDictionaryRef attachments = CMCopyDictionaryOfAttachments(kCFAllocatorDefault,</div><div class="line">                                                                    imageDataSampleBuffer,</div><div class="line">                                                                    kCMAttachmentMode_ShouldPropagate);</div><div class="line">        UIImage *image = [UIImage imageWithData:jpegData];</div><div class="line">        [self waterMarkFixed];</div><div class="line">        self.preImageView.imageView.image = image;</div><div class="line">        [self.preview hiddenSelfAndBars:YES];</div><div class="line">        self.preImageView.hidden = NO;</div><div class="line">        </div><div class="line">        ALAuthorizationStatus author = [ALAssetsLibrary authorizationStatus];</div><div class="line">            if (author == ALAuthorizationStatusRestricted || author ==ALAuthorizationStatusDenied)&#123;</div><div class="line">                    //æ— æƒé™</div><div class="line">                    return ;</div><div class="line">                &#125;</div><div class="line">        //ä¿å­˜åˆ°ç›¸å†Œ</div><div class="line">//            ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];</div><div class="line">//            [library writeImageDataToSavedPhotosAlbum:jpegData metadata:(__bridge id)attachments completionBlock:^(NSURL *assetURL, NSError *error) &#123;</div><div class="line">//        </div><div class="line">//            &#125;];</div><div class="line">        </div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    if([self.delegate respondsToSelector:@selector(imagePickerControllerTakePhoto:)])</div><div class="line">        [self.delegate imagePickerControllerTakePhoto:self];</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>7.æ”¾å¤§ç¼©å°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">- (void)handlePinchGesture:(UIPinchGestureRecognizer *)recognizer&#123;</div><div class="line">    </div><div class="line">    BOOL allTouchesAreOnThePreviewLayer = YES;</div><div class="line">    NSUInteger numTouches = [recognizer numberOfTouches], i;</div><div class="line">    for ( i = 0; i &lt; numTouches; ++i ) &#123;</div><div class="line">        CGPoint location = [recognizer locationOfTouch:i inView:self.preview];</div><div class="line">        CGPoint convertedLocation = [self.previewLayer convertPoint:location fromLayer:self.previewLayer.superlayer];</div><div class="line">        if ( ! [self.previewLayer containsPoint:convertedLocation] ) &#123;</div><div class="line">            allTouchesAreOnThePreviewLayer = NO;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if ( allTouchesAreOnThePreviewLayer ) &#123;</div><div class="line">        </div><div class="line">        </div><div class="line">        self.effectiveScale = self.beginGestureScale * recognizer.scale;</div><div class="line">        if (self.effectiveScale &lt; 1.0)&#123;</div><div class="line">            self.effectiveScale = 1.0;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        CGFloat maxScaleAndCropFactor = [[self.stillImageOutput connectionWithMediaType:AVMediaTypeVideo] videoMaxScaleAndCropFactor];</div><div class="line">        </div><div class="line">        </div><div class="line">        if (self.effectiveScale &gt; maxScaleAndCropFactor)</div><div class="line">            self.effectiveScale = maxScaleAndCropFactor;</div><div class="line">        </div><div class="line">        [CATransaction begin];</div><div class="line">        [CATransaction setAnimationDuration:.025];</div><div class="line">        [self.previewLayer setAffineTransform:CGAffineTransformMakeScale(self.effectiveScale, self.effectiveScale)];</div><div class="line">        [CATransaction commit];</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>8.ç…§ç‰‡æ–¹å‘ä¿®æ­£<br>æ‹å®Œç…§çš„æ—¶å€™ï¼Œæ‹å‡ºçš„ç…§ç‰‡ä½ ä¼šå‘ç°å‘ˆç°çš„æ–¹å‘ä¸å¯¹ï¼Œéœ€è¦å¯¹ç…§ç‰‡çš„æ–¹å‘è¿›è¡Œä¿®æ­£ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> AVCaptureVideoOrientation avcaptureOrientation = [self avOrientationForDeviceOrientation:curDeviceOrientation];</div><div class="line">    [stillImageConnection setVideoOrientation:avcaptureOrientation];</div><div class="line"></div><div class="line">- (AVCaptureVideoOrientation)avOrientationForDeviceOrientation:(UIDeviceOrientation)deviceOrientation</div><div class="line">&#123;</div><div class="line">    AVCaptureVideoOrientation result = (AVCaptureVideoOrientation)deviceOrientation;</div><div class="line">    if ( deviceOrientation == UIDeviceOrientationLandscapeLeft )</div><div class="line">        result = AVCaptureVideoOrientationLandscapeRight;</div><div class="line">    else if ( deviceOrientation == UIDeviceOrientationLandscapeRight )</div><div class="line">        result = AVCaptureVideoOrientationLandscapeLeft;</div><div class="line">    return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœæƒ³è¦æ‹å®Œç…§çš„æ•ˆæœå’ŒUIimagePickerControllerçš„æ•ˆæœä¸€æ ·ï¼Œå³åœ¨æ¨ªå±ä¸‹æ‹å®Œç…§ï¼Œç…§ç‰‡è¦æ—‹è½¬æ˜¾ç¤ºå¹¶ä¸”æ˜¾ç¤ºçš„å°ä¸€äº›ï¼Œé‚£ä¹ˆå°±è¦å¯¹æ‹å®Œç…§é¢„è§ˆå›¾å±‚è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>å›¾ç‰‡</p>
<p>åœ¨é¢„è§ˆå›¾å±‚ä¸­ä¿®æ”¹imageviewçš„å¤§å°ã€‚(è¿™éƒ¨åˆ†ä»£ç æˆ‘å¹¶æ²¡æœ‰åŠ åˆ°demoä¸­ï¼Œå¦‚æœæƒ³å®ç°æ‹å®Œç…§åç…§ç‰‡çš„æ–¹å‘ä¸ç³»ç»Ÿç›¸æœºçš„ä¸€æ ·ï¼Œå¯ä»¥åœ¨ZTImagePickerPreImageViewä¸­åŠ ä¸Š)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (void)changeImageViewFrameIfNeeded:(UIDeviceOrientation)orientation&#123;</div><div class="line">    if(orientation == UIDeviceOrientationLandscapeLeft || orientation == UIDeviceOrientationLandscapeRight)&#123;</div><div class="line">    </div><div class="line">        self.imageView.frame = CGRectMake(0, 0, self.width, 240 * [UIScreen mainScreen].bounds.size.width / 320.0);</div><div class="line">        self.imageView.centerY = self.height / 2.0;</div><div class="line">    &#125;else&#123;</div><div class="line">        _imageView.frame = CGRectMake(0, 0, self.width, 418 * [UIScreen mainScreen].bounds.size.width / 320.0);</div><div class="line">        _imageView.centerY = self.height / 2.0;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä»…ä»…æ˜¯è¿™æ ·è¿˜ä¸å¤Ÿï¼Œè¿˜è¦å¯¹è®¾å¤‡æ–¹å‘çš„è·å–è¿›è¡Œæ”¹è¿›ã€‚<br>é€šå¸¸æˆ‘ä»¬è·å–è®¾å¤‡æ–¹å‘æ˜¯é€šè¿‡[[UIDevice currentDevice] orientation] æˆ–è€…é€šè¿‡[UIApplication sharedApplication].statusBarOrientationçš„æ–¹å¼æ¥è·å–ã€‚ä½†è¿™ä¸¤ç§æ–¹å¼æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œåœ¨ç«–æ’æ–¹å‘å¼€å…³å…³é—­çš„æ—¶å€™ï¼Œè·å–åˆ°çš„æ–¹å‘æ˜¯æ­£ç¡®çš„ï¼Œåœ¨å¼€å…³æ‰“å¼€çš„æ—¶å€™è·å–åˆ°çš„æ–¹å‘æ˜¯ç«–ç›´æ–¹å‘ï¼Œåœ¨æ¨ªå±ç­‰æƒ…å†µä¸‹è·å–çš„æ–¹å‘ä¸æ­£ç¡®ã€‚è¿™æ—¶å€™å°±è¦é€šè¿‡CMMotionManageræ¥è·å–æ–¹å‘äº†ã€‚(ä¸‹é¢è¿™æ®µä»£ç ä¹Ÿæ²¡æœ‰åŠ åˆ°demoä¸­ï¼Œå¦‚æœæœ‰è¿™æ ·çš„åŠŸèƒ½éœ€æ±‚ï¼Œå¯ä»¥åœ¨ZTImagePickerControllerä¸­åŠ ä¸Šè¿™æ®µä»£ç )<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (void)p_startMotionManager&#123;</div><div class="line">    self.deviceOrientation = UIDeviceOrientationPortrait;</div><div class="line">    if (_motionManager == nil) &#123;</div><div class="line">        _motionManager = [[CMMotionManager alloc] init];</div><div class="line">    &#125;</div><div class="line">    _motionManager.deviceMotionUpdateInterval = 1/15.0;</div><div class="line">    if (_motionManager.deviceMotionAvailable) &#123;</div><div class="line">        NSLog(@&quot;Device Motion Available&quot;);</div><div class="line">        [_motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue currentQueue]</div><div class="line">                                            withHandler: ^(CMDeviceMotion *motion, NSError *error)&#123;</div><div class="line">                                                [self performSelectorOnMainThread:@selector(handleDeviceMotion:) withObject:motion waitUntilDone:YES];</div><div class="line">                                                </div><div class="line">                                            &#125;];</div><div class="line">    &#125; else &#123;</div><div class="line">        NSLog(@&quot;No device motion on device.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)p_stopMonotionManager&#123;</div><div class="line">    [_motionManager stopDeviceMotionUpdates];</div><div class="line">    _motionManager = nil;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>äºŒã€æ·»åŠ æ°´å°<br>å¦‚æœè¦å®ç°ç±»ä¼¼è…¾è®¯çš„æ°´å°ç›¸æœºå½¢å¼çš„æ°´å°ï¼Œéœ€è¦å¯¹æ°´å°ä¸“é—¨åšä¸€ä¸ªå›¾å±‚æ¥è¿›è¡Œç®¡ç†ã€‚å°†æ°´å°å›¾å±‚æ”¾åœ¨ç›¸æœºçš„æœ€ä¸Šå±‚å°±å¯ä»¥å®æ—¶çœ‹åˆ°æ°´å°äº†ï¼Œå¹¶ä¸”å¯ä»¥å·¦å³åˆ‡æ¢æ°´å°ã€‚è¿™é‡Œä½¿ç”¨scrollviewæ¥å®¹çº³æ¯ç§æ°´å°æ ·å¼ï¼Œå¦‚æœæ°´å°æ ·å¼æ¯”è¾ƒå¤šå½“ç„¶å¯ä»¥ä½¿ç”¨collectionViewæ¥å®¹çº³ã€‚</p>
<p>ä¸ºäº†è®©æ°´å°å›¾å±‚çš„æ‰‹åŠ¿(scrollViewçš„å·¦å³æ»‘åŠ¨ï¼Œæ¯ç§æ°´å°æ ·å¼è§†å›¾ä¸­çš„æ§ä»¶å“åº”æ‰‹åŠ¿)å“åº”ä¸ä¸ç›¸æœºå›¾å±‚çš„æ‰‹åŠ¿å“åº”ä¸å†²çªï¼Œåœ¨æ°´å°å›¾å±‚å¯ä»¥å°†æ‰‹åŠ¿è¿›è¡Œæ‹¦æˆªï¼Œæ ¹æ®å®é™…æƒ…å†µæ¥è¿”å›å“åº”æ‰‹åŠ¿çš„è§†å›¾æ§ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">è¿™é‡Œçš„ä»£ç æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹</div><div class="line">- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event&#123;</div><div class="line">    </div><div class="line">    UIView *view = [super hitTest:point withEvent:event];</div><div class="line">    </div><div class="line">    CGPoint tempPoint = [self.reportView convertPoint:point fromView:self];</div><div class="line">    if(CGRectContainsPoint(self.reportView.reportTypeLb.frame, tempPoint))&#123;</div><div class="line">        view = self.reportView.reportTypeLb;</div><div class="line">        return view;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    NSInteger left = 0,top = 0, height = 0,width = self.contentSize.width;</div><div class="line">     height = MAX(self.reportView.xmNameLb.top, self.handleProblemView.userLb.top);</div><div class="line">    if([UIDevice currentDevice].orientation == UIDeviceOrientationLandscapeLeft)&#123;</div><div class="line">        left = self.height - height;</div><div class="line">        width = self.width;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if(CGRectContainsPoint(CGRectMake(left, top, width, height), point))&#123;</div><div class="line">            view = [self.superview.subviews objectAtIndex:0];</div><div class="line">            view = [view hitTest:point withEvent:event];</div><div class="line">        &#125;else&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return view;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‹å®Œç…§é€‰æ‹©å¥½æ°´å°æ ·å¼åï¼Œå°†æ°´å°æ ·å¼ç”¨çš„ç©ºé—´ç»˜åˆ¶åˆ°ç…§ç‰‡ä¸Šï¼Œå°±å½¢æˆäº†æ°´å°ç…§ç‰‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">- (UIImage *)markedImageWithType:(XBWaterMark )waterMarkType date:(NSDate *)date user:(NSString *)user placLocation:(ZTLocationModel *)locationModel withPhone:(NSString *)phone xmType:(NSString *)xmType&#123;</div><div class="line">    </div><div class="line">    if (self.size.width == 0.0 || self.size.height == 0.0) return nil;</div><div class="line">    </div><div class="line">    UIImage *defaultImage = nil;</div><div class="line">    </div><div class="line">    CGFloat scale = [UIScreen mainScreen].scale;</div><div class="line">    if(scale &gt;= 3) scale = 2;</div><div class="line">    </div><div class="line">    UIImage *image = [self thumbnailForMaxWidth:1024/scale maxHeight:1024/scale];</div><div class="line">    </div><div class="line">    CGSize newSize = CGSizeMake(image.size.width*image.scale/scale, image.size.height*image.scale/scale);</div><div class="line">    </div><div class="line">    UIView *waterMarkView = [self p_markWaterMarkView:waterMarkType date:date user:user</div><div class="line">                                            placLocation:locationModel  withPhone:phone newSize:newSize xmType:xmType];</div><div class="line">    //å°†æ°´å°æ ·å¼ä¸­çš„æ§ä»¶ç»˜åˆ¶åˆ°å›¾ç‰‡</div><div class="line">    UIGraphicsBeginImageContextWithOptions(newSize, YES, 0.0);</div><div class="line">    </div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSaveGState(context);</div><div class="line">    </div><div class="line">    [image drawInRect:CGRectMake(0.0, 0.0, newSize.width, newSize.height)];</div><div class="line">    </div><div class="line">    for (UIView *view in waterMarkView.subviews) &#123;</div><div class="line">        if([view isKindOfClass:[UIImageView class]])&#123;</div><div class="line">            UIImageView *iv = (UIImageView *)view;</div><div class="line">            [iv.image drawInRect:CGRectMake(iv.left,iv.top, iv.width, iv.height)];</div><div class="line">        &#125;else if ([view isKindOfClass:[UILabel class]])&#123;</div><div class="line">            UILabel *lb = (UILabel *)view;</div><div class="line">            UIImage *lbImage = [lb imageByRenderingView];</div><div class="line">            [lbImage drawInRect:CGRectMake(lb.left, lb.top, lb.width, lb.height)];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    CGContextRestoreGState(context);</div><div class="line">    </div><div class="line">    defaultImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    </div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    </div><div class="line">    return defaultImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ•ˆæœå›¾</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-469450e831aebc08.gif?imageMogr2/auto-orient/strip" alt="è‡ªå®šä¹‰æ°´å°ç›¸æœº.gif"></p>
<p>è‡ªå®šä¹‰ç›¸æœº<a href="https://github.com/ZT0526/ZTImagePicker" target="_blank" rel="external">demo</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/22/secoendArticle/" title="ä»OCåˆ°Swift3.0" itemprop="url">ä»OCåˆ°Swift3.0</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ZT0526" target="_blank" itemprop="author">ZT0526</a>
		
  <p class="article-time">
    <time datetime="2017-08-22T03:47:40.000Z" itemprop="datePublished"> Published 2017-08-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>#åŸºç¡€éƒ¨åˆ†</p>
<p>##å€¼çš„å£°æ˜<br>åœ¨Swiftä¸­å¯¹å€¼çš„å£°æ˜ä½¿ç”¨çš„æ˜¯varã€let. ä½¿ç”¨varå£°æ˜çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå€¼æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼Œletå£°æ˜çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªå¸¸é‡,å€¼ä¸€æ—¦è¢«æŒ‡å®šå°±ä¸å¯ä»¥è¢«ä¿®æ”¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">let maximumNumberOfLoginAttempts = 10</div><div class="line">var currentLoginAttempt = 0</div></pre></td></tr></table></figure>
<p>åœ¨Swiftä¸­å¯ä»¥è‡ªåŠ¨å»æ¨æ–­æ•°æ®çš„ç±»å‹ æ— éœ€æŒ‡å®šï¼Œä¸Šé¢çš„ä¸¤ä¸ªæ•°æ®ç±»å‹éƒ½æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚è¿™ä¸€ç‚¹åœ¨OCä¸­æ˜¯æ²¡æœ‰çš„</p>
<p>##ç±»å‹æ ‡æ³¨<br>å£°æ˜æ•°æ®çš„æ—¶å€™ä¸ºäº†æŒ‡å®šæ•°æ®çš„ç±»å‹ï¼Œå¯ä»¥åœ¨å˜é‡åæˆ–å¸¸é‡åçš„åé¢åŠ ä¸Šâ€œï¼š â€(å†’å·å’Œä¸€ä¸ªç©ºæ ¼)ç„¶ååœ¨è·Ÿä¸Šç±»å‹åã€‚å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">let nameExplicit: String = &quot;Whoopie Cushion&quot;</div></pre></td></tr></table></figure>
<p>##å¸¸é‡å’Œå˜é‡çš„åå­—<br>å¸¸é‡ä¸å˜é‡åä¸èƒ½åŒ…å«æ•°å­¦ç¬¦å·ï¼Œç®­å¤´ï¼Œä¿ç•™çš„ï¼ˆæˆ–è€…éæ³•çš„ï¼‰Unicode ç ä½ï¼Œè¿çº¿ä¸åˆ¶è¡¨ç¬¦ã€‚ä¹Ÿä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œä½†æ˜¯å¯ä»¥åœ¨å¸¸é‡ä¸å˜é‡åçš„å…¶ä»–åœ°æ–¹åŒ…å«æ•°å­—ã€‚å¯ä»¥ç”¨åŒ…æ‹¬unicodeä»¥åŠå…¶ä»–çš„å­—ç¬¦æ¥ä½œä¸ºå˜é‡åã€‚<br>//å˜é‡å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">let Ï€ = 3.14159</div><div class="line">let ä½ å¥½ = &quot;ä½ å¥½å•Š&quot;</div><div class="line">let ğŸ¶ğŸ® = &quot;dogcow&quot;</div></pre></td></tr></table></figure>
<p>##å¸ƒå°”å€¼<br>åœ¨Swiftä¸­çš„boolå€¼æ˜¯trueå’Œfalseï¼Œè€Œä¸æ˜¯OCä¸­çš„YESå’ŒNO<br>let onSaleInferred = true<br>let onSaleExplicit: Bool = false</p>
<p>##æ‰“å°è¾“å‡º<br>åœ¨Swiftä¸­çš„æ‰“å°è¾“å‡ºä½¿ç”¨çš„æ˜¯printï¼Œä¹Ÿå¯ä»¥å…¼å®¹ä½¿ç”¨NSlog<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">print(10)</div><div class="line">print(&quot;this is \(10)&quot;) //å°†å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œéœ€è¦å°†å€¼å†™åœ¨æ‹¬å·ä¸­å¹¶åœ¨å‰é¢åŠ ä¸Šæ–œæ â€\â€</div><div class="line"></div><div class="line">//æ ¼å¼åŒ–æ‰“å°</div><div class="line">print(String.init(format: &quot;%@ %@ %.2f&quot;, &quot;asd&quot;,&quot;dd&quot;,10.123))</div><div class="line">print(&quot;this is \(String.init(format: &quot;%@ %@ %.2f&quot;, &quot;asd&quot;,&quot;dd&quot;,10.123))&quot;)</div><div class="line">ä¹Ÿå¯ä»¥ä½¿ç”¨</div><div class="line">NSLog(&quot;this is %@ %.f&quot;, &quot;asd&quot;,&quot;1.12&quot;)</div></pre></td></tr></table></figure></p>
<p>##åŸºæœ¬è¿ç®—ç¬¦<br>é™¤äº†OCä¸­å·²æœ‰çš„è¿ç®—ç¬¦:èµ‹å€¼è¿ç®—ç¬¦ã€æ¯”è¾ƒè¿ç®—ç¬¦ã€é€»è¾‘è¿ç®—ç¬¦ã€ç»„åˆèµ‹å€¼è¿ç®—ç¬¦ã€ä¸‰ç›®è¿ç®—ç¬¦ä¹‹å¤–ï¼Œåœ¨Swiftä¸­è¿˜å¤šäº†ä¸€äº›è¿ç®—ç¬¦ï¼š</p>
<p>##ç©ºåˆè¿ç®—ç¬¦ï¼ˆNil Coalescing Operatorï¼‰<br>ç©ºåˆè¿ç®—ç¬¦ï¼ˆa ?? bï¼‰å°†å¯¹å¯é€‰ç±»å‹ a è¿›è¡Œç©ºåˆ¤æ–­ï¼Œå¦‚æœ a åŒ…å«ä¸€ä¸ªå€¼å°±è¿›è¡Œè§£å°ï¼Œå¦åˆ™å°±è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ bã€‚è¡¨è¾¾å¼ a å¿…é¡»æ˜¯ å¯é€‰ç±»å‹ã€‚é»˜è®¤å€¼ b çš„ç±»å‹å¿…é¡»è¦å’Œ a å­˜å‚¨å€¼çš„ç±»å‹ä¿æŒä¸€è‡´ã€‚å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">let defaultColorName = &quot;red&quot;</div><div class="line">var userDefinedColorName: String?   //é»˜è®¤å€¼ä¸º nil</div><div class="line">var colorNameToUse = userDefinedColorName ?? defaultColorName</div></pre></td></tr></table></figure>
<p>##åŒºé—´è¿ç®—ç¬¦<br>é—­åŒºé—´è¿ç®—ç¬¦â€aâ€¦bâ€å®šä¹‰ä¸€ä¸ªåŒ…å«ä» a åˆ° bï¼ˆåŒ…æ‹¬ a å’Œ bï¼‰çš„æ‰€æœ‰å€¼çš„åŒºé—´ã€‚a çš„å€¼ä¸èƒ½è¶…è¿‡ bã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for i in 1...5 &#123;</div><div class="line">    print(&quot;\(i)&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>##åŠå¼€åŒºé—´è¿ç®—ç¬¦<br>åŠå¼€åŒºé—´è¿ç®—ç¬¦ï¼ˆa..<bï¼‰å®šä¹‰ä¸€ä¸ªä» a="" åˆ°="" b="" ä½†ä¸åŒ…æ‹¬="" çš„åŒºé—´ã€‚="" ä¹‹æ‰€ä»¥ç§°ä¸ºåŠå¼€åŒºé—´ï¼Œæ˜¯å› ä¸ºè¯¥åŒºé—´åŒ…å«ç¬¬ä¸€ä¸ªå€¼è€Œä¸åŒ…æ‹¬æœ€åçš„å€¼="" <figure="" class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for i in 5..&lt;10&#123;</div><div class="line">    print(&quot;\(i)&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></bï¼‰å®šä¹‰ä¸€ä¸ªä»></p>
<p>åŒºé—´è¿ç®—ç¬¦å’ŒåŠå¼€åŒºé—´è¿ç®—ç¬¦ä¸»è¦ç”¨åœ¨for-inå¾ªç¯ä¸­<br>æ•°æ®ç±»å‹<br>Swift åŒ…å«äº† C å’Œ Objective-C ä¸Šæ‰€æœ‰åŸºç¡€æ•°æ®ç±»å‹ï¼ŒIntè¡¨ç¤ºæ•´å‹å€¼ï¼› Double å’Œ Float è¡¨ç¤ºæµ®ç‚¹å‹å€¼ï¼› Bool æ˜¯å¸ƒå°”å‹å€¼ï¼›String æ˜¯æ–‡æœ¬å‹æ•°æ®ã€‚ Swift è¿˜æä¾›äº†ä¸‰ä¸ªåŸºæœ¬çš„é›†åˆç±»å‹ï¼ŒArray ï¼ŒSet å’Œ Dictionary ã€‚åœ¨ä½¿ç”¨çš„æ—¶å€™å¿…é¡»æŒ‡å®šé›†åˆä¸­çš„æ•°æ®ç±»å‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//Array</div><div class="line">var shoppingList: [String] = [&quot;Eggs&quot;, &quot;Milk&quot;]</div><div class="line">//Dictionary</div><div class="line">var dic = Dictionary&lt;NSObject,AnyObject&gt;()</div><div class="line">//Set</div><div class="line">var letters = Set&lt;Character&gt;()</div></pre></td></tr></table></figure></p>
<p>##å¯å˜æ€§<br>swift<br>å¦‚æœåˆ›å»ºä¸€ä¸ªArrayã€Stringã€Setæˆ–Dictionaryå¹¶ä¸”æŠŠå®ƒåˆ†é…æˆä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªæ˜¯å¯å˜çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºä¹‹åæ·»åŠ æ›´å¤šæˆ–ç§»é™¤å·²å­˜åœ¨çš„æ•°æ®é¡¹ï¼Œæˆ–è€…æ”¹å˜å…¶ä¸­çš„æ•°æ®é¡¹ã€‚å¦‚æœæˆ‘ä»¬æŠŠArrayã€Stringã€Setæˆ–Dictionaryåˆ†é…æˆå¸¸é‡ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸å¯å˜çš„ï¼Œå®ƒçš„å¤§å°å’Œå†…å®¹éƒ½ä¸èƒ½è¢«æ”¹å˜ã€‚</p>
<p>OC<br>å­—ç¬¦ä¸²ã€æ•°ç»„ã€å­—å…¸ã€é›†åˆéƒ½æœ‰ä¸“é—¨çš„ä¸å¯å˜çš„ç±»NSArray; NSDictionary; NSSet; NSString;ä»¥åŠå¯å˜ç±» NSMutableArray;NSMutableDictionary; NSMutableSet; NSMutableString; </p>
<p>å¯ä»¥çœ‹åˆ°swiftæ›´åŠ ç®€åŒ–äº†æ•°æ®çš„ç±»å‹,ä¸ä¼šä¸“é—¨çš„å»è®¾ç½®å¯å˜ç±»å’Œä¸å¯å˜ç±»ã€‚(ç›®å‰ä¸ºäº†å…¼å®¹æ€§ï¼Œåœ¨Swiftçš„ä»£ç ä¸­è¿˜æ˜¯å¯ä»¥ä½¿ç”¨NSArrayã€NSMutableArrayç­‰ç±»)</p>
<p>##å­—ç¬¦ä¸²<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Swiftä¸­å­—ç¬¦ä¸²åˆå§‹åŒ–</div><div class="line">var emptyString = &quot;&quot;               // ç©ºå­—ç¬¦ä¸²å­—é¢é‡</div><div class="line">var anotherEmptyString = String()  // åˆå§‹åŒ–æ–¹æ³•</div><div class="line">å…¶å®ƒçš„åˆå§‹åŒ–æ–¹æ³•â€¦</div><div class="line"></div><div class="line">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</div><div class="line">if emptyString.isEmpty &#123;</div><div class="line">    print(&quot;Nothing to see here&quot;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">å­—ç¬¦ä¸²æ‹¼æ¥çš„æ‹¼æ¥å¯ä»¥ä½¿ç”¨â€+â€æ¥å®Œæˆ</div><div class="line">let string1 = &quot;hello&quot;</div><div class="line">let string2 = &quot; there&quot;</div><div class="line">var welcome = string1 + string2</div></pre></td></tr></table></figure></p>
<p>##æ•°ç»„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">//åˆ›å»ºæ•°ç»„</div><div class="line">var shoppingList: [String] = [&quot;Eggs&quot;, &quot;Milk&quot;]</div><div class="line">shoppingList[0...1] = [&quot;Bananas&quot;, &quot;Apples&quot;]</div><div class="line"></div><div class="line">//åˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©º</div><div class="line">if shoppingList.isEmpty&#123;</div><div class="line">    print(&quot;kong&quot;)</div><div class="line">&#125;else&#123;</div><div class="line">    print(&quot;feikong&quot;)</div><div class="line">&#125;</div><div class="line">//æ·»åŠ æ•°æ®</div><div class="line">shoppingList += [&quot;haha&quot;]//æ·»åŠ æ•°æ®</div><div class="line">//éå†</div><div class="line">for item in shoppingList&#123;</div><div class="line">    print(item)</div><div class="line">&#125;</div><div class="line"></div><div class="line">for (index, value) in shoppingList.enumerated() &#123;</div><div class="line">    print(&quot;Item \(String(index + 1)): \(value)&quot;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">åŒ…å«ä»»æ„ç±»å‹çš„æ•°ç»„</div><div class="line">var array2: [Any] = [Any]()</div><div class="line">array2.append(1)</div><div class="line">array2.append(2.0)</div><div class="line">array2.append([3,4])</div><div class="line">array2.append(&quot;asdasd&quot;)</div><div class="line">array2.append([&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;])</div><div class="line">array2.append(sunClass2)</div><div class="line"></div><div class="line">for iterm in array2&#123;</div><div class="line">    print(&quot;this is \(iterm)&quot;)</div><div class="line">&#125;</div><div class="line">Any:å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬å‡½æ•°ç±»å‹</div><div class="line">AnyObject:å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»ç±»å‹çš„å®ä¾‹</div></pre></td></tr></table></figure>
<p>##å­—å…¸<br>å­—å…¸ä¸å†æ˜¯åƒOCä¸­é‚£æ ·ç”¨å¤§æ‹¬å·æ‹¬èµ·æ¥å­—å…¸ä¸å†æ˜¯åƒOCä¸­ç”¨å¤§æ‹¬å·æ‹¬èµ·æ¥{â€œkey1â€:â€value1â€,â€key2â€:â€value2â€},è€Œæ˜¯ä½¿ç”¨ä¸­æ‹¬å· [â€œkey1â€:â€value1â€,â€key2â€:â€value2â€]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">å­—å…¸çš„åˆ›å»º</div><div class="line">var airports: [String: String] = [&quot;YYZ&quot;: &quot;Toronto Pearson&quot;, &quot;DUB&quot;: &quot;Dublin&quot;]</div><div class="line"></div><div class="line">//å­—å…¸ä¸­æŸä¸ªvalueçš„è®¿é—®</div><div class="line">airports[&quot;DUB&quot;]</div><div class="line"></div><div class="line">//å¢åŠ </div><div class="line">airports[&quot;asd&quot;] = &quot;asd&quot;</div><div class="line">//æ›´æ–°</div><div class="line">airports.updateValue(&quot;Dublin Airport&quot;, forKey: &quot;DUB&quot;)</div><div class="line">//åˆ é™¤</div><div class="line">airports.removeValue(forKey: &quot;DUB&quot;)</div></pre></td></tr></table></figure>
<p></p>
<p>##ç±»å‹è½¬æ¢</p>
<p>###as? as!<br>æŸç±»å‹çš„ä¸€ä¸ªå¸¸é‡æˆ–å˜é‡å¯èƒ½åœ¨å¹•åå®é™…ä¸Šå±äºä¸€ä¸ªå­ç±»ã€‚å½“ç¡®å®šæ˜¯è¿™ç§æƒ…å†µæ—¶ï¼Œç”¨ç±»å‹è½¬æ¢æ“ä½œç¬¦ï¼ˆas? æˆ– as!ï¼‰ã€‚</p>
<p>æ¡ä»¶å½¢å¼as? è¿”å›ä¸€ä¸ªä½ è¯•å›¾å‘ä¸‹è½¬æˆçš„ç±»å‹çš„å¯é€‰å€¼ã€‚å¼ºåˆ¶å½¢å¼ as! æŠŠè¯•å›¾å‘ä¸‹è½¬å‹å¹¶å¼ºåˆ¶è§£åŒ…ã€‚<br>å½“ä½ ä¸ç¡®å®šå‘ä¸‹è½¬å‹å¯ä»¥æˆåŠŸæ—¶ï¼Œç”¨ç±»å‹è½¬æ¢çš„æ¡ä»¶å½¢å¼ï¼ˆas?ï¼‰ã€‚æ¡ä»¶å½¢å¼çš„ç±»å‹è½¬æ¢æ€»æ˜¯è¿”å›ä¸€ä¸ªå¯é€‰å€¼ï¼Œå¹¶ä¸”è‹¥ä¸‹è½¬æ˜¯ä¸å¯èƒ½çš„ï¼Œå¯é€‰å€¼å°†æ˜¯ nilã€‚è¿™ä½¿ä½ èƒ½å¤Ÿæ£€æŸ¥å‘ä¸‹è½¬å‹æ˜¯å¦æˆåŠŸã€‚<br>åªæœ‰ä½ å¯ä»¥ç¡®å®šå‘ä¸‹è½¬å‹ä¸€å®šä¼šæˆåŠŸæ—¶ï¼Œæ‰ä½¿ç”¨å¼ºåˆ¶å½¢å¼ï¼ˆas!ï¼‰ã€‚å½“ä½ è¯•å›¾å‘ä¸‹è½¬å‹ä¸ºä¸€ä¸ªä¸æ­£ç¡®çš„ç±»å‹æ—¶ï¼Œå¼ºåˆ¶å½¢å¼çš„ç±»å‹è½¬æ¢ä¼šè§¦å‘ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚</p>
<p>###as<br>å‘ä¸Šç±»å‹è½¬æ¢ï¼Œä»ä¸€ä¸ªæ´¾ç”Ÿç±»è½¬æ¢ä¸ºåŸºç±»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">var num1 = 1 as Double//num1æ˜¯ä¸€ä¸ªå€¼ä¸º1çš„æµ®ç‚¹æ•°å˜é‡</div><div class="line">var num2 = 2 as Int//num2æ˜¯ä¸€ä¸ªå€¼ä¸º2çš„æ•´å‹å˜é‡</div><div class="line"></div><div class="line"></div><div class="line">class father&#123;</div><div class="line">    let f = 1</div><div class="line">&#125;</div><div class="line">class sun: father&#123;</div><div class="line">    let s = 2</div><div class="line">&#125;</div><div class="line">var sunClass = sun()</div><div class="line">sunClass is sun</div><div class="line"></div><div class="line">var sunClass2 = sunClass as father</div><div class="line">print(&quot;this is \(sunClass2.s)&quot;) //æŠ¥é”™</div><div class="line">print(&quot;this is \(sunClass2.f)&quot;) //ä¸ä¼šæŠ¥é”™,æ‰“å°2</div></pre></td></tr></table></figure></p>
<h1 id="å¯é€‰ç±»å‹ä»¥åŠéšå¼å¯é€‰ç±»å‹"><a href="#å¯é€‰ç±»å‹ä»¥åŠéšå¼å¯é€‰ç±»å‹" class="headerlink" title="å¯é€‰ç±»å‹ä»¥åŠéšå¼å¯é€‰ç±»å‹"></a>å¯é€‰ç±»å‹ä»¥åŠéšå¼å¯é€‰ç±»å‹</h1><h2 id="å¯é€‰ç±»å‹"><a href="#å¯é€‰ç±»å‹" class="headerlink" title="å¯é€‰ç±»å‹"></a>å¯é€‰ç±»å‹</h2><p>åœ¨Swiftä¸­ä½¿ç”¨å¯é€‰ç±»å‹æ¥å¤„ç†å€¼æœ‰å¯èƒ½ç¼ºå¤±çš„æƒ…å†µ,è¿™æ˜¯Cè¯­éŸ³å’ŒOCéƒ½æ²¡æœ‰çš„ï¼Œä½†è¿™æœ‰ç‚¹åƒObjective-C ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä¸€ä¸ªæ–¹æ³•è¦ä¸è¿”å›ä¸€ä¸ªå¯¹è±¡è¦ä¸è¿”å›nilï¼Œnilè¡¨ç¤ºâ€œç¼ºå°‘ä¸€ä¸ªåˆæ³•çš„å¯¹è±¡â€</p>
<p>è¢«å£°æ˜ä¸ºå¯é€‰ç±»å‹çš„å˜é‡æˆ–è€…å¸¸é‡åªå¯èƒ½æœ‰ä¸¤ç§å€¼:ä¸€ã€æœ‰å€¼ï¼Œç­‰äºxxx äºŒã€æ²¡æœ‰å€¼ï¼Œå³Swiftä¸­çš„nil</p>
<p>å¦‚æœä½ å£°æ˜ä¸€ä¸ªå¯é€‰å¸¸é‡æˆ–è€…å˜é‡ä½†æ˜¯æ²¡æœ‰èµ‹å€¼ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨è¢«è®¾ç½®ä¸º nil,å¦‚æœç»™å®ƒä»¬èµ‹å€¼å¤±è´¥ï¼Œå®ƒä»¬çš„å€¼è¿˜æ˜¯nilï¼š<br>var surveyAnswer: String?<br>// surveyAnswer è¢«è‡ªåŠ¨è®¾ç½®ä¸º nil</p>
<p>å¦‚æœç»™å¯é€‰å¸¸é‡æˆ–å˜é‡èµ‹å€¼æˆåŠŸ,å®ƒä»¬çš„å€¼ä¸æ˜¯niläº†<br>surveyAnswer  = â€œhahaâ€</p>
<h2 id="å¼ºåˆ¶è§£æ"><a href="#å¼ºåˆ¶è§£æ" class="headerlink" title="å¼ºåˆ¶è§£æ"></a>å¼ºåˆ¶è§£æ</h2><p>å½“ä½ ç¡®å®šå¯é€‰ç±»å‹ç¡®å®åŒ…å«å€¼ä¹‹åï¼Œä½ å¯ä»¥åœ¨å¯é€‰çš„åå­—åé¢åŠ ä¸€ä¸ªæ„Ÿå¹å·ï¼ˆ!ï¼‰æ¥è·å–å€¼ã€‚è¿™ä¸ªæƒŠå¹å·è¡¨ç¤ºâ€œæˆ‘çŸ¥é“è¿™ä¸ªå¯é€‰æœ‰å€¼ï¼Œè¯·ä½¿ç”¨å®ƒã€‚â€è¿™è¢«ç§°ä¸ºå¯é€‰å€¼çš„å¼ºåˆ¶è§£æï¼ˆforced unwrappingï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">let assumedString: String? = &quot;An implicitly unwrapped optional string.&quot;</div><div class="line">let str1 = assumedString!</div></pre></td></tr></table></figure>
<p>å¦‚æœä¸Šé¢çš„è¿™ä¸ªå¯é€‰ç±»å‹å¸¸é‡æ²¡æœ‰å€¼ é‚£ä¹ˆå°±ä¼šæŠ¥é”™</p>
<h3 id="éšå¼å¯é€‰ç±»å‹"><a href="#éšå¼å¯é€‰ç±»å‹" class="headerlink" title="éšå¼å¯é€‰ç±»å‹"></a>éšå¼å¯é€‰ç±»å‹</h3><p>æœ‰æ—¶å€™åœ¨ç¨‹åºæ¶æ„ä¸­ï¼Œç¬¬ä¸€æ¬¡è¢«èµ‹å€¼ä¹‹åï¼Œå¯ä»¥ç¡®å®šä¸€ä¸ªå¯é€‰ç±»å‹æ€»ä¼šæœ‰å€¼ã€‚è¿™ç§æƒ…å†µä¸‹å°±ä¸ç”¨å»æ¯æ¬¡è§£æå’Œåˆ¤æ–­å¯é€‰ç±»å‹äº†,å› æ­¤Swiftè¿˜æä¾›äº†éšå¼å¯é€‰ç±»å‹æ¥å¤„ç†ä¸€ä¸ªå¯é€‰ç±»å‹ç¬¬ä¸€æ¬¡è¢«å¤åˆ¶åå°±æ€»ä¼šæœ‰å€¼å¾—æƒ…å†µã€‚</p>
<p>åœ¨è·å–éšå¼å¯é€‰ç±»å‹çš„å€¼çš„æ—¶å€™ï¼Œä¸éœ€è¦å†åé¢åŠ ä¸Šâ€!â€æ¥å¼ºåˆ¶è§£æ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">let fullName: String! = &quot;John Appleseed&quot;</div><div class="line">let str2 = fullName</div></pre></td></tr></table></figure></p>
<p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¯é€‰ç±»å‹ String å’Œéšå¼è§£æå¯é€‰ç±»å‹ String ä¹‹é—´çš„åŒºåˆ«ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let possibleString: String? = &quot;An optional string.&quot;</div><div class="line">let forcedString: String = possibleString! // éœ€è¦æ„Ÿå¹å·æ¥è·å–å€¼</div><div class="line"></div><div class="line">let assumedString: String! = &quot;An implicitly unwrapped optional string.&quot;</div><div class="line">let implicitString: String = assumedString  // ä¸éœ€è¦æ„Ÿå¹å·</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„:åœ¨ä½¿ç”¨å¯é€‰ç±»å‹æˆ–éšå¼å¯é€‰ç±»å‹çš„å¸¸é‡æˆ–å˜é‡ä¹‹å‰éƒ½è¦å°†å®ƒä»¬åˆå§‹åŒ–ï¼Œä¸ç„¶ä¼šæŠ¥é”™</p>
<h1 id="æ§åˆ¶æµ"><a href="#æ§åˆ¶æµ" class="headerlink" title="æ§åˆ¶æµ"></a>æ§åˆ¶æµ</h1><h2 id="ifè¯­å¥"><a href="#ifè¯­å¥" class="headerlink" title="ifè¯­å¥"></a>ifè¯­å¥</h2><p>åœ¨Swiftä¸­ifè¯­å¥åçš„åˆ¤æ–­æ¡ä»¶æ— éœ€ç”¨æ‹¬å·æ‹¬èµ·æ¥<br>for-inå¾ªç¯<br>åœ¨Swiftä¸­çš„forå¾ªç¯æ˜¯è¿™æ ·çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for index in 0...3 &#123;</div><div class="line">    print(&quot;index is \(index)&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>//indexçš„å€¼ä¸éœ€è¦å£°æ˜, åªéœ€è¦å°†å®ƒåŒ…å«åœ¨å¾ªç¯çš„å£°æ˜ä¸­ï¼Œå°±å¯ä»¥å¯¹å…¶è¿›è¡Œéšå¼å£°æ˜ã€‚å¦‚æœä¸éœ€è¦å®ƒçš„å€¼,è¿˜å¯ä»¥å°†å…¶ç”¨â€_â€æ¥ä»£æ›¿<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">let base = 3</div><div class="line">let power = 10</div><div class="line">var answer = 1</div><div class="line">for _ in 1...power &#123;</div><div class="line">    answer *= base</div><div class="line">&#125;</div><div class="line"></div><div class="line">è€Œä¸æ˜¯OCã€Cä¸­çš„</div><div class="line">for(int i = 0 ; i &lt; 5; i++)&#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##Whileå¾ªç¯<br>whileå¾ªç¯ä»è®¡ç®—ä¸€ä¸ªæ¡ä»¶å¼€å§‹ã€‚å¦‚æœæ¡ä»¶ä¸ºtrueï¼Œä¼šé‡å¤è¿è¡Œä¸€æ®µè¯­å¥ï¼Œç›´åˆ°æ¡ä»¶å˜ä¸ºfalseã€‚<br>ä¸‹é¢æ˜¯ while å¾ªç¯çš„ä¸€èˆ¬æ ¼å¼ï¼š<br>while condition {<br>    statements<br>}<br>Repeat-While<br>whileå¾ªç¯çš„å¦å¤–ä¸€ç§å½¢å¼æ˜¯repeat-whileï¼Œå®ƒå’Œwhileçš„åŒºåˆ«æ˜¯åœ¨åˆ¤æ–­å¾ªç¯æ¡ä»¶ä¹‹å‰ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯çš„ä»£ç å—ã€‚ç„¶åé‡å¤å¾ªç¯ç›´åˆ°æ¡ä»¶ä¸ºfalseã€‚</p>
<p>Swiftè¯­è¨€çš„repeat-whileå¾ªç¯å’Œå…¶ä»–è¯­è¨€ä¸­çš„do-whileå¾ªç¯æ˜¯ç±»ä¼¼çš„ã€‚<br>ä¸‹é¢æ˜¯ repeat-whileå¾ªç¯çš„ä¸€èˆ¬æ ¼å¼ï¼š<br>repeat {<br>    statements<br>} while condition
</p>
<h2 id="Switch"><a href="#Switch" class="headerlink" title="Switch"></a>Switch</h2><p>ä¸ C å’Œ Objective-C ä¸­çš„switchè¯­å¥ä¸åŒï¼Œåœ¨ Swift ä¸­ï¼Œå½“åŒ¹é…çš„ case åˆ†æ”¯ä¸­çš„ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œç¨‹åºä¼šç»ˆæ­¢switchè¯­å¥ï¼Œè€Œä¸ä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ª case åˆ†æ”¯ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦åœ¨ case åˆ†æ”¯ä¸­æ˜¾å¼åœ°ä½¿ç”¨breakè¯­å¥ã€‚è¿™ä½¿å¾—switchè¯­å¥æ›´å®‰å…¨ã€æ›´æ˜“ç”¨ï¼Œä¹Ÿé¿å…äº†å› å¿˜è®°å†™breakè¯­å¥è€Œäº§ç”Ÿçš„é”™è¯¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">let anotherCharacter: Character = &quot;a&quot;</div><div class="line">switch anotherCharacter &#123;</div><div class="line">case &quot;a&quot;: </div><div class="line">	 print(&quot;The letter a&quot;)</div><div class="line">case &quot;A&quot;:</div><div class="line">    print(&quot;The letter A&quot;)</div><div class="line">default:</div><div class="line">    print(&quot;Not the letter A&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨OCä¸­,Swtichåªæ”¯æŒintç±»å‹,charç±»å‹ä½œä¸ºåŒ¹é…ã€‚è€Œåœ¨Swiftä¸­ä½œä¸ºåŒ¹é…çš„ç±»å‹æ›´åŠ ä¸°å¯Œå¤šæ ·ï¼Œä¸ä»…ä»…æ”¯æŒ intç±»å‹å’Œcharç±»å‹ï¼Œè¿˜å¯ä»¥æ˜¯æµ®ç‚¹å‹ã€å­—ç¬¦ä¸²ã€åŒºé—´ã€å…ƒç»„ã€æšä¸¾å€¼ç­‰ã€‚åœ¨Swiftä¸­Switchå¯ä»¥åŒ¹é…çš„ç±»å‹å¾ˆå¤šï¼Œè¿™æ ·å°±å¯ä»¥å°†ä¸€äº›ç¹æ‚çš„ifåˆ¤æ–­è¯­å¥ç®€åŒ–</p>
<p>###åŒ¹é…å­—ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">let carName = &quot;asd&quot;</div><div class="line">switch carName&#123;</div><div class="line">case &quot;Six&quot;,&quot;asd&quot;:</div><div class="line">    print(&quot;this is Six&quot;)</div><div class="line">case &quot;Seven&quot;:</div><div class="line">    print(&quot;this is Seven&quot;)</div><div class="line">case &quot;Eight&quot;:</div><div class="line">    print(&quot;this is Eight&quot;)</div><div class="line">case &quot;Night&quot;:</div><div class="line">    print(&quot;this is Night&quot;)</div><div class="line">default:</div><div class="line">    print(&quot;nothing&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>//æ‰“å°this is Six</p>
<p>//åŒ¹é…æµ®ç‚¹æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">let value = 5.0;</div><div class="line">switch value &#123;</div><div class="line">case 1.0:</div><div class="line">    print(&quot;this is 1.0&quot;)</div><div class="line">case 2.0:</div><div class="line">    print(&quot;this is 2.0&quot;)</div><div class="line">case 5.0:</div><div class="line">    print(&quot;this is 5.0&quot;)</div><div class="line">default:</div><div class="line">    print(&quot;others&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>//æ‰“å°this is 5.0</p>
<h3 id="åŒºé—´åŒ¹é…"><a href="#åŒºé—´åŒ¹é…" class="headerlink" title="åŒºé—´åŒ¹é…"></a>åŒºé—´åŒ¹é…</h3><p>case åˆ†æ”¯çš„æ¨¡å¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå€¼çš„åŒºé—´ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">let approximateCount = 62</div><div class="line">let countedThings = &quot;moons orbiting Saturn&quot;</div><div class="line">var naturalCount: String</div><div class="line">switch approximateCount &#123;</div><div class="line">case 0:</div><div class="line">    naturalCount = &quot;no&quot;</div><div class="line">case 1..&lt;5:</div><div class="line">    naturalCount = &quot;a few&quot;</div><div class="line">case 5..&lt;12:</div><div class="line">    naturalCount = &quot;several&quot;</div><div class="line">case 12..&lt;100:</div><div class="line">    naturalCount = &quot;dozens of&quot;</div><div class="line">case 100..&lt;1000:</div><div class="line">    naturalCount = &quot;hundreds of&quot;</div><div class="line">default:</div><div class="line">    naturalCount = &quot;many&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å¤åˆåŒ¹é…"><a href="#å¤åˆåŒ¹é…" class="headerlink" title="å¤åˆåŒ¹é…"></a>å¤åˆåŒ¹é…</h3><p>å½“å¤šä¸ªæ¡ä»¶å¯ä»¥ä½¿ç”¨åŒä¸€ç§æ–¹æ³•æ¥å¤„ç†æ—¶ï¼Œå¯ä»¥å°†è¿™å‡ ç§å¯èƒ½æ”¾åœ¨åŒä¸€ä¸ªcaseåé¢ï¼Œå¹¶ä¸”ç”¨é€—å·éš”å¼€ã€‚å½“caseåé¢çš„ä»»æ„ä¸€ç§æ¨¡å¼åŒ¹é…çš„æ—¶å€™ï¼Œè¿™æ¡åˆ†æ”¯å°±ä¼šè¢«åŒ¹é…ã€‚å¹¶ä¸”ï¼Œå¦‚æœåŒ¹é…åˆ—è¡¨è¿‡é•¿ï¼Œè¿˜å¯ä»¥åˆ†è¡Œä¹¦å†™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">let someCharacter: Character = &quot;e&quot;</div><div class="line">switch someCharacter &#123;</div><div class="line">case &quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;:</div><div class="line">    print(&quot;\(someCharacter) is a vowel&quot;)</div><div class="line">case &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;,</div><div class="line">     &quot;n&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;:</div><div class="line">    print(&quot;\(someCharacter) is a consonant&quot;)</div><div class="line">default:</div><div class="line">    print(&quot;\(someCharacter) is not a vowel or a consonant&quot;)</div><div class="line">&#125;</div><div class="line">// è¾“å‡º &quot;e is a vowel&quot;</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-Switch-è¯­å¥åŒ¹é…æšä¸¾å€¼"><a href="#ä½¿ç”¨-Switch-è¯­å¥åŒ¹é…æšä¸¾å€¼" class="headerlink" title="ä½¿ç”¨ Switch è¯­å¥åŒ¹é…æšä¸¾å€¼"></a>ä½¿ç”¨ Switch è¯­å¥åŒ¹é…æšä¸¾å€¼</h3><p>ä½ å¯ä»¥ä½¿ç”¨switchè¯­å¥åŒ¹é…å•ä¸ªæšä¸¾å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">directionToHead = .south</div><div class="line">switch directionToHead &#123;</div><div class="line">    case .north:</div><div class="line">        print(&quot;Lots of planets have a north&quot;)</div><div class="line">    case .south:</div><div class="line">        print(&quot;Watch out for penguins&quot;)</div><div class="line">    case .east:</div><div class="line">        print(&quot;Where the sun rises&quot;)</div><div class="line">    case .west:</div><div class="line">        print(&quot;Where the skies are blue&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><p>å¯¹äºåœ¨OCä¸­,æ–¹æ³•æœ‰ä¸¤ç§ç±»å‹,ç±»æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•ã€‚æ–¹æ³•çš„ç»„æˆç”±æ–¹æ³•å,å‚æ•°,è¿”å›å€¼ç»„æˆã€‚<br>åœ¨Swiftä¸­å‡½æ•°çš„å®šä¹‰åŸºæœ¬ä¸OCä¸€æ ·ã€‚<br>ä¸»è¦åŒºåˆ«ä¸ºï¼š<br>1    é€šè¿‡funcå…³é”®è¯å®šä¹‰å‡½æ•°<br>2    è¿”å›å€¼åœ¨-&gt;å…³é”®è¯åæ ‡æ³¨<br>å„ä¸¾ä¸€ä¸ªç±»æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•ä¾‹å­ã€‚</p>
<ul>
<li>(UIColor*)blackColor</li>
</ul>
<ul>
<li>(void)addSubview:(UIView *)view<br>å¯¹åº”çš„swiftç‰ˆæœ¬<br>class func blackColor() -&gt; UIColor //ç±»æ–¹æ³•, é€šè¿‡ class funcæˆ–è€…static func å…³é”®è¯å£°æ˜ï¼Œclass funcå£°æ˜çš„æ–¹æ³•å¯ä»¥è¢«å­ç±»é‡å†™<br>func addSubview(view: UIView) //å®ä¾‹æ–¹æ³•</li>
</ul>
<h2 id="å¿½ç•¥å‚æ•°æ ‡ç­¾"><a href="#å¿½ç•¥å‚æ•°æ ‡ç­¾" class="headerlink" title="å¿½ç•¥å‚æ•°æ ‡ç­¾"></a>å¿½ç•¥å‚æ•°æ ‡ç­¾</h2><p>å¦‚æœä½ ä¸å¸Œæœ›ä¸ºæŸä¸ªå‚æ•°æ·»åŠ ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸‹åˆ’çº¿(<em>)æ¥ä»£æ›¿ä¸€ä¸ªæ˜ç¡®çš„å‚æ•°æ ‡ç­¾ã€‚<br>func someFunction(</em> firstParameterName: Int, secondParameterName: Int) {<br>     // åœ¨å‡½æ•°ä½“å†…ï¼ŒfirstParameterName å’Œ secondParameterName ä»£è¡¨å‚æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°å€¼<br>}<br>someFunction(1, secondParameterName: 2)<br>å¦‚æœä¸€ä¸ªå‚æ•°æœ‰ä¸€ä¸ªæ ‡ç­¾ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨çš„æ—¶å€™å¿…é¡»ä½¿ç”¨æ ‡ç­¾æ¥æ ‡è®°è¿™ä¸ªå‚æ•°ã€‚</p>
<h2 id="å‡½æ•°ä¸­å‚æ•°çš„ä¿®æ”¹"><a href="#å‡½æ•°ä¸­å‚æ•°çš„ä¿®æ”¹" class="headerlink" title="å‡½æ•°ä¸­å‚æ•°çš„ä¿®æ”¹"></a>å‡½æ•°ä¸­å‚æ•°çš„ä¿®æ”¹</h2><p>ocä¸­å‚æ•°åœ¨å‡½æ•°ä½“å†…æ˜¯å¯ä»¥ä¿®æ”¹å…¶å€¼çš„ï¼Œå› ä¸ºå…¶ä½œç”¨ç±»ä¼¼äºå±€éƒ¨å˜é‡ã€‚ä½†æ˜¯åœ¨swiftä¸­ï¼Œå‚æ•°é»˜è®¤éƒ½æ˜¯å¸¸é‡å‚æ•°ï¼Œä¸èƒ½åœ¨å‡½æ•°ä½“å†…ä¿®æ”¹å‚æ•°å€¼ã€‚å¦‚æœéœ€è¦åœ¨å‡½æ•°ä½“å†…ä¿®æ”¹å‚æ•°å€¼ï¼Œåˆ™éœ€è¦å®šä¹‰å˜é‡å‚æ•°ï¼Œå³åœ¨å‚æ•°åå‰åŠ varå…³é”®å­—å³å¯ã€‚</p>
<h1 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h1><p>é—­åŒ…æ˜¯è‡ªåŒ…å«çš„å‡½æ•°ä»£ç å—ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­è¢«ä¼ é€’å’Œä½¿ç”¨ã€‚Swift ä¸­çš„é—­åŒ…ä¸ C å’Œ Objective-C ä¸­çš„ä»£ç å—ï¼ˆblocksï¼‰æ¯”è¾ƒç›¸ä¼¼ã€‚</p>
<h2 id="é—­åŒ…è¡¨è¾¾å¼è¯­æ³•"><a href="#é—­åŒ…è¡¨è¾¾å¼è¯­æ³•" class="headerlink" title="é—­åŒ…è¡¨è¾¾å¼è¯­æ³•"></a>é—­åŒ…è¡¨è¾¾å¼è¯­æ³•</h2><p>é—­åŒ…è¡¨è¾¾å¼è¯­æ³•æœ‰å¦‚ä¸‹çš„ä¸€èˆ¬å½¢å¼ï¼š<br>{ (parameters) -&gt; returnType in<br>    statements<br>}</p>
<p>åœ¨OCä¸­æˆ‘ä»¬æ›´å¤šçš„ä¼šä½¿ç”¨blockæ¥è¿›è¡Œå®Œæˆå¤æ‚çš„æ“ä½œï¼Œæ¯”å¦‚å¼‚æ­¥ç½‘ç»œè¯·æ±‚å¾—åˆ°Jsonæ•°æ®åï¼Œéœ€è¦å°†Jsonè½¬åŒ–ä¸ºæ•°æ®æ¨¡å‹çš„å¯¹è±¡ã€åˆæˆ–è€…æ˜¯è·¨è§†å›¾å±‚çº§æ¥å®Œæˆæ•°æ®å¤„ç†ã€è§†å›¾åŠ¨ç”»çš„æ‰§è¡Œç­‰ç­‰ã€‚åœ¨Swiftä¸­é—­åŒ…èƒ½å¤Ÿå®ç°blockæ‰€èƒ½å®ç°çš„åŠŸèƒ½ã€‚</p>
<h2 id="å°¾éšé—­åŒ…"><a href="#å°¾éšé—­åŒ…" class="headerlink" title="å°¾éšé—­åŒ…"></a>å°¾éšé—­åŒ…</h2><p>å¦‚æœä½ éœ€è¦å°†ä¸€ä¸ªå¾ˆé•¿çš„é—­åŒ…è¡¨è¾¾å¼ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å°¾éšé—­åŒ…æ¥å¢å¼ºå‡½æ•°çš„å¯è¯»æ€§ã€‚å°¾éšé—­åŒ…æ˜¯ä¸€ä¸ªä¹¦å†™åœ¨å‡½æ•°æ‹¬å·ä¹‹åçš„é—­åŒ…è¡¨è¾¾å¼ï¼Œå‡½æ•°æ”¯æŒå°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°è°ƒç”¨ã€‚åœ¨ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ä¸ç”¨å†™å‡ºå®ƒçš„å‚æ•°æ ‡ç­¾:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">func someFunctionThatTakesAClosure(closure: () -&gt; Void) &#123;</div><div class="line">    // å‡½æ•°ä½“éƒ¨åˆ†</div><div class="line">&#125;</div><div class="line"></div><div class="line">//ä¸ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨</div><div class="line">someFunctionThatTakesAClosure(closure: &#123;</div><div class="line">    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†</div><div class="line">&#125;)</div><div class="line"></div><div class="line">//ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨</div><div class="line">someFunctionThatTakesAClosure() &#123;</div><div class="line">    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="é€ƒé€¸é—­åŒ…"><a href="#é€ƒé€¸é—­åŒ…" class="headerlink" title="é€ƒé€¸é—­åŒ…"></a>é€ƒé€¸é—­åŒ…</h2><p>å½“ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ä¼ åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªé—­åŒ…åœ¨å‡½æ•°è¿”å›ä¹‹åæ‰è¢«æ‰§è¡Œï¼Œæˆ‘ä»¬ç§°è¯¥é—­åŒ…ä»å‡½æ•°ä¸­é€ƒé€¸ã€‚å½“ä½ å®šä¹‰æ¥å—é—­åŒ…ä½œä¸ºå‚æ•°çš„å‡½æ•°æ—¶ï¼Œä½ å¯ä»¥åœ¨å‚æ•°åä¹‹å‰æ ‡æ³¨ @escapingï¼Œç”¨æ¥æŒ‡æ˜è¿™ä¸ªé—­åŒ…æ˜¯å…è®¸â€œé€ƒé€¸â€å‡ºè¿™ä¸ªå‡½æ•°çš„ã€‚<br>ä¸€ç§èƒ½ä½¿é—­åŒ…â€œé€ƒé€¸â€å‡ºå‡½æ•°çš„æ–¹æ³•æ˜¯ï¼Œå°†è¿™ä¸ªé—­åŒ…ä¿å­˜åœ¨ä¸€ä¸ªå‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ä¸­ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¾ˆå¤šå¯åŠ¨å¼‚æ­¥æ“ä½œçš„å‡½æ•°æ¥å—ä¸€ä¸ªé—­åŒ…å‚æ•°ä½œä¸º å¼‚æ­¥æ“ä½œå®Œæˆçš„å¤„ç†ã€‚è¿™ç±»å‡½æ•°ä¼šåœ¨å¼‚æ­¥æ“ä½œå¼€å§‹ä¹‹åç«‹åˆ»è¿”å›ï¼Œä½†æ˜¯é—­åŒ…ç›´åˆ°å¼‚æ­¥æ“ä½œç»“æŸåæ‰ä¼šè¢«è°ƒç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé—­åŒ…éœ€è¦â€œé€ƒé€¸â€å‡ºå‡½æ•°ï¼Œå› ä¸ºé—­åŒ…éœ€è¦åœ¨å‡½æ•°è¿”å›ä¹‹åè¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">var x:String?</div><div class="line">var completionHandlers:() -&gt; Void</div><div class="line">func someFunctionWithEscapingClosure(completionHandler: @escaping (String) -&gt; Void) &#123;</div><div class="line">    //å¼‚æ­¥æ“ä½œ</div><div class="line">    print(&quot;è¿™é‡Œå¯ä»¥æ‰§è¡Œå¼‚æ­¥æ“ä½œ&quot;)</div><div class="line">    </div><div class="line">    //è¿”å›æ—¶è°ƒç”¨</div><div class="line">    completionHandler(&quot;123456&quot;)</div><div class="line">&#125;</div><div class="line">someFunctionWithEscapingClosure(completionHandler: &#123;(str: String) -&gt; Void</div><div class="line">in</div><div class="line">    x = str</div><div class="line">&#125;)</div><div class="line">print(x)</div></pre></td></tr></table></figure>
<p>#æŒ‡é’ˆ<br>åœ¨Swiftè¿™é—¨è¯­è¨€ä¸­ï¼Œä¼šå°½é‡å»é¿å…ä½ å»ç›´æ¥ä½¿ç”¨æŒ‡é’ˆã€‚ä½†æ˜¯è¿˜æ˜¯ä¼šæä¾›å„ç§ä¸cè¯­è¨€ç›¸å¯¹åº”çš„æŒ‡é’ˆä»¥ä¾›å¼€å‘è€…åœ¨éœ€è¦çš„æ˜¯æ—¶å€™ä½¿ç”¨ã€‚å…·ä½“çš„å¯ä»¥çœ‹<a href="https://developer.apple.com/library/prerelease/content/documentation/Swift/Conceptual/BuildingCocoaApps/InteractingWithCAPIs.html" target="_blank" rel="external">https://developer.apple.com/library/prerelease/content/documentation/Swift/Conceptual/BuildingCocoaApps/InteractingWithCAPIs.html</a></p>
<h1 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h1><p>è¯­æ³•:<br>åœ¨Objective-Cä¸­æˆ‘ä»¬è¿™ä¹ˆå£°æ˜Protocol:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@protocolÂ SampleProtocol</div><div class="line">-Â (void)someMethod;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>è€Œåœ¨Swiftä¸­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">protocolÂ SampleProtocolÂ </div><div class="line">&#123;</div><div class="line">Â Â Â Â funcÂ someMethod()</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨Swiftéµå¾ªåè®®:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">classÂ AnotherClass:Â SomeSuperClass,Â SampleProtocol</div><div class="line">&#123;</div><div class="line">Â Â Â Â funcÂ someMethod()Â &#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¹‹å‰Objective-Cçš„protocolä¸­,æˆ‘ä»¬å¯ä»¥æ ‡å¿—optionalã€‚åœ¨Swiftä¸­æ²¡æœ‰optionalè¿™æ ·çš„æ ‡å¿—ã€‚</p>
<p>åœ¨Swiftä¸­protocolå¾ˆå¼ºå¤§ï¼Œclassã€enumã€structã€extentionéƒ½å¯ä»¥éµå®ˆåè®®</p>
<p>è®©æšä¸¾éµå®ˆä¸€ä¸ªåè®®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">enum testEnum:MyProtocol &#123;</div><div class="line">    internal func test() &#123;</div><div class="line">        print(&quot;this is enum&quot;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    case one</div><div class="line">    case two</div><div class="line">&#125;</div><div class="line"></div><div class="line">let testEnum1 = testEnum.one</div><div class="line">testEnum1.test()</div><div class="line">//è¾“å‡ºthis is enum</div></pre></td></tr></table></figure></p>
<p>ç»“æ„ä½“éµå®ˆä¸€ä¸ªåè®®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">struct testStruct:MyProtocol&#123;</div><div class="line">    func test() &#123;</div><div class="line">        print(&quot;this is struct&quot;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">let testStruct1 = testStruct()</div><div class="line">testStruct1.test()</div><div class="line">//è¾“å‡ºthis is struct</div></pre></td></tr></table></figure></p>
<h1 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h1><p>åœ¨OCä¸­å®šä¹‰ä¸€ä¸ªç±»æ˜¯è¿™æ ·çš„ï¼Œéœ€è¦åœ¨åˆ›å»º.h .mæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">@interface class name : superclass</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation class</div><div class="line"></div><div class="line">methods</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>åœ¨Swiftä¸­å®šä¹‰ä¸€ä¸ªç±»,åªéœ€è¦ä¸€ä¸ª.swiftæ–‡ä»¶ï¼Œå˜é‡ã€æ–¹æ³•çš„å£°æ˜ ä»¥åŠå®ç°éƒ½åœ¨åŒä¸€ä¸ªç±»ä¸­å®Œæˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class SomeClass &#123;</div><div class="line">// </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h1><p>OCä¸­çš„å±æ€§å£°æ˜:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@propertyÂ (strong,nonatomic)Â NSStringÂ *string;</div></pre></td></tr></table></figure>
<p>Swiftä¸­çš„å±æ€§å£°æ˜:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">classÂ ShapeÂ &#123;</div><div class="line">Â Â Â Â varÂ string =Â &quot; string &quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>OCä¸­çš„getter setteræ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (NSString *)string&#123;</div><div class="line">    return @&quot;str&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)setString:(NSString *)string&#123;</div><div class="line">    _string = string;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Swiftä¸­çš„setter getteræ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var string:String&#123;</div><div class="line">        set&#123;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        get&#123;</div><div class="line">          return &quot;string&quot;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Swift ä¸­çš„å±æ€§æ²¡æœ‰å¯¹åº”çš„å®ä¾‹å˜é‡ï¼Œå±æ€§çš„åç«¯å­˜å‚¨ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®ã€‚</p>
<p>Objective-C ä¸ºç±»å®ä¾‹å­˜å‚¨å€¼å’Œå¼•ç”¨æä¾›ä¸¤ç§æ–¹æ³•ã€‚é™¤äº†å±æ€§ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®ä¾‹å˜é‡ä½œä¸ºå±æ€§å€¼çš„åç«¯å­˜å‚¨ã€‚<br>Swift ç¼–ç¨‹è¯­è¨€ä¸­æŠŠè¿™äº›ç†è®ºç»Ÿä¸€ç”¨å±æ€§æ¥å®ç°ã€‚</p>
<p>Swiftä¸­çš„åªè¯»å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var redOnly:String&#123;</div><div class="line">get&#123;</div><div class="line">    return &quot;asd&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;//get å’Œæ‹¬å·éƒ½å¯ä»¥å»æ‰</div></pre></td></tr></table></figure>
<h2 id="å­˜å‚¨å±æ€§"><a href="#å­˜å‚¨å±æ€§" class="headerlink" title="å­˜å‚¨å±æ€§"></a>å­˜å‚¨å±æ€§</h2><p>å­˜å‚¨å±æ€§å°±æ˜¯å­˜å‚¨åœ¨ç‰¹å®šç±»æˆ–ç»“æ„ä½“å®ä¾‹é‡Œçš„ä¸€ä¸ªå¸¸é‡æˆ–å˜é‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">struct storeProperty&#123;</div><div class="line">    var value1:Int//å­˜å‚¨å±æ€§</div><div class="line">    let value2:Int//å­˜å‚¨å±æ€§</div><div class="line">&#125;</div><div class="line"></div><div class="line">var store = storeProperty(value1: 10,value2: 11)</div><div class="line">print(&quot;vale1:\(store.value1) value2:\(store.value2)&quot;)</div></pre></td></tr></table></figure>
<h2 id="è®¡ç®—å±æ€§"><a href="#è®¡ç®—å±æ€§" class="headerlink" title="è®¡ç®—å±æ€§"></a>è®¡ç®—å±æ€§</h2><p>è®¡ç®—å±æ€§ä¸ç›´æ¥å­˜å‚¨å€¼ï¼Œè€Œæ˜¯æä¾›ä¸€ä¸ª getter å’Œä¸€ä¸ªå¯é€‰çš„ setterï¼Œæ¥é—´æ¥è·å–å’Œè®¾ç½®å…¶ä»–å±æ€§æˆ–å˜é‡çš„å€¼ã€‚<br>//è®¡ç®—å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">struct caculateProperty&#123;</div><div class="line">    var value1:Int = 2</div><div class="line">    </div><div class="line">    var caculate:Int&#123;</div><div class="line">        set&#123;</div><div class="line">            value1 = newValue + 1</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        get&#123;</div><div class="line">           return value1*2</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">var test = caculateProperty.init(value1: 2)</div><div class="line">print(&quot;value1: \(test.value1)&quot;)</div><div class="line"></div><div class="line">test.caculate = 2</div><div class="line">print(&quot;value1: \(test.value1)&quot;)</div><div class="line"></div><div class="line">var value2 = test.caculate</div><div class="line">print(&quot;value1: \(value2)&quot;)</div></pre></td></tr></table></figure>
<h1 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h1><p>Swiftçš„æ‰©å±•å’Œ ä¸åŒäºObjective-C ä¸­çš„æ‰©å±• ,ä½†å’ŒObjective-C ä¸­çš„åˆ†ç±»ç±»ä¼¼ã€‚ä¸Objective-C ä¸åŒçš„æ˜¯ï¼ŒSwift çš„æ‰©å±•æ²¡æœ‰åå­—ã€‚</p>
<h2 id="æ‰©å±•è¯­æ³•"><a href="#æ‰©å±•è¯­æ³•" class="headerlink" title="æ‰©å±•è¯­æ³•"></a>æ‰©å±•è¯­æ³•</h2><p>ä½¿ç”¨å…³é”®å­— extension æ¥å£°æ˜æ‰©å±•ï¼š<br>extension SomeType {<br>    // ä¸º SomeType æ·»åŠ çš„æ–°åŠŸèƒ½å†™åˆ°è¿™é‡Œ<br>}<br>å¯ä»¥é€šè¿‡æ‰©å±•æ¥æ‰©å±•ä¸€ä¸ªå·²æœ‰ç±»å‹ï¼Œä½¿å…¶å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªåè®®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ— è®ºæ˜¯ç±»è¿˜æ˜¯ç»“æ„ä½“ï¼Œåè®®åå­—çš„ä¹¦å†™æ–¹å¼å®Œå…¨ä¸€æ ·ï¼š<br>extension SomeType: SomeProtocol, AnotherProctocol {<br>    // åè®®å®ç°å†™åˆ°è¿™é‡Œ<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">extension ZTTestKvoAndProtocolViewController:UITextViewDelegate&#123;</div><div class="line">    func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -&gt; Bool &#123;</div><div class="line">        textStr = text</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Swiftä¸­çš„æ‰©å±•å¾ˆå¼ºå¤§,å…·ä½“çš„å¯ä»¥å‚è€ƒExtentions</p>
<p>æ³¨æ„<br>æ‰©å±•å¯ä»¥ä¸ºä¸€ä¸ªç±»å‹æ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸èƒ½é‡å†™å·²æœ‰çš„åŠŸèƒ½ã€‚</p>
<h1 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h1><h2 id="NSThread"><a href="#NSThread" class="headerlink" title="NSThread"></a>NSThread</h2><p>åœ¨OCå’ŒSwiftä¸­NSthreadçš„æ–¹æ³•åŸºæœ¬ä¸€æ ·</p>
<h2 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//let queue1 = DispatchQueue(label:&quot;queue1&quot;)//é»˜è®¤åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—</div><div class="line">        let queue1 = DispatchQueue(label:&quot;queue1&quot;,attributes:.concurrent)//åˆ›å»ºå¹¶å‘é˜Ÿåˆ—</div><div class="line">        for i in 0...10&#123;</div><div class="line">            queue1.async &#123;</div><div class="line">                print(&quot;this is async1 \(i)&quot;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>åœ¨OCä¸­dispatch_onceä¼šè¢«å¼€å‘è€…ç”¨æ¥å®ç°ä¸€ä¸ªå•ä¾‹ï¼Œåº”ä¸ºå®ƒåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå®‰å…¨ã€ç®€æ´</p>
<p>ä½†åœ¨Swift3.0ä¸­dispatch_onceå·²ç»è¢«åºŸé™¤ã€‚</p>
<h2 id="NSOperation-amp-NSOperationQueue"><a href="#NSOperation-amp-NSOperationQueue" class="headerlink" title="NSOperation &amp; NSOperationQueue"></a>NSOperation &amp; NSOperationQueue</h2><p>åœ¨OCä¸­å¯ä»¥ä½¿ç”¨NSInvocationOperationå°†æ–¹æ³•å°è£…åæäº¤åˆ°é˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨NSBlockOperationå°†ä»£ç å—å°è£…åæäº¤åˆ°é˜Ÿåˆ—æ¥å®Œæˆä»»åŠ¡çš„æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">NSOperationQueue *queue = [[NSOperationQueue alloc] init];</div><div class="line">    </div><div class="line">        NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(run) object:nil];</div><div class="line">    </div><div class="line">    </div><div class="line">        NSBlockOperation *bloperation = [NSBlockOperation blockOperationWithBlock:^&#123;</div><div class="line">            for(int i = 0;i&lt; 20;i++)&#123;</div><div class="line">                NSLog(@&quot;å­çº¿ç¨‹6ï¼š%d\n&quot;,i);</div><div class="line">    </div><div class="line">            &#125;</div><div class="line">        &#125;];</div><div class="line">[queue addOperation:bloperation];</div><div class="line">[queue addOperation:operation];</div></pre></td></tr></table></figure>
<p>åœ¨Swiftä¸­å·²ç»åºŸé™¤äº†ä½¿ç”¨NSInvocationOperationï¼Œä¸å†å°†æ–¹æ³•å°è£…åæäº¤åˆ°é˜Ÿåˆ—ï¼Œä¿ç•™äº†NSBlockOperation(åœ¨swift3ä¸­å¯¹åº”çš„ç±»æ˜¯BlockOperation)å°†ä»£ç å—å°è£…åæäº¤åˆ°é˜Ÿåˆ—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">let queue = OperationQueue.init()</div><div class="line">        let operation1 = BlockOperation.init &#123; </div><div class="line">            for i in 0...20&#123;</div><div class="line">                print(&quot;this is operation1 \(i)&quot;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line"> queue.addOperation(operation1)</div></pre></td></tr></table></figure>
<h1 id="å¼€å‘æ¨¡å¼"><a href="#å¼€å‘æ¨¡å¼" class="headerlink" title="å¼€å‘æ¨¡å¼"></a>å¼€å‘æ¨¡å¼</h1><h2 id="å•ä¾‹"><a href="#å•ä¾‹" class="headerlink" title="å•ä¾‹"></a>å•ä¾‹</h2><p>OCä¸­åˆ›å»ºå•ä¾‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">+ (CCTVUserManager *)shareObject</div><div class="line">&#123;</div><div class="line">    static CCTVUserManager *__manager = nil;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        __manager = [[self alloc] init];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return __manager;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Swiftä¸­åˆ›å»ºå•ä¾‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class ZTRequest&#123;</div><div class="line">    static let sharedInstance = ZTRequest()</div><div class="line">private init()&#123;&#125;//é˜²æ­¢å…¶å®ƒåœ°æ–¹è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="KVO"><a href="#KVO" class="headerlink" title="KVO"></a>KVO</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">dynamic var textStr:String!//éœ€è¦åœ¨ç›‘å¬çš„å€¼å¾—å‰é¢åŠ ä¸Šdynamic  </div><div class="line">private var myContext = 0</div><div class="line"></div><div class="line">self.addObserver(self, forKeyPath: &quot;textStr&quot;, options: NSKeyValueObservingOptions.new, context: &amp;myContext)</div><div class="line"></div><div class="line">//MARK:å“åº”é”®å€¼ç›‘å¬</div><div class="line">override func observeValue(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey : Any]?, context: UnsafeMutableRawPointer?) &#123;</div><div class="line">        if &amp;myContext == context &#123;</div><div class="line">            let newValue = change?[.newKey]</div><div class="line">            print(&quot;this is kvo test newValue : \(newValue)&quot;)</div><div class="line">        &#125;else&#123;</div><div class="line">            super.observeValue(forKeyPath: keyPath, of: object, change: change, context: context)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="é€šçŸ¥"><a href="#é€šçŸ¥" class="headerlink" title="é€šçŸ¥"></a>é€šçŸ¥</h2><p>//æ³¨å†Œé€šçŸ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">NotificationCenter.default.addObserver(self, selector: #selector(reciveNotificaTion(noti:)), name: NSNotification.Name(rawValue: &quot;testNotification&quot;), object: nil)</div><div class="line"></div><div class="line">//æ¥æ”¶é€šçŸ¥</div><div class="line">    @objc private func reciveNotificaTion(noti:NSNotification)&#123;</div><div class="line">        print(&quot;notifiacation : \(noti.userInfo)&quot;)</div><div class="line">&#125;</div><div class="line">//MARK:ææ„å‡½æ•°ï¼Œè¿›è¡Œè§£é™¤è§‚å¯Ÿ,é€šçŸ¥ç­‰æ“ä½œ</div><div class="line">    deinit &#123;</div><div class="line">        self.removeObserver(self, forKeyPath: &quot;textStr&quot;)</div><div class="line">        NotificationCenter.default.removeObserver(self)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h2><p>å’ŒOCä¸­ä¸€æ ·ï¼ŒSwiftä¸­ä»£ç†å’Œåè®®éƒ½æ˜¯ç´§å¯†ç›¸è¿çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">@objc</div><div class="line">protocol MyProtocol3&#123;</div><div class="line">    func test()</div><div class="line">    @objc optional func test3()</div><div class="line">&#125;</div><div class="line"></div><div class="line">class runClass&#123;</div><div class="line">    var delegate:MyProtocol3?</div><div class="line">    </div><div class="line">    func run() -&gt; Void &#123;</div><div class="line">        delegate?.test()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class testProtocol:MyProtocol3&#123;</div><div class="line">    </div><div class="line">    //MARK:Delegate</div><div class="line">    func test() &#123;</div><div class="line">        print(&quot;this is delegate&quot;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var testClass = runClass()</div><div class="line">testClass.delegate = testProtocol()</div><div class="line">testClass.delegate?.test()</div><div class="line">testClass.delegate?.test3?()</div></pre></td></tr></table></figure>
<p>åœ¨OCä¸­æˆ‘ä»¬æ£€æµ‹æŸä¸ªç±»æ˜¯å¦å®ç°äº†åè®®æ–¹æ³•æ˜¯è¿™æ ·çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if ([_delegate respondsToSelector:@selector(numberOfImagesInAdView:)]) &#123;</div><div class="line">        _imageCount = [_delegate numberOfImagesInAdView:self];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨Swift3.0ä¸­ï¼Œæ£€æµ‹æŸä¸ªç±»æ˜¯å¦å®ç°äº†åè®®æ–¹æ³•æ˜¯è¿™æ ·çš„<br>delegate?.test3?()</p>
<h1 id="å­¦ä¹ ç½‘ç«™"><a href="#å­¦ä¹ ç½‘ç«™" class="headerlink" title="å­¦ä¹ ç½‘ç«™"></a>å­¦ä¹ ç½‘ç«™</h1><p><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Extensions.html#//apple_ref/doc/uid/TP40014097-CH24-ID151" target="_blank" rel="external">The Swift Programming Language (Swift 3.0.1)</a></p>
<p><a href="https://developer.apple.com/library/content/referencelibrary/GettingStarted/DevelopiOSAppsSwift/" target="_blank" rel="external">Start Developing iOS Apps (Swift)</a></p>
<p><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID122" target="_blank" rel="external">Using Swift with Cocoa and Objective-C (Swift 3.0.1)</a></p>
<p>æ¨èå­¦ä¹ çš„å¼€æºé¡¹ç›®<br><a href="https://github.com/mozilla-mobile/firefox-ios" target="_blank" rel="external">firefox-ios</a><br>ç¼–è¯‘æ—¶çš„ç¯å¢ƒ:cocoapods 1.1.1    Homebrew 1.1.1    xcode8.0</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/22/thirdArticle/" title="ç†è§£å’Œåˆ†æåº”ç”¨ç¨‹åºå´©æºƒæŠ¥å‘Š" itemprop="url">ç†è§£å’Œåˆ†æåº”ç”¨ç¨‹åºå´©æºƒæŠ¥å‘Š</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ZT0526" target="_blank" itemprop="author">ZT0526</a>
		
  <p class="article-time">
    <time datetime="2017-08-22T03:38:51.000Z" itemprop="datePublished"> Published 2017-08-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>å†™åœ¨å‰é¢ï¼šæœ¬æ–‡ä¼šåœ¨æœ€å¼€å¤´å°†è‹¹æœå®˜æ–¹çš„æ–‡æ¡£<a href="https://developer.apple.com/library/prerelease/content/technotes/tn2151/_index.html#//apple_ref/doc/uid/DTS40008184-CH1-ANALYZING_CRASH_REPORTS" target="_blank" rel="external">Understanding and Analyzing Application Crash Reports</a>è¿›è¡Œç¿»è¯‘,ä½†è¿™ä¸ä»…ä»…æ˜¯ä¸€ç¯‡ç¿»è¯‘çš„æ–‡ç« ï¼Œæœ¬æ–‡ä¼šè®©å¤§å®¶æ›´åŠ å…¨é¢çš„äº†è§£iosçš„å´©æºƒæŠ¥å‘Šçš„è·å–ã€åˆ†æã€ç”¨é€”ã€‚ç¿»è¯‘çš„æ—¶å€™æˆ‘ä¼šç»“åˆè‡ªå·±ä»¥å¾€çš„ä½¿ç”¨ç»éªŒæ¥è¿›è¡Œç¿»è¯‘ã€‚</p>
<p>ç†è§£å’Œåˆ†æåº”ç”¨ç¨‹åºå´©æºƒæŠ¥å‘Š</p>
<p>é‡è¦æç¤ºï¼šæœ¬æ–‡æ¡£åŒ…å«æœ‰å…³å¼€å‘ä¸­çš„ä¸€ä¸ªæ¥å£æˆ–æŠ€æœ¯çš„åˆæ­¥ä¿¡æ¯ã€‚æ­¤ä¿¡æ¯å°†è¢«æ›´æ”¹ï¼Œå¹¶æ ¹æ®æœ¬æ–‡æ¡£å®ç°çš„è½¯ä»¶åº”è¯¥ç”¨æœ€ç»ˆçš„æ“ä½œç³»ç»Ÿè½¯ä»¶è¿›è¡Œæµ‹è¯•ã€‚</p>
<p>å½“åº”ç”¨ç¨‹åºå´©æºƒæ—¶ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå´©æºƒæŠ¥å‘Šï¼Œè¿™æ˜¯éå¸¸æœ‰ç”¨çš„äº†è§£ä»€ä¹ˆé€ æˆçš„å´©æºƒã€‚æœ¬æ–‡ä»¶åŒ…å«é‡è¦çš„ä¿¡æ¯ï¼Œå¦‚ä½•symbolicateï¼Œç†è§£å’Œè§£é‡Šçš„å´©æºƒæŠ¥å‘Šã€‚</p>
<p>###ç®€ä»‹</p>
<p>å½“åº”ç”¨ç¨‹åºå´©æºƒæ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªå´©æºƒæŠ¥å‘Šå¹¶å­˜å‚¨åœ¨è®¾å¤‡ä¸Šã€‚å´©æºƒæŠ¥å‘Šæè¿°çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºç»ˆæ­¢ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŒ…æ‹¬æ¯ä¸ªæ‰§è¡Œçº¿ç¨‹çš„ä¸€ä¸ªå®Œæ•´çš„å›æº¯ï¼Œé€šå¸¸å¯¹äºè°ƒè¯•åº”ç”¨ä¸­çš„é—®é¢˜æ˜¯éå¸¸æœ‰ç”¨ã€‚ä½ åº”è¯¥çœ‹çœ‹è¿™äº›å´©æºƒæŠ¥å‘Šï¼Œäº†è§£ä½ çš„åº”ç”¨ç¨‹åºæœ‰ä»€ä¹ˆå´©æºƒï¼Œç„¶åå°è¯•ä¿®å¤å®ƒä»¬ã€‚</p>
<p>æœ‰å›æº¯çš„å´©æºƒæŠ¥å‘Šéœ€è¦è¢«ç¬¦å·åŒ–äº†æ‰å¯ä»¥åˆ†æã€‚ç¬¦å·åŒ–(symbolication)æˆäººä»¬å¯è¯»çš„å‡½æ•°åç§°å’Œè¡Œå·æ¥å–ä»£å†…å­˜åœ°å€ã€‚å¦‚æœä½ é€šè¿‡Xcodeçš„è®¾å¤‡çª—å£æ¥è·å–è®¾å¤‡çš„å´©æºƒæ—¥å¿—ï¼Œå®ƒä»¬å°†åœ¨å‡ ç§’é’Ÿåè‡ªåŠ¨è¢«ç¬¦å·åŒ–ã€‚å¦åˆ™ï¼Œä½ å°†éœ€è¦è‡ªå·±å°†å´©æºƒæ—¥å¿—ç¬¦å·åŒ–ï¼Œé€šè¿‡è‡ªå·±å¯¼å…¥å´©æºƒæ–‡ä»¶åˆ°Xcodeè®¾å¤‡çª—å£ã€‚çœ‹åˆ°ç¬¦å·åŒ–ï¼ˆsymbolicatingï¼‰åçš„å´©æºƒæŠ¥å‘Šã€‚</p>
<p>ä½å†…å­˜æŠ¥å‘Šä¸åŒäºå…¶ä»–çš„å´©æºƒæŠ¥å‘Šï¼Œæ²¡æœ‰å›æœ”åœ¨è¿™ç§ç±»å‹çš„æŠ¥å‘Šã€‚å½“ä½å†…å­˜å´©æºƒå‘ç”Ÿæ—¶ï¼Œä½ å¿…é¡»è°ƒæŸ¥ä½ çš„å†…å­˜ä½¿ç”¨æ¨¡å¼å’Œå¯¹ä½å†…å­˜è­¦å‘Šçš„å“åº”ã€‚æ­¤æ–‡æ¡£æŒ‡å‘äº†æ‚¨å¯èƒ½ä¼šå‘ç°æœ‰ç”¨çš„å¤šä¸ªå†…å­˜ç®¡ç†å¼•ç”¨ã€‚</p>
<p>###è·å–å´©æºƒå’Œä½å†…å­˜æŠ¥å‘Š</p>
<p><a href="https://developer.apple.com/library/content/qa/qa1747/_index.html" target="_blank" rel="external">è°ƒè¯•éƒ¨ç½²iOSåº”ç”¨ç¨‹åº</a>  è®¨è®ºå¦‚ä½•ç›´æ¥ä»iOSè®¾å¤‡è·å–å´©æºƒå’Œå†…å­˜ä¸è¶³çš„æŠ¥é“ã€‚</p>
<p>åœ¨<a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/Introduction/Introduction.html" target="_blank" rel="external">åº”ç”¨ç¨‹åºåˆ†å‘æŒ‡å—</a>ä¸­çš„<a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/AnalyzingCrashReports/AnalyzingCrashReports.html" target="_blank" rel="external">åˆ†æå´©æºƒæŠ¥å‘Š</a> è®¨è®ºå¦‚ä½•ä»TestFlight betaæµ‹è¯•è€…å’Œé‚£äº›å·²ç»ä»App Storeä¸‹è½½åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ä¸­æ”¶é›†å´©æºƒæŠ¥å‘Šã€‚</p>
<p>###symbolicatingå´©æºƒæŠ¥å‘Š</p>
<p>symbolicationæ˜¯è§£å†³å›æº¯åœ°å€çš„æºä»£ç çš„æ–¹æ³•æˆ–å‡½æ•°åçš„è¿‡ç¨‹ï¼Œç§°ä¸ºç¬¦å·åŒ–ã€‚æ²¡æœ‰ç»è¿‡ç¬¦å·åŒ–çš„å´©æºƒæŠ¥å‘Šï¼Œæ˜¯ä¸èƒ½äº†è§£å…·ä½“çš„å´©æºƒä¿¡æ¯çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">æ³¨ï¼šä½å†…å­˜æŠ¥å‘Šä¸éœ€è¦symbolicatedã€‚</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">æ³¨ï¼šæ¥è‡ªMacOSå´©æºƒæŠ¥å‘Šé€šå¸¸æ˜¯å·²ç»ç¬¦å·åŒ–çš„ï¼Œæˆ–éƒ¨åˆ†ç¬¦å·åŒ–åçš„(symbolicated)ã€‚</div><div class="line">æœ¬èŠ‚é‡ç‚¹symbolicatingä»iOSï¼ŒWatchOSï¼Œå’ŒTVOSçš„å´©æºƒæŠ¥å‘Šï¼Œä½†æ•´ä½“è¿‡ç¨‹ç±»ä¼¼MacOSã€‚</div></pre></td></tr></table></figure>
<pre><code>å›¾1æ¦‚è¿°äº†å´©æºƒæŠ¥å‘Šå’Œsymbolicationè¿‡ç¨‹ã€‚
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/1716542-41671bb546c2be61.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è·å–å´©æºƒæŠ¥å‘Šä»¥åŠç¬¦å·åŒ–è¿‡ç¨‹"></p>
<p>1.å½“ç¼–è¯‘å™¨å°†æºä»£ç ç¿»è¯‘æˆæœºå™¨ä»£ç æ—¶ï¼Œå®ƒä¹Ÿä¼šç”Ÿæˆè°ƒè¯•ç¬¦å·ï¼Œå®ƒå°†ç¼–è¯‘åçš„äºŒè¿›åˆ¶ä¸­çš„æ¯ä¸€ä¸ªæœºå™¨æŒ‡ä»¤æ˜ å°„åˆ°æºä»£ç çš„è¡Œæºä»£ç ä¸­ã€‚æ ¹æ®è°ƒè¯•ä¿¡æ¯æ ¼å¼ï¼ˆdebug_information_formatï¼‰ç¼–è¯‘è®¾ç½®ï¼Œè¿™äº›è°ƒè¯•ç¬¦å·å­˜å‚¨åœ¨äºŒè¿›åˆ¶æˆ–åœ¨åŒä¼´çš„è°ƒè¯•ç¬¦å·æ–‡ä»¶ï¼ˆdsymï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè°ƒè¯•ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºçš„è°ƒè¯•ç¬¦å·å­˜å‚¨åœ¨ç¼–è¯‘åçš„äºŒè¿›åˆ¶ä¸­ï¼Œè€Œå‘å¸ƒç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºçš„è°ƒè¯•ç¬¦å·å­˜å‚¨åœ¨ç›¸åº”çš„dsymæ–‡ä¸­ä»¶ä»¥å‡å°‘äºŒè¿›åˆ¶å¤§å°ã€‚<br>è°ƒè¯•ç¬¦å·æ–‡ä»¶å’Œåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ä¸æ¯ä¸€ä¸ªbuildç”Ÿæˆçš„UUIDæ†ç»‘åœ¨ä¸€èµ·ã€‚ä¸€ä¸ªæ–°çš„UUIDç”Ÿæˆæ˜¯ç”±buildä¸€ä¸ªåº”ç”¨äº§ç”Ÿçš„ï¼Œå®ƒåº”ç”¨ç¨‹åºæ¯æ¬¡build(ç¼–è¯‘æ‰“åŒ…)çš„å”¯ä¸€æ ‡è¯†ã€‚å³ä½¿ä¸€ä¸ªåŠŸèƒ½ç›¸åŒçš„å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ä»ç›¸åŒçš„æºä»£ç é‡æ„ï¼Œå…·æœ‰ç›¸åŒçš„ç¼–è¯‘å™¨è®¾ç½®ï¼Œä¹Ÿä¼šæœ‰ä¸åŒçš„ç”Ÿæˆçš„UUIDã€‚è°ƒè¯•ç¬¦å·æ–‡ä»¶çš„åç»­ç‰ˆæœ¬ï¼Œç”šè‡³æ¥è‡ªåŒä¸€ä¸ªæºæ–‡ä»¶ï¼Œä¸ä¼šä¸å…¶ä»–ç‰ˆæœ¬çš„äºŒè¿›åˆ¶æ–‡ä»¶ç›¸æ··æ·†ã€‚</p>
<p>2.å½“ä½ çš„å½’æ¡£(archive)è¦åˆ†å‘çš„åº”ç”¨ç¨‹åºï¼ŒXcodeä¼šæ”¶é›†åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶éšç€.dsymæ–‡ä»¶ï¼Œå¹¶ä¸”å­˜æ”¾åœ¨homeæ–‡ä»¶å¤¹é‡Œã€‚ä½ å¯ä»¥åœ¨Xcodeçš„ç»„ç»‡è€…åœ¨â€œå½’æ¡£â€éƒ¨åˆ†ï¼Œæ‰¾åˆ°æ‰€æœ‰ä½ å½’æ¡£å(archived)çš„åº”ç”¨ã€‚æœ‰å…³åˆ›å»ºå­˜æ¡£çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ<a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/Introduction/Introduction.html" target="_blank" rel="external">åº”ç”¨ç¨‹åºåˆ†å‘æŒ‡å—</a>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">é‡è¦ï¼šä¸ºäº†ç¬¦å·åŒ–(symbolicate)ä»æµ‹è¯•äººå‘˜ï¼Œå®¡æŸ¥ç¨‹åºï¼Œå’Œå®¢æˆ·å¾—åˆ°çš„å´©æºƒæŠ¥å‘Šï¼Œä½ å¿…é¡»ä¿ç•™æ¯ä¸ªå­˜æ¡£æ‚¨çš„åº”ç”¨ç¨‹åºã€‚</div></pre></td></tr></table></figure></p>
<p>3.å¦‚æœä½ æ˜¯é€šè¿‡App Storeå‘å¸ƒçš„åº”ç”¨ç¨‹åºï¼Œæˆ–ä½¿test flightè¿›è¡Œæµ‹è¯•ï¼Œä½ å°†é€‰æ‹©åŒ…æ‹¬dsymæ–‡ä»¶åˆ°iTunes Connectã€‚åœ¨æäº¤å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©â€œæ‚¨çš„åº”ç”¨ç¨‹åºçš„åº”ç”¨ç¨‹åºç¬¦å·â€¦â€¦â€ã€‚ä¸ºäº†æ¥æ”¶æ¥test flightæ”¶é›†çš„ ä»¥åŠ é‚£äº›é€‰æ‹©äº†åˆ†äº«çš„è¯Šæ–­æ•°æ®çš„å®¢æˆ·çš„å´©æºƒæŠ¥å‘Šï¼Œä¸Šä¼ ä½ çš„dsymæ–‡ä»¶æ˜¯å¿…è¦çš„ ã€‚æœ‰å…³å´©æºƒæŠ¥å‘ŠæœåŠ¡çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒåº”ç”¨ç¨‹åºåˆ†å‘æŒ‡å—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">é‡è¦ï¼šä»app reviewæ”¶åˆ°çš„å´©æºƒæŠ¥å‘Šå°†æ˜¯unsymbolicatedï¼Œå³ä½¿ä½ æœ‰ä¸Šä¼ dsymæ–‡ä»¶åˆ°iTunes Connectã€‚</div><div class="line">ä½ éœ€è¦ä½¿ç”¨Xcode æ¥symbolicateä»»ä½•ä»app reviewå¾—åˆ°çš„å´©æºƒæŠ¥å‘Šã€‚</div><div class="line">çœ‹ä¸‹åˆä¸­&quot;åˆ°symbolicatingå´©æºƒæŠ¥å‘ŠXcode&quot;ã€‚</div></pre></td></tr></table></figure></p>
<p>4.å½“ä½ çš„åº”ç”¨ç¨‹åºå´©æºƒæ—¶ï¼Œä¸€ä¸ªunsymbolicatedå´©æºƒæŠ¥å‘Šä¼šè¢«åˆ›å»ºå¹¶å­˜å‚¨åœ¨è®¾å¤‡ä¸Šã€‚</p>
<p>5.ç”¨æˆ·å¯ä»¥æŒ‰ç…§<a href="https://developer.apple.com/library/content/qa/qa1747/_index.html" target="_blank" rel="external">è°ƒè¯•éƒ¨ç½²iOSåº”ç”¨ç¨‹åºçš„æ­¥éª¤</a>ï¼Œç›´æ¥ä»ä»–ä»¬çš„è®¾å¤‡ä¸­æ£€ç´¢å´©æºƒæŠ¥å‘Šã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºé€šè¿‡AdHoc or Enterprise distributionå‘å¸ƒçš„ï¼Œè¿™æ˜¯ä»ä½ çš„ç”¨æˆ·è·å–å´©æºƒæŠ¥å‘Šçš„å”¯ä¸€é€”å¾„ã€‚</p>
<p>6.ä»è®¾å¤‡æ£€ç´¢å¾—åˆ°çš„æœªç¬¦å·åŒ–çš„(unsymbolicated)å´©æºƒæŠ¥å‘Šéœ€è¦ä½¿ç”¨Xcodeæ¥ç¬¦å·åŒ–(symbolicated)ã€‚Xcodeä½¿ç”¨æ‚¨çš„åº”ç”¨ç¨‹åºçš„äºŒè¿›åˆ¶åœ¨æºä»£ç ä¸­çš„æºä½ç½®çš„å›æº¯æ›¿æ¢æ¯ä¸ªåœ°å€ç›¸å…³è”çš„dsymæ–‡ä»¶ã€‚å…¶ç»“æœæ˜¯ä¸€ä¸ªç¬¦å·åŒ–çš„(symbolicated)å´©æºƒæŠ¥å‘Šã€‚</p>
<p>7.å¦‚æœç”¨æˆ·é€‰æ‹©äº†ä¸è‹¹æœå…±äº«è¯Šæ–­æ•°æ®ï¼Œæˆ–è€…å¦‚æœç”¨æˆ·é€šè¿‡TestFlightå®‰è£…äº†ä½ çš„åº”ç”¨ç¨‹åºï¼Œå´©æºƒæŠ¥å‘Šä¼šè¢«ä¸Šä¼ åˆ°åº”ç”¨å•†åº—ã€‚</p>
<p>8.App Store ç¬¦å·åŒ–å´©æºƒæŠ¥å‘Š  å¹¶ä¸”å°†ç±»ä¼¼çš„å´©æºƒæŠ¥å‘Šåˆ†ç»„ã€‚ç±»ä¼¼çš„å´©æºƒæŠ¥å‘Šçš„é›†åˆè¢«ç§°ä¸ºå´©æºƒç‚¹ã€‚</p>
<p>9.ç¬¦å·åŒ–çš„å´©æºƒæŠ¥å‘Šæ˜¯åœ¨Xcodeâ€™s Crashes organizeræä¾›ç»™ä½ çš„ã€‚</p>
<p>###Bitcode<br>Bitcodeæ˜¯ä¸€ä¸ªç¼–è¯‘ç¨‹åºçš„ä¸­é—´è¡¨ç¤ºã€‚å½“ä½ å¯ä»¥ç”¨bitcodeæ¥ archive an applicationï¼Œç¼–è¯‘å™¨äº§ç”Ÿçš„äºŒè¿›åˆ¶æ–‡ä»¶åŒ…å«bitcodeè€Œä¸æ˜¯æœºå™¨ä»£ç ã€‚ä¸€æ—¦äºŒè¿›åˆ¶å·²ç»ä¸Šä¼ åˆ°App Storeï¼Œè¿™å¯ä»¥è¢«ç¼–è¯‘æˆæœºå™¨ç ã€‚App Storeåœ¨å°†æ¥ï¼Œåœ¨æ²¡æœ‰ä»»ä½•è¡ŒåŠ¨çš„ä¸€éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨æœªæ¥çš„æ”¹è¿›çš„ç¼–è¯‘å™¨ï¼Œå†æ¬¡ç¼–è¯‘ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-da1b5ebb9f45a979.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Bitcode compilation process"></p>
<p>å› ä¸ºä½ çš„äºŒè¿›åˆ¶æœ€åçš„ç¼–è¯‘å‡ºç°åœ¨App Storeï¼ŒMacå°†ä¸åŒ…å«ç¬¦å·åŒ–ä»åº”ç”¨ç¨‹åºå®¡æŸ¥æˆ–ç”¨æˆ·å‘ç»™ä½ ä»–ä»¬ä»è®¾å¤‡ä¸­å–å¾—çš„å´©æºƒæŠ¥å‘Šæ‰€éœ€è¦çš„è°ƒè¯•ç¬¦å·æ–‡ä»¶(.dsym)ã€‚è™½ç„¶dsymæ–‡ä»¶æ˜¯æ‚¨å½’æ¡£åº”ç”¨ç¨‹åº(archive your application)çš„æ—¶å€™äº§ç”Ÿçš„ï¼Œå®ƒæ˜¯ä¸ºbitcodeäºŒè¿›åˆ¶å¹¶ä¸èƒ½ç”¨æ¥symbolicateå´©æºƒæŠ¥å‘Šã€‚App Storeåœ¨ä½ ä»Xcodeæˆ–ä»iTunes Connectç½‘ç«™ï¼Œå¯ä»¥è·å¾—ç¼–è¯‘çš„bitcodeå¹¶ä¸”å¯ä»¥ä¸‹è½½çš„è¿‡ç¨‹ä¸­ï¼Œäº§ç”Ÿdsymæ–‡ä»¶ã€‚ç¬¦å·åŒ–ä»åº”ç”¨ç¨‹åºå®¡æŸ¥æˆ–ç”¨æˆ·å‘ç»™ä½ ä»–ä»¬ä»è®¾å¤‡ä¸­å–å¾—çš„å´©æºƒæŠ¥å‘Šï¼Œä½ å¿…é¡»ä¸‹è½½è¿™äº›dsymæ–‡ä»¶ã€‚å´©æºƒæŠ¥å‘Šè·å¾—é€šè¿‡å´©æºƒæŠ¥å‘ŠæœåŠ¡å°†è‡ªåŠ¨symbolicatedã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">é‡è¦ï¼šäºŒè¿›åˆ¶åº”ç”¨ç¨‹åºå•†åº—ä¼šæ¯”æœ€åˆäºŒè¿›åˆ¶ç¼–è¯‘ï¼Œæœ‰ä¸åŒçš„UUID</div></pre></td></tr></table></figure>
<p>###ä»Xcodeè·å–dSYMsæ–‡ä»¶<br>1.ä¸‹è½½dsymsæ–‡ä»¶<br>åœ¨å½’æ¡£ç®¡ç†ä¸­é€‰æ‹©ç›¸åº”çš„å½’æ¡£å¹¶ä¸‹è½½dsymsæ–‡ä»¶</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-b92d2c3b7e4f5e85.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-0@2x.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-6bc36eb3ec7282b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-1@2x.png"></p>
<p>2.åœ¨å½’æ¡£å‡ºçš„æ–‡ä»¶ä¸­æ‰¾åˆ°dSYMsæ–‡ä»¶<br><img src="http://upload-images.jianshu.io/upload_images/1716542-edc067855fbf744b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-130da505d3b99940.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-3@2x.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-a2650a367b7d7bcc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-4@2x.png"></p>
<p>###ç¡®å®šå´©æºƒæŠ¥å‘Šæ˜¯å¦è¢«ç¬¦å·åŒ–</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-cc0f6a4616b017b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tn2151_symbolication_levels.png"></p>
<p>###ç¬¦å·åŒ–å´©æºƒæŠ¥å‘Š<br>1.ç¬¦å·åŒ–ç”¨xcodeç¼–è¯‘å®‰è£…è½¯ä»¶çš„è®¾å¤‡ä¸Šçš„å´©æºƒæŠ¥å‘Š<br>å½“åº”ç”¨åœ¨è®¾å¤‡ä¸Šè¿è¡Œï¼Œé‡åˆ°å´©æºƒçš„æ—¶å€™ä¼šäº§ç”Ÿå´©æºƒæ—¥å¿—ã€‚å¦‚æœè¿™ä¸ªåº”ç”¨æ˜¯ç”¨xcodeç›´æ¥åœ¨è®¾å¤‡ä¸Šç¼–è¯‘è¿è¡Œçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†æ‰‹æœºè¿æ¥åˆ°ç¼–è¯‘çš„æ—¶å€™æ‰€ç”¨çš„ç”µè„‘ä¸Šï¼Œæ‰“å¼€xcodeï¼Œåœ¨Windowçš„Devicesä¸­å»æŸ¥çœ‹æ—¥å¿—ã€‚æ‰¾åˆ°æ—¥å¿—çš„æ—¶å€™ï¼Œxcodeä¼šè‡ªå·±å»ç¬¦å·åŒ–å´©æºƒæ—¥å¿—ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-d8d2528505d512e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é€‰å–è®¾å¤‡"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-12f462f74b01c477.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŸ¥çœ‹è®¾å¤‡æ—¥å¿—"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-59ef6016fa4e3d94.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="xcodeè‡ªå·±å»ç¬¦å·åŒ–å´©æºƒæ–‡ä»¶"></p>
<p>2.ç¬¦å·åŒ–ç”¨å®‰è£…åŒ…å®‰è£…åœ¨æµ‹è¯•è®¾å¤‡ä¸Šçš„åº”ç”¨æ‰€äº§ç”Ÿçš„å´©æºƒæ—¥å¿—<br>ç¬¦å·åŒ–çš„æ—¶å€™éœ€è¦å‡†å¤‡symbolicatecrashæ–‡ä»¶ .dSYMæ–‡ä»¶ ä»¥åŠ.appæ–‡ä»¶<br>ç¬¦å·åŒ–å‰å…ˆæ£€æŸ¥ä¸€ä¸‹ä¸‰è€…çš„uuidæ˜¯ä¸æ˜¯ä¸€è‡´çš„,åªæœ‰æ˜¯ä¸€è‡´çš„æ‰èƒ½ç¬¦å·åŒ–æˆåŠŸã€‚<br>æŸ¥çœ‹xx.appæ–‡ä»¶çš„uuidçš„æ–¹æ³•ï¼š<br>dwarfdump â€“uuid xxx.app/xxx (xxxå·¥ç¨‹å)<br>æŸ¥çœ‹xx.app.dSYMæ–‡ä»¶çš„uuidçš„æ–¹æ³•ä»¤ï¼š<br>dwarfdump â€“uuid xxx.app.dSYM (xxxå·¥ç¨‹å)<br>è€Œ.crashçš„uuidä½äºï¼Œcrashæ—¥å¿—ä¸­çš„Binary Images:ä¸­çš„ç¬¬ä¸€è¡Œå°–æ‹¬å·å†…ã€‚å¦‚ï¼šarmv7 <8bdeaf1a0b233ac199728c2a0ebb4165></8bdeaf1a0b233ac199728c2a0ebb4165></p>
<p>å°†ä¸‰ç§æ–‡ä»¶æ‹·è´åˆ°åŒä¸€ä¸ªç›®å½•ä¸­ï¼Œåœ¨ç»ˆç«¯ä¸­ä½¿ç”¨å‘½ä»¤<br>./symbolicatecrash ./<em>.crash ./</em>.app.dSYM &gt; xxx.crashæ¥è§£æå´©æºƒæ—¥å¿—ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-6cf5ed8bbecce6fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="asdasd"></p>
<p>å¦‚æœæƒ³ä»Šåè§£ææ—¥å¿—çš„æ—¶å€™æ›´æ–¹ä¾¿ä¸€ç‚¹ï¼Œç‰¹åˆ«æ˜¯è§£æå¤šä¸ªå´©æºƒæ—¥å¿—çš„æ—¶å€™ï¼Œå¦‚æœä¸€ä¸ªä¸€ä¸ªå»è§£æçš„è¯ï¼Œå¾ˆèŠ±è´¹æ—¶é—´çš„ã€‚æˆ‘çš„è¯ï¼Œä¼šå°†è¿™äº›å†™åˆ°ä¸€ä¸ªè„šæœ¬ä¸­ï¼Œè§£æçš„æ—¶å€™å°±åªç”¨æ‰§è¡Œè„šæœ¬ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿å¿«æ·çš„è·å–åˆ°å´©æºƒæ—¥å¿—ã€‚</p>
<p>3.è·å–å¹¶ç¬¦å·åŒ–çº¿ä¸Šçš„å´©æºƒæŠ¥å‘Š<br>ä¸€.é€šè¿‡æ‰“åŒ…ä¸Šçº¿æ—¶çš„xcodeæ¥è·å–çº¿ä¸Šçš„å´©æºƒæŠ¥å‘Š<br>çº¿ä¸Šappçš„å´©æºƒæ—¥å¿—ä¼šè¢«app storeæ”¶é›†å¹¶ç¬¦å·åŒ–åˆ†ç»„ã€‚ç±»ä¼¼çš„å´©æºƒæŠ¥å‘Šçš„é›†åˆè¢«ç§°ä¸ºå´©æºƒç‚¹ã€‚(å¦‚æœç”¨æˆ·é€‰æ‹©äº†ä¸è‹¹æœå…±äº«è¯Šæ–­æ•°æ®ï¼Œè¿™äº›å´©æºƒæ—¥å¿—æ‰ä¼šè¢«æ”¶é›†å¹¶è¢«ç¬¦å·åŒ–)</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-a74a8ad28c33edb2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-0@2x.png"></p>
<p>åœ¨ç‚¹å‡»ç›¸åº”åº”ç”¨åï¼Œä¼šæ˜¾ç¤ºæ­¤åº”ç”¨çš„å´©æºƒé›†åˆã€‚å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªé›†åˆä¸­éƒ½ä¼šæœ‰å¾ˆå¤šä¸ªè®¾å¤‡ï¼Œå¦‚æœå³é”®è¿›å»æŸ¥çœ‹çš„è¯ï¼Œä¼šçœ‹åˆ°å¾ˆå¤šæ–‡ä»¶ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1716542-35b71f1517a3cdcd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-0.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-777d4adcda3b8b91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-1.png"><br>å†æ¬¡å³é”®è¿›å»æŸ¥çœ‹çš„è¯ï¼Œä¼šæœ€ç»ˆçœ‹åˆ°è¯¦ç»†çš„å´©æºƒæ—¥å¿—</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-7b62ba2a93342a4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-7.png"></p>
<p>å½“é€‰ä¸­äº†ä¸€ä¸ªå´©æºƒé›†åˆåï¼Œå¦‚æœé€‰æ‹©åœ¨é¡¹ç›®ä¸­æ‰“å¼€ï¼Œä¼šåœ¨é¡¹ç›®ä»£ç ä¸­æ‰¾åˆ°å…·ä½“å‡ºé—®é¢˜çš„ä»£ç </p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-cda9605cbcc8c920.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-8.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-333d4f8d5e8a6556.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-2.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-59618d5d1f41eaf9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161122-3.png"><br>äºŒã€é€šè¿‡å‹ç›Ÿç­‰ç¬¬ä¸‰æ–¹å·¥å…·æ¥è·å–å´©æºƒæ—¥å¿—<br>å´©æºƒæ—¥å¿—åˆ—è¡¨<br><img src="http://upload-images.jianshu.io/upload_images/1716542-69d3702394f2ff26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161209-0.png"><br>å…¶ä¸­çš„ä¸€ä¸ªå´©æºƒæ—¥å¿—<br><img src="http://upload-images.jianshu.io/upload_images/1716542-ec82ba3e8db570b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161209-1.png"><br>å´©æºƒçš„ä»£ç çš„ä½ç½®ï¼Œè¿™ä¸ªæ˜¯æœ€å…³é”®çš„ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¥æ‰¾åˆ°ä»£ç ä¸­çš„å‡ºé—®é¢˜çš„åœ°æ–¹<br><img src="http://upload-images.jianshu.io/upload_images/1716542-1c2964ec6ead1bbf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161209-2.png"><br>export dSYMPath=â€$(find ~/Library/Developer/Xcode -iname â€˜*.dSYMâ€™ -print0 | xargs -0 dwarfdump -u  | grep C0349572-9622-3A00-81D0-4DDE0E00DC7A | sed -E â€˜s/^[^/]+//â€˜ | head -n 1)â€;æ˜¯ä¸ºäº†æ‰¾åˆ°å½’æ¡£æ—¶å€™äº§ç”Ÿçš„dsymæ–‡ä»¶çš„è·¯å¾„</p>
<p>dwarfdump â€“arch=armv7 â€“lookup 0x426031 â€œ$dSYMPathâ€æ˜¯ç¬¦å·åŒ–çš„å…³é”®ï¼Œå¯ä»¥æ‰¾å‡ºå‡ºé—®é¢˜çš„åœ°æ–¹ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-4eea0206ed055974.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20161209-4.png"></p>
<p>###åˆ†æç¬¦å·åŒ–åçš„å´©æºƒæŠ¥å‘Š<br>1.å¤´éƒ¨<br>æ¯ä¸ªå´©æºƒæŠ¥å‘Šéƒ½ä¼šä»¥ä¸€ä¸ªå¤´éƒ¨å¼€å§‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Listing 4  Excerpt of the header from a crash report.</div><div class="line">Incident Identifier: B6FD1E8E-B39F-430B-ADDE-FC3A45ED368C</div><div class="line">CrashReporter Key: f04e68ec62d3c66057628c9ba9839e30d55937dc</div><div class="line">Hardware Model: iPad6,8</div><div class="line">Process: TheElements [303]</div><div class="line">Path: /private/var/containers/Bundle/Application/888C1FA2-3666-4AE2-9E8E-62E2F787DEC1/TheElements.app/TheElements</div><div class="line">Identifier: com.example.apple-samplecode.TheElements</div><div class="line">Version: 1.12</div><div class="line">Code Type: ARM-64 (Native)</div><div class="line">Role: Foreground</div><div class="line">Parent Process: launchd [1]</div><div class="line">Coalition: com.example.apple-samplecode.TheElements [402]</div><div class="line"> </div><div class="line">Date/Time: 2016-08-22 10:43:07.5806 -0700</div><div class="line">Launch Time: 2016-08-22 10:43:01.0293 -0700</div><div class="line">OS Version: iPhone OS 10.0 (14A5345a)</div><div class="line">Report Version: 104</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹çš„å€¼æ˜¯ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„:</p>
<p>Incident Identifier: ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†. ä¸ä¼šå­˜åœ¨å…±ç”¨ä¸€ä¸ªæ ‡è¯†çš„å´©æºƒæŠ¥å‘Š.<br>CrashReporter Key:æ˜¯ä¸è®¾å¤‡æ ‡è¯†ç›¸å¯¹åº”çš„å”¯ä¸€é”®å€¼ã€‚è™½ç„¶å®ƒä¸æ˜¯çœŸæ­£çš„è®¾å¤‡æ ‡è¯†ç¬¦ï¼Œä½†ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æƒ…æŠ¥:å¦‚æœä½ çœ‹åˆ°100ä¸ªå´©æºƒæ—¥å¿—çš„CrashReporter Keyå€¼éƒ½æ˜¯ç›¸åŒçš„ï¼Œæˆ–è€…åªæœ‰å°‘æ•°å‡ ä¸ªä¸åŒçš„CrashReportå€¼ï¼Œè¯´æ˜è¿™ä¸æ˜¯ä¸€ä¸ªæ™®éçš„é—®é¢˜ï¼Œåªå‘ç”Ÿåœ¨ä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªè®¾å¤‡ä¸Šã€‚<br>Process: æ˜¯åº”ç”¨åç§°ã€‚ä¸­æ‹¬å·é‡Œé¢çš„æ•°å­—æ˜¯é—ªé€€æ—¶åº”ç”¨çš„è¿›ç¨‹IDã€‚<br>Version: å´©æºƒè¿›ç¨‹çš„ç‰ˆæœ¬å·. è¿™ä¸ªå€¼åŒ…å«åœ¨ CFBundleVersion and CFBundleVersionStringä¸­.<br>Code Type: å´©æºƒæ—¥å¿—æ‰€åœ¨è®¾å¤‡çš„æ¶æ„. ä¼šæ˜¯ARM-64, ARM, x86-64, or x86ä¸­çš„ä¸€ä¸ª.<br>OS Version: å´©æºƒå‘ç”Ÿæ—¶çš„ç³»ç»Ÿç‰ˆæœ¬</p>
<p>###å¼‚å¸¸ä¿¡æ¯<br>å¼‚å¸¸ä¿¡æ¯ä¼šåˆ—å‡ºå¼‚å¸¸çš„ç±»å‹ã€ä½ç½®ã€‚</p>
<p>ä»¥ä¸‹çš„å†…å®¹æ˜¯æ‘˜å½•çš„ä¸€ä¸ªå´©æºƒæŠ¥å‘Šçš„å¼‚å¸¸ä»£ç æ®µ,è¯¥å´©æºƒæŠ¥å‘Šæ˜¯ä¸€ä¸ªè¿›ç¨‹ç”±äºä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸è€Œå´©æºƒäº§ç”Ÿçš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Exception Type: EXC_CRASH (SIGABRT)</div><div class="line">Exception Codes: 0x0000000000000000, 0x0000000000000000</div><div class="line">Exception Note: EXC_CORPSE_NOTIFY</div><div class="line">Triggered by Thread: 0</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹çš„å†…å®¹æ˜¯æ‘˜å½•äºä¸€ä¸ªå› ä¸ºç©ºæŒ‡é’ˆçš„è®¿é—®è€Œå´©æºƒäº§ç”Ÿçš„å´©æºƒæŠ¥å‘Šçš„å¼‚å¸¸ä»£ç æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Exception Type: EXC_BAD_ACCESS (SIGSEGV)</div><div class="line">Exception Subtype: KERN_INVALID_ADDRESS at 0x0000000000000000</div><div class="line">Termination Signal: Segmentation fault: 11</div><div class="line">Termination Reason: Namespace SIGNAL, Code 0xb</div><div class="line">Terminating Process: exc handler [0]</div><div class="line">Triggered by Thread: 0</div></pre></td></tr></table></figure>
<p>å¼‚å¸¸ä¿¡æ¯ä¸­å¯èƒ½å‡ºç°çš„å­—æ®µçš„è§£é‡Šå¦‚ä¸‹ï¼š<br>Exception Codes: å¤„ç†å™¨çš„å…·ä½“ä¿¡æ¯æœ‰å…³çš„å¼‚å¸¸ç¼–ç æˆä¸€ä¸ªæˆ–å¤šä¸ª64ä½è¿›åˆ¶æ•°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåŒºåŸŸä¸ä¼šè¢«å‘ˆç°ï¼Œå› ä¸ºå°†å¼‚å¸¸ä»£ç è§£ææˆäººä»¬å¯ä»¥çœ‹æ‡‚çš„æè¿°æ˜¯åœ¨å…¶å®ƒåŒºåŸŸè¿›è¡Œçš„ã€‚<br>Exception Subtype: ä¾›äººä»¬å¯è¯»çš„å¼‚å¸¸ä»£ç çš„åå­—<br>Exception Message: ä»å¼‚å¸¸ä»£ç ä¸­æå–çš„é¢å¤–çš„å¯ä¾›äººä»¬é˜…è¯»çš„ä¿¡æ¯.<br>Exception Note: ä¸æ˜¯ç‰¹å®šäºä¸€ä¸ªå¼‚å¸¸ç±»å‹çš„é¢å¤–ä¿¡æ¯.å¦‚æœè¿™ä¸ªåŒºåŸŸåŒ…å«SIMULATED (è¿™ä¸æ˜¯ä¸€ä¸ªå´©æºƒ)ç„¶åè¿›ç¨‹æ²¡æœ‰å´©æºƒï¼Œä½†æ˜¯è¢«watchdogæ€æ‰äº†<br>Termination Reason: å½“ä¸€ä¸ªè¿›ç¨‹è¢«ç»ˆæ­¢çš„æ—¶çš„åŸå› ã€‚<br>Triggered by Thread: å¼‚å¸¸æ‰€åœ¨çš„çº¿ç¨‹.</p>
<p>ä¸‹é¢çš„å°èŠ‚å°†ä»‹ç»ä¸€äº›æœ€å¸¸è§çš„å¼‚å¸¸ç±»å‹ã€‚</p>
<p>###Bad Memory Access [EXC_BAD_ACCESS // SIGSEGV // SIGBUS]</p>
<p>è¿›ç¨‹è¯•å›¾è®¿é—®æ— æ•ˆçš„å†…å­˜ï¼Œæˆ–è¯•å›¾ä»¥å†…å­˜çš„ä¿æŠ¤çº§åˆ«æ‰€ä¸å…è®¸çš„æ–¹å¼å»è®¿é—®å†…å­˜ï¼ˆä¾‹å¦‚ï¼Œå†™å…¥åˆ°åªè¯»å­˜å‚¨å™¨ï¼‰ã€‚å¼‚å¸¸ç±»å‹å­—æ®µ(Exception Subtype)åŒ…å«ä¸€ä¸ªkern_return_tæè¿°é”™è¯¯ï¼Œå’Œé”™è¯¯çš„è®¿é—®çš„å†…å­˜åœ°å€ã€‚</p>
<p>è¿™é‡Œæ˜¯è°ƒè¯•ä¸€ä¸ªBad Memory Accessçš„ä¸€äº›å°æŠ€å·§:</p>
<p>1.å¦‚æœobjc_msgSendæˆ–è€…objc_releaseåœ¨å›æº¯(Backtraces)çš„é¡¶éƒ¨é™„è¿‘ï¼Œè¿™ä¸ªè¿›ç¨‹å¯èƒ½æ˜¯å°è¯•ç»™ä¸€ä¸ªé‡Šæ”¾çš„å¯¹è±¡å‘é€æ¶ˆæ¯ã€‚ä½ åº”è¯¥ç”¨Zombies instrument(è°ƒè¯•åƒµå°¸å¯¹è±¡çš„å·¥å…·)æ¥æ›´å¥½çš„ç†è§£è¿™ä¸ªå´©æºƒã€‚</p>
<p>2.å¦‚æœgpus_ReturnNotPermittedKillClientåœ¨å›æº¯çš„é¡¶éƒ¨é™„è¿‘ï¼Œè¿™ä¸ªè¿›ç¨‹æ˜¯ç”±äºåœ¨åå°å°è¯•ç”¨OpenGL ES æˆ–è€… Metalæ¥æ¸²æŸ“ï¼Œè€Œè¢«æ€æ‰çš„ã€‚<a href="https://developer.apple.com/library/content/qa/qa1766/_index.html" target="_blank" rel="external">See QA1766: How to fix OpenGL ES application crashes when moving to the background.</a></p>
<p>3.ç”¨åœ°å€æ¶ˆæ¯’å‰‚(<a href="https://developer.apple.com/videos/play/wwdc2015/413/" target="_blank" rel="external">Address Sanitizer</a>,è¿™æ˜¯xcode7å¼•å…¥çš„æ–°ç‰¹æ€§ )æ¥è·‘ç¨‹åºã€‚<br>The address sanitizer adds additional instrumentation around memory access in your compiled code. As your application runs, Xcode will alert you if memory is accessed in a way that could lead to a crash.</p>
<p>###Abnormal Exit (å¼‚å¸¸é€€å‡º)[EXC_CRASH // SIGABRT]</p>
<p>è¿›ç¨‹å¼‚å¸¸é€€å‡ºã€‚è¯¥å¼‚å¸¸ç±»å‹å´©æºƒæœ€å¸¸è§çš„åŸå› æ˜¯æœªæ•è·çš„Objective-Cå’ŒC++å¼‚å¸¸å’Œè°ƒç”¨abort()ã€‚<br>å¦‚æœä»–ä»¬éœ€è¦å¤ªå¤šçš„æ—¶é—´æ¥åˆå§‹åŒ–ï¼Œç¨‹åºå°†è¢«ç»ˆæ­¢ï¼Œå› ä¸ºè§¦å‘äº†çœ‹é—¨ç‹—ã€‚å¦‚æœæ˜¯å› ä¸ºå¯åŠ¨çš„æ—¶å€™è¢«æŒ‚èµ·ï¼Œæ‰€äº§ç”Ÿçš„å´©æºƒæŠ¥å‘Šå¼‚å¸¸ç±»å‹(Exception Subtype)å°†æ˜¯launch_hangã€‚</p>
<p>###Trace Trap (è¿½è¸ªæ•è·)[EXC_BREAKPOINT // SIGTRAP]<br>ç±»ä¼¼äºå¼‚å¸¸é€€å‡º,è¿™ä¸ªå¼‚å¸¸æ˜¯ä¸ºäº†ç»™é™„åŠ çš„è°ƒè¯•å™¨ä¸­æ–­çš„è¿‡ç¨‹çš„æœºä¼šåœ¨å…¶æ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„ç‚¹ã€‚æ‚¨å¯ä»¥ä»æ‚¨è‡ªå·±çš„ä»£ç å¼•å‘æ­¤å¼‚å¸¸ä½¿ç”¨__builtin_trap()å‡½æ•°ã€‚å¦‚æœæ²¡æœ‰è°ƒè¯•å™¨è¿æ¥,è¿›ç¨‹å°†è¢«ç»ˆæ­¢å¹¶ç”Ÿæˆå´©æºƒæŠ¥å‘Šã€‚</p>
<p>###Illegal Instruction(éæ³•æŒ‡ä»¤) [EXC_BAD_INSTRUCTION // SIGILL]<br>è¿›ç¨‹è¯•å›¾æ‰§è¡Œéæ³•æˆ–æœªå®šä¹‰æŒ‡ä»¤ã€‚è¿™ä¸ªè¿›ç¨‹å¯èƒ½è¯•å›¾é€šè¿‡ä¸€ä¸ªé…ç½®é”™è¯¯çš„å‡½æ•°æŒ‡é’ˆï¼Œè·³åˆ°ä¸€ä¸ªæ— æ•ˆçš„åœ°å€ã€‚åœ¨è‹±ç‰¹å°”å¤„ç†å™¨,ud2æ“ä½œç é€ æˆEXC_BAD_INSTRUCTIONå¼‚å¸¸ä½†é€šå¸¸ç”¨äºè°ƒè¯•çš„æ—¶å€™çš„è¿½è¸ªã€‚åœ¨è‹±ç‰¹å°”å¤„ç†å™¨ä¸Šçš„swiftä»£ç å› ä¸ºè¿™ä¸ªå¼‚å¸¸ç±»å‹è€Œè¢«ç»ˆæ­¢ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶é‡åˆ°æ„å¤–æƒ…å†µã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯,è¯·å‚é˜…è¿½è¸ªæ•è·ã€‚</p>
<p>###Resource Limit [EXC_RESOURCE]<br>è¿™ä¸ªè¿›ç¨‹è¶…å‡ºäº†èµ„æºæ¶ˆè€—çš„é™åˆ¶ã€‚è¿™æ˜¯ä¸€ä¸ªä»æ“ä½œç³»ç»Ÿé€šçŸ¥,è¿›ç¨‹æ˜¯ä½¿ç”¨å¤ªå¤šçš„èµ„æºã€‚è¿™è™½ç„¶ä¸æ˜¯å´©æºƒä½†ä¹Ÿä¼šç”Ÿæˆå´©æºƒæ—¥å¿—ã€‚</p>
<p>##å…¶å®ƒçš„å¼‚å¸¸ä¿¡æ¯</p>
<p>0x8badf00d: è¯»åš â€œate bad foodâ€! (æŠŠæ•°å­—æ¢æˆå­—æ¯ï¼Œæ˜¯ä¸æ˜¯å¾ˆåƒ :p)è¯¥ç¼–ç è¡¨ç¤ºåº”ç”¨æ˜¯å› ä¸ºå‘ç”Ÿwatchdogè¶…æ—¶è€Œè¢«iOSç»ˆæ­¢çš„ã€‚  é€šå¸¸æ˜¯åº”ç”¨èŠ±è´¹å¤ªå¤šæ—¶é—´è€Œæ— æ³•å¯åŠ¨ã€ç»ˆæ­¢æˆ–å“åº”ç”¨ç³»ç»Ÿäº‹ä»¶ã€‚</p>
<p>0xbad22222: è¯¥ç¼–ç è¡¨ç¤º VoIP åº”ç”¨å› ä¸ºè¿‡äºé¢‘ç¹é‡å¯è€Œè¢«ç»ˆæ­¢ã€‚<br>0xdead10cc: è¯»åš â€œdead lockâ€!è¯¥ä»£ç è¡¨æ˜åº”ç”¨å› ä¸ºåœ¨åå°è¿è¡Œæ—¶å ç”¨ç³»ç»Ÿèµ„æºï¼Œå¦‚é€šè®¯å½•æ•°æ®åº“ä¸é‡Šæ”¾è€Œè¢«ç»ˆæ­¢ ã€‚<br>0xdeadfa11: è¯»åš â€œdead fallâ€! è¯¥ä»£ç è¡¨ç¤ºåº”ç”¨æ˜¯è¢«ç”¨æˆ·å¼ºåˆ¶é€€å‡ºçš„ã€‚æ ¹æ®è‹¹æœæ–‡æ¡£, å¼ºåˆ¶é€€å‡ºå‘ç”Ÿåœ¨ç”¨æˆ·é•¿æŒ‰å¼€å…³æŒ‰é’®ç›´åˆ°å‡ºç° â€œæ»‘åŠ¨æ¥å…³æœºâ€, ç„¶åé•¿æŒ‰ HomeæŒ‰é’®ã€‚å¼ºåˆ¶é€€å‡ºå°†äº§ç”Ÿ åŒ…å«0xdeadfa11 å¼‚å¸¸ç¼–ç çš„å´©æºƒæ—¥å¿—, å› ä¸ºå¤§å¤šæ•°æ˜¯å¼ºåˆ¶é€€å‡ºæ˜¯å› ä¸ºåº”ç”¨é˜»å¡äº†ç•Œé¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å¾…è¡¥å……</div></pre></td></tr></table></figure>
<p>###å…¶å®ƒæ•æ‰å’Œç¬¦å·åŒ–å´©æºƒæ—¥å¿—çš„æ–¹æ³•<br>1.é€šè¿‡ä»£ç æ¥æ•æ‰å´©æºƒä¿¡æ¯ï¼Œå¹¶å‘é€åˆ°æŒ‡å®šçš„åœ°æ–¹<br>åœ¨é¡¹ç›®çš„ä»£ç ä¸­é‡æ–°æŒ‡å®šé¡¶å±‚çš„é”™è¯¯å¤„ç†çš„handler,è¿™æ ·å¯ä»¥åœ¨è½¯ä»¶å´©æºƒå‰çš„æœ€åä¸€ç§’è°ƒç”¨é”™è¯¯å¤„ç†çš„å‡½æ•°æ¥è·å¾—å´©æºƒçš„ä¿¡æ¯(è¿™é‡Œçš„ä¿¡æ¯å·²ç»æ˜¯è¢«ç¬¦å·åŒ–çš„)ã€‚ç„¶åå°†å´©æºƒä¿¡æ¯å‘é€åˆ°è‡ªå·±çš„æœåŠ¡å™¨æˆ–è€…å…¶å®ƒçš„åœ°æ–¹ï¼Œä»¥ä¾¿å¼€å‘è€…å·©å›ºè‡ªå·±çš„ä»£ç çš„å¯é æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</div><div class="line">&#123;</div><div class="line">    [[AFNetworkReachabilityManager sharedManager] startMonitoring];</div><div class="line">    appDelegate = self;</div><div class="line">    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];</div><div class="line">    // Override point for customization after application launch.</div><div class="line">    self.window.backgroundColor = [UIColor whiteColor];</div><div class="line">    UILocalNotification *notification = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];</div><div class="line">    _notification = notification;</div><div class="line">    </div><div class="line">    NSSetUncaughtExceptionHandler(&amp;caughtExceptionHandler);</div><div class="line">    /*Changes the top-level error handler.</div><div class="line">    Sets the top-level error-handling function where you can perform last-minute logging before the program terminates</div><div class="line">    */</div><div class="line">    return YES;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void caughtExceptionHandler(NSException *exception)&#123;</div><div class="line">    /**</div><div class="line">     *  è·å–å¼‚å¸¸å´©æºƒä¿¡æ¯</div><div class="line">     */</div><div class="line">    NSArray *callStack = [exception callStackSymbols];</div><div class="line">    NSString *reason = [exception reason];</div><div class="line">    NSString *name = [exception name];</div><div class="line">    NSString *content = [NSString stringWithFormat:@&quot;========å¼‚å¸¸é”™è¯¯æŠ¥å‘Š========\\nname:%@\\nreason:\\n%@\\ncallStackSymbols:\\n%@&quot;,name,reason,[callStack componentsJoinedByString:@&quot;\\n&quot;]];</div><div class="line">    </div><div class="line">    //æŠŠå¼‚å¸¸å´©æºƒä¿¡æ¯å‘é€è‡³å¼€å‘è€…é‚®ä»¶</div><div class="line">    NSMutableString *mailUrl = [NSMutableString string];</div><div class="line">    [mailUrl appendString:@&quot;mailto:xxx@qq.com&quot;];</div><div class="line">    [mailUrl appendString:@&quot;?subject=ç¨‹åºå¼‚å¸¸å´©æºƒä¿¡æ¯ï¼Œè¯·é…åˆå‘é€å¼‚å¸¸æŠ¥å‘Šï¼Œè°¢è°¢åˆä½œï¼&quot;];</div><div class="line">    [mailUrl appendFormat:@&quot;&amp;body=%@&quot;, content];</div><div class="line">    // æ‰“å¼€åœ°å€</div><div class="line">    NSString *mailPath = [mailUrl stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];</div><div class="line">    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:mailPath]];</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/21/firstArticle/" title="åŠ¨ç”»åˆ†äº«" itemprop="url">åŠ¨ç”»åˆ†äº«</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ZT0526" target="_blank" itemprop="author">ZT0526</a>
		
  <p class="article-time">
    <time datetime="2017-08-21T09:27:33.000Z" itemprop="datePublished"> Published 2017-08-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="åŠ¨ç”»åˆ†äº«"><a href="#åŠ¨ç”»åˆ†äº«" class="headerlink" title="åŠ¨ç”»åˆ†äº«"></a>åŠ¨ç”»åˆ†äº«</h1><h3 id="Core-Animationç»“æ„"><a href="#Core-Animationç»“æ„" class="headerlink" title="Core Animationç»“æ„"></a>Core Animationç»“æ„</h3><p>ç»§æ‰¿å…³ç³»</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-adfb456c9829406b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="626233-43bafe84d8aee5bf.png"></p>
<p>å…¶ä¸­ç°è‰²è™šçº¿è¡¨ç¤ºç»§æ‰¿å…³ç³»ï¼Œçº¢è‰²è¡¨ç¤ºéµå®ˆåè®®ã€‚</p>
<p>æ ¸å¿ƒåŠ¨ç”»ä¸­æ‰€æœ‰ç±»éƒ½éµå®ˆCAMediaTimingåè®®ã€‚<br>CAAnaimationæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œä¸å…·å¤‡åŠ¨ç”»æ•ˆæœï¼Œå¿…é¡»ç”¨å®ƒçš„å­ç±»æ‰æœ‰åŠ¨ç”»æ•ˆæœã€‚</p>
<p>CAAnimationGroupæ˜¯ä¸ªåŠ¨ç”»ç»„ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œç¼©æ”¾ï¼Œæ—‹è½¬ï¼ˆåŒæ—¶è¿›è¡Œå¤šä¸ªåŠ¨ç”»ï¼‰ã€‚</p>
<p>CATransitionæ˜¯è½¬åœºåŠ¨ç”»ï¼Œç•Œé¢ä¹‹é—´è·³è½¬ï¼ˆåˆ‡æ¢ï¼‰éƒ½å¯ä»¥ç”¨è½¬åœºåŠ¨ç”»ã€‚</p>
<p>CAPropertyAnimationä¹Ÿæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œæœ¬èº«ä¸å…·å¤‡åŠ¨ç”»æ•ˆæœï¼Œåªæœ‰å­ç±»æ‰æœ‰ã€‚</p>
<p>CABasicAnimationå’ŒCAKeyframeAnimationï¼š<br>CABasicAnimationåŸºæœ¬åŠ¨ç”»ï¼Œåšä¸€äº›ç®€å•æ•ˆæœã€‚<br>CAKeyframeAnimationå¸§åŠ¨ç”»ï¼Œåšä¸€äº›è¿ç»­çš„æµç•…çš„åŠ¨ç”»ã€‚</p>
<h3 id="CAMediaTimingåè®®"><a href="#CAMediaTimingåè®®" class="headerlink" title="CAMediaTimingåè®®"></a>CAMediaTimingåè®®</h3><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>beginTime</td>
<td>å¼€å§‹æ—¶é—´,å¯ä»¥ç”¨æ¥è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œæ—¶é—´ï¼Œè‹¥æƒ³å»¶è¿Ÿ2sï¼Œå°±è®¾ç½®ä¸ºCACurrentMediaTime()+2ï¼Œ<br>CACurrentMediaTime()ä¸ºå›¾å±‚çš„å½“å‰æ—¶é—´</td>
</tr>
<tr>
<td>duration</td>
<td>åŠ¨ç”»çš„æŒç»­æ—¶é—´,é»˜è®¤ä¸º0</td>
</tr>
<tr>
<td>speed</td>
<td>æ’­æ”¾é€Ÿåº¦ï¼Œé»˜è®¤çš„å€¼ä¸º 1.0.å¦‚æœä½ æ”¹å˜è¿™ä¸ªå€¼ä¸º 2.0,åŠ¨ç”»ä¼šç”¨ 2 å€çš„é€Ÿåº¦æ’­æ”¾ã€‚è¿™æ ·çš„å½±å“å°±æ˜¯ä½¿æŒç»­æ—¶é—´å‡åŠã€‚<br>å¦‚æœä½ æŒ‡å®šçš„æŒç»­æ—¶é—´ä¸º 6 ç§’,é€Ÿåº¦ä¸º 2.0,åŠ¨ç”»å°±ä¼šæ’­æ”¾ 3 ç§’é’Ÿå³ä¸€åŠçš„æŒç»­æ—¶é—´ã€‚</td>
</tr>
<tr>
<td>Autoreverses</td>
<td>è®¾å®šè¿™ä¸ªå±æ€§ä¸º YES æ—¶,åœ¨å®ƒåˆ°è¾¾ç›®çš„åœ°ä¹‹å,<br>åŠ¨ç”»çš„è¿”å›åˆ°å¼€å§‹çš„å€¼,ä»£æ›¿äº†ç›´æ¥è·³è½¬åˆ°å¼€å§‹çš„å€¼ï¼Œè¿‡æ¸¡å¹³æ»‘</td>
</tr>
<tr>
<td>repeatCount</td>
<td>é‡å¤æ¬¡æ•°ï¼Œæ— é™å¾ªç¯å¯ä»¥è®¾ç½®HUGE_VALFæˆ–è€…MAXFLOAT</td>
</tr>
<tr>
<td>repeatDuration</td>
<td>é‡å¤æ—¶é—´</td>
</tr>
<tr>
<td>fillMode</td>
<td>å†³å®šåŠ¨ç”»æ‰§è¡Œå®Œå å¯¹è±¡çš„çŠ¶æ€</td>
</tr>
</tbody>
</table>
<p>å‚è€ƒæ–‡ç« <a href="http://www.cocoachina.com/programmer/20131218/7569.html" target="_blank" rel="external">æ§åˆ¶åŠ¨ç”»æ—¶é—´</a> <br><a href="http://ronnqvi.st/controlling-animation-timing/" target="_blank" rel="external">Controlling Animation Timing</a></p>
<h3 id="CAAnimationâ€”â€”ç®€ä»‹"><a href="#CAAnimationâ€”â€”ç®€ä»‹" class="headerlink" title="CAAnimationâ€”â€”ç®€ä»‹"></a>CAAnimationâ€”â€”ç®€ä»‹</h3><p>æ˜¯æ‰€æœ‰åŠ¨ç”»å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æ§åˆ¶åŠ¨ç”»çš„æŒç»­æ—¶é—´å’Œé€Ÿåº¦ï¼Œæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨å®ƒå…·ä½“çš„å­ç±»ã€‚</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>removedOnCompletion</td>
<td>é»˜è®¤ä¸ºYESï¼Œä»£è¡¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åå°±ä»å›¾å±‚ä¸Šç§»é™¤ï¼Œ<br>å›¾å½¢ä¼šæ¢å¤åˆ°åŠ¨ç”»æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚<br>å¦‚æœæƒ³è®©å›¾å±‚ä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œåçš„çŠ¶æ€ï¼Œ<br>é‚£å°±è®¾ç½®ä¸ºNOï¼Œä¸è¿‡è¿˜è¦è®¾ç½®fillModeä¸ºkCAFillModeForwards</td>
</tr>
<tr>
<td>timingFunction</td>
<td>é€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥</td>
</tr>
<tr>
<td>delegate</td>
<td>ä»£ç†,åŒ…å«äº†åŠ¨ç”»å¼€å§‹å’Œç»“æŸçš„å›è°ƒæ–¹æ³•</td>
</tr>
</tbody>
</table>
<p>fillModeå±æ€§çš„è®¾ç½®ï¼š</p>
<ul>
<li><p>kCAFillModeRemoved è¿™ä¸ªæ˜¯é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´å½“åŠ¨ç”»å¼€å§‹å‰å’ŒåŠ¨ç”»ç»“æŸåï¼ŒåŠ¨ç”»å¯¹layeréƒ½æ²¡æœ‰å½±å“ï¼ŒåŠ¨ç”»ç»“æŸåï¼Œlayerä¼šæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€</p>
</li>
<li><p>kCAFillModeForwards å½“åŠ¨ç”»ç»“æŸåï¼Œlayerä¼šä¸€ç›´ä¿æŒç€åŠ¨ç”»æœ€åçš„çŠ¶æ€</p>
</li>
<li><p>kCAFillModeBackwards åœ¨åŠ¨ç”»å¼€å§‹å‰ï¼Œåªéœ€è¦å°†åŠ¨ç”»åŠ å…¥äº†ä¸€ä¸ªlayerï¼Œlayerä¾¿ç«‹å³è¿›å…¥åŠ¨ç”»çš„åˆå§‹çŠ¶æ€å¹¶ç­‰å¾…åŠ¨ç”»å¼€å§‹ã€‚</p>
</li>
<li><p>kCAFillModeBoth è¿™ä¸ªå…¶å®å°±æ˜¯ä¸Šé¢ä¸¤ä¸ªçš„åˆæˆ.åŠ¨ç”»åŠ å…¥åå¼€å§‹ä¹‹å‰ï¼Œlayerä¾¿å¤„äºåŠ¨ç”»åˆå§‹çŠ¶æ€ï¼ŒåŠ¨ç”»ç»“æŸålayerä¿æŒåŠ¨ç”»æœ€åçš„çŠ¶æ€</p>
</li>
</ul>
<p>é€Ÿåº¦æ§åˆ¶å‡½æ•°(CAMediaTimingFunction)ï¼š</p>
<ul>
<li><p>kCAMediaTimingFunctionLinearï¼ˆçº¿æ€§ï¼‰ï¼šåŒ€é€Ÿï¼Œç»™ä½ ä¸€ä¸ªç›¸å¯¹é™æ€çš„æ„Ÿè§‰</p>
</li>
<li><p>kCAMediaTimingFunctionEaseInï¼ˆæ¸è¿›ï¼‰ï¼šåŠ¨ç”»ç¼“æ…¢è¿›å…¥ï¼Œç„¶ååŠ é€Ÿç¦»å¼€</p>
</li>
<li><p>kCAMediaTimingFunctionEaseOutï¼ˆæ¸å‡ºï¼‰ï¼šåŠ¨ç”»å…¨é€Ÿè¿›å…¥ï¼Œç„¶åå‡é€Ÿçš„åˆ°è¾¾ç›®çš„åœ°</p>
</li>
<li><p>kCAMediaTimingFunctionEaseInEaseOutï¼ˆæ¸è¿›æ¸å‡ºï¼‰ï¼šåŠ¨ç”»ç¼“æ…¢çš„è¿›å…¥ï¼Œä¸­é—´åŠ é€Ÿï¼Œç„¶åå‡é€Ÿçš„åˆ°è¾¾ç›®çš„åœ°ã€‚è¿™ä¸ªæ˜¯é»˜è®¤çš„åŠ¨ç”»è¡Œä¸ºã€‚</p>
</li>
</ul>
<h3 id="CAPropertyAnimation"><a href="#CAPropertyAnimation" class="headerlink" title="CAPropertyAnimation"></a>CAPropertyAnimation</h3><p>æ˜¯CAAnimationçš„å­ç±»ï¼Œä¹Ÿæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œè¦æƒ³åˆ›å»ºåŠ¨ç”»å¯¹è±¡ï¼Œåº”è¯¥ä½¿ç”¨å®ƒçš„ä¸¤ä¸ªå­ç±»ï¼šCABasicAnimationå’ŒCAKeyframeAnimationã€‚</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>keyPath</td>
<td>æŒ‡å®šäº†åŠ¨ç”»çš„å…³é”®è·¯å¾„</td>
</tr>
</tbody>
</table>
<h3 id="CATransitionâ€”â€”è½¬åœºåŠ¨ç”»"><a href="#CATransitionâ€”â€”è½¬åœºåŠ¨ç”»" class="headerlink" title="CATransitionâ€”â€”è½¬åœºåŠ¨ç”»"></a>CATransitionâ€”â€”è½¬åœºåŠ¨ç”»</h3><p>CATransitionæ˜¯CAAnimationçš„å­ç±»ï¼Œç”¨äºåšè½¬åœºåŠ¨ç”»ï¼Œèƒ½å¤Ÿä¸ºå±‚æä¾›ç§»å‡ºå±å¹•å’Œç§»å…¥å±å¹•çš„åŠ¨ç”»æ•ˆæœã€‚</p>
<p>UINavigationControllerå°±æ˜¯é€šè¿‡CATransitionå®ç°äº†å°†æ§åˆ¶å™¨çš„è§†å›¾æ¨å…¥å±å¹•çš„åŠ¨ç”»æ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡CATransitionæ¥è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ã€‚</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>åŠ¨ç”»è¿‡æ¸¡ç±»å‹</td>
</tr>
<tr>
<td>subtype</td>
<td>åŠ¨ç”»è¿‡åº¦æ–¹å‘</td>
</tr>
<tr>
<td>startProgress</td>
<td>åŠ¨ç”»èµ·ç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)</td>
</tr>
<tr>
<td>endProgress</td>
<td>åŠ¨ç”»ç»ˆç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)</td>
</tr>
<tr>
<td>addAnimation: forKey:</td>
<td>æŠŠè½¬åœºåŠ¨ç”»æ·»åŠ åˆ°layerä¸Š</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>ç±»å‹å­—ç¬¦ä¸²</th>
<th>æ•ˆæœè¯´æ˜</th>
<th>å¯¹åº”å¸¸é‡    </th>
</tr>
</thead>
<tbody>
<tr>
<td>fade</td>
<td>äº¤å‰æ·¡åŒ–è¿‡æ¸¡</td>
<td>kCATransitionFade    </td>
</tr>
<tr>
<td>push</td>
<td>æ–°è§†å›¾æŠŠæ—§è§†å›¾æ¨å‡ºå»</td>
<td>kCATransitionPush    </td>
</tr>
<tr>
<td>moveIn</td>
<td>æ–°è§†å›¾ç§»åˆ°æ—§è§†å›¾ä¸Šé¢</td>
<td>kCATransitionReveal    </td>
</tr>
<tr>
<td>reveal</td>
<td>å°†æ—§è§†å›¾ç§»å¼€,æ˜¾ç¤ºä¸‹é¢çš„æ–°è§†å›¾</td>
<td>kCATransitionMoveIn    </td>
</tr>
<tr>
<td>cube</td>
<td>ç«‹æ–¹ä½“ç¿»æ»šæ•ˆæœ</td>
<td>ç§æœ‰</td>
</tr>
<tr>
<td>oglFlip</td>
<td>ä¸Šä¸‹å·¦å³ç¿»æ»šæ•ˆæœ</td>
<td>ç§æœ‰</td>
</tr>
<tr>
<td>suckEffect</td>
<td>æ”¶ç¼©æ•ˆæœ,å¦‚ä¸€å—å¸ƒè¢«æŠ½èµ°</td>
<td>ç§æœ‰</td>
</tr>
<tr>
<td>rippleEffect</td>
<td>æ°´æ»´æ•ˆæœ</td>
<td>ç§æœ‰</td>
</tr>
<tr>
<td>pageCurl</td>
<td>å‘ä¸Šç¿»é¡µæ•ˆæœ</td>
<td>ç§æœ‰</td>
</tr>
<tr>
<td>pageUnCurl</td>
<td>å‘ä¸‹ç¿»é¡µæ•ˆæœ</td>
<td>ç§æœ‰</td>
</tr>
<tr>
<td>cameraIrisHollowOpen</td>
<td>ç›¸æœºé•œå¤´æ‰“å¼€æ•ˆæœ</td>
<td>ç§æœ‰        </td>
</tr>
<tr>
<td>cameraIrisHollowClose</td>
<td>ç›¸æœºé•œå¤´å…³é—­æ•ˆæœ</td>
<td>ç§æœ‰        </td>
</tr>
</tbody>
</table>
<h3 id="CABasicAnimationâ€”â€”åŸºæœ¬åŠ¨ç”»"><a href="#CABasicAnimationâ€”â€”åŸºæœ¬åŠ¨ç”»" class="headerlink" title="CABasicAnimationâ€”â€”åŸºæœ¬åŠ¨ç”»"></a>CABasicAnimationâ€”â€”åŸºæœ¬åŠ¨ç”»</h3><p>å±æ€§è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>fromValue</td>
<td>keyPathå¯¹åº”çš„å±æ€§çš„åˆå§‹å€¼</td>
</tr>
<tr>
<td>toValue</td>
<td>keyPathå¯¹åº”çš„å±æ€§çš„ç»“æŸå€¼</td>
</tr>
</tbody>
</table>
<p>åŠ¨ç”»è¿‡ç¨‹è¯´æ˜ï¼š</p>
<p>éšç€åŠ¨ç”»çš„è¿›è¡Œï¼Œåœ¨é•¿åº¦ä¸ºdurationçš„æŒç»­æ—¶é—´å†…ï¼ŒkeyPathç›¸åº”å±æ€§çš„å€¼ä»fromValueæ¸æ¸åœ°å˜ä¸ºtoValueã€‚</p>
<p>keyPathå†…å®¹æ˜¯CALayerçš„å¯ä»¥ç”¨æ¥åˆ¶ä½œåŠ¨ç”»(Animatable)çš„å±æ€§ã€‚åŠ¨ç”»çš„äº§ç”Ÿæ˜¯ç”±äºCABasicAnimationçš„è¿™äº›valuseä½œç”¨åˆ°äº†keyPathï¼Œä¹Ÿå°±æ˜¯CALayerä¸­çš„Animatableç±»å‹çš„å±æ€§ä¸Šï¼Œå¦‚transformï¼Œpositionç­‰ã€‚</p>
<p>å¦‚æœfillMode = kCAFillModeForwardsåŒæ—¶removedOnComletion = NOï¼Œé‚£ä¹ˆåœ¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åï¼Œå›¾å±‚ä¼šä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œåçš„çŠ¶æ€ã€‚ä½†åœ¨å®è´¨ä¸Šï¼Œå›¾å±‚çš„å±æ€§å€¼è¿˜æ˜¯åŠ¨ç”»æ‰§è¡Œå‰çš„åˆå§‹å€¼ï¼Œå¹¶æ²¡æœ‰çœŸæ­£è¢«æ”¹å˜ã€‚</p>
<h3 id="CAKeyframeAnimationâ€”â€”å…³é”®å¸§åŠ¨ç”»"><a href="#CAKeyframeAnimationâ€”â€”å…³é”®å¸§åŠ¨ç”»" class="headerlink" title="CAKeyframeAnimationâ€”â€”å…³é”®å¸§åŠ¨ç”»"></a>CAKeyframeAnimationâ€”â€”å…³é”®å¸§åŠ¨ç”»</h3><p>å…³é”®å¸§åŠ¨ç”»ï¼Œä¹Ÿæ˜¯CAPropertyAnimationçš„å­ç±»ï¼Œä¸CABasicAnimationçš„åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li>CABasicAnimationåªèƒ½ä»ä¸€ä¸ªæ•°å€¼ï¼ˆfromValueï¼‰å˜åˆ°å¦ä¸€ä¸ªæ•°å€¼ï¼ˆtoValueï¼‰ï¼Œè€ŒCAKeyframeAnimationä¼šä½¿ç”¨ä¸€ä¸ªNSArrayä¿å­˜è¿™äº›æ•°å€¼</li>
<li>CABasicAnimationå¯çœ‹åšæ˜¯åªæœ‰2ä¸ªå…³é”®å¸§çš„CAKeyframeAnimation</li>
</ul>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>values</td>
<td>NSArrayå¯¹è±¡ã€‚é‡Œé¢çš„å…ƒç´ ç§°ä¸ºâ€œå…³é”®å¸§â€(keyframe)ã€‚<br>åŠ¨ç”»å¯¹è±¡ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´ï¼ˆdurationï¼‰å†…ï¼Œä¾æ¬¡æ˜¾ç¤ºvaluesæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å¸§</td>
</tr>
<tr>
<td>path</td>
<td>å¯ä»¥è®¾ç½®ä¸€ä¸ªCGPathRefã€CGMutablePathRefï¼Œè®©å›¾å±‚æŒ‰ç…§è·¯å¾„è½¨è¿¹ç§»åŠ¨ã€‚<br>pathåªå¯¹CALayerçš„anchorPointå’Œpositionèµ·ä½œç”¨ã€‚å¦‚æœè®¾ç½®äº†pathï¼Œé‚£ä¹ˆvalueså°†è¢«å¿½ç•¥</td>
</tr>
<tr>
<td>keyTimes</td>
<td>å¯ä»¥ä¸ºå¯¹åº”çš„å…³é”®å¸§æŒ‡å®šå¯¹åº”çš„æ—¶é—´ç‚¹ï¼Œå…¶å–å€¼èŒƒå›´ä¸º0åˆ°1.0ï¼Œ<br>keyTimesä¸­çš„æ¯ä¸€ä¸ªæ—¶é—´å€¼éƒ½å¯¹åº”valuesä¸­çš„æ¯ä¸€å¸§ã€‚<br>å¦‚æœæ²¡æœ‰è®¾ç½®keyTimesï¼Œå„ä¸ªå…³é”®å¸§çš„æ—¶é—´æ˜¯å¹³åˆ†çš„</td>
</tr>
</tbody>
</table>
<h3 id="CAAnimationGroupâ€”â€”åŠ¨ç”»ç»„"><a href="#CAAnimationGroupâ€”â€”åŠ¨ç”»ç»„" class="headerlink" title="CAAnimationGroupâ€”â€”åŠ¨ç”»ç»„"></a>CAAnimationGroupâ€”â€”åŠ¨ç”»ç»„</h3><p>åŠ¨ç”»ç»„ï¼Œæ˜¯CAAnimationçš„å­ç±»ï¼Œå¯ä»¥ä¿å­˜ä¸€ç»„åŠ¨ç”»å¯¹è±¡ï¼Œå°†CAAnimationGroupå¯¹è±¡åŠ å…¥å±‚åï¼Œç»„ä¸­æ‰€æœ‰åŠ¨ç”»å¯¹è±¡å¯ä»¥åŒæ—¶å¹¶å‘è¿è¡Œã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ç»„åŠ¨ç”»å¯¹è±¡æ˜¯åŒæ—¶è¿è¡Œçš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®åŠ¨ç”»å¯¹è±¡çš„beginTimeå±æ€§æ¥æ›´æ”¹åŠ¨ç”»çš„å¼€å§‹æ—¶é—´ã€‚</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>animations</td>
<td>ç”¨æ¥ä¿å­˜ä¸€ç»„åŠ¨ç”»å¯¹è±¡çš„NSArray</td>
</tr>
</tbody>
</table>
<h3 id="CASpringAnimation-å¼¹æ€§åŠ¨ç”»"><a href="#CASpringAnimation-å¼¹æ€§åŠ¨ç”»" class="headerlink" title="CASpringAnimation å¼¹æ€§åŠ¨ç”»"></a>CASpringAnimation å¼¹æ€§åŠ¨ç”»</h3><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>mass</td>
<td>è´¨é‡ï¼Œå½±å“å›¾å±‚è¿åŠ¨æ—¶çš„å¼¹ç°§æƒ¯æ€§ï¼Œè´¨é‡è¶Šå¤§ï¼Œ<br>å¼¹ç°§æ‹‰ä¼¸å’Œå‹ç¼©çš„å¹…åº¦è¶Šå¤§</td>
</tr>
<tr>
<td>stiffnes</td>
<td>åˆšåº¦ç³»æ•°(åŠ²åº¦ç³»æ•°/å¼¹æ€§ç³»æ•°)ï¼Œåˆšåº¦ç³»æ•°è¶Šå¤§ï¼Œ<br>å½¢å˜äº§ç”Ÿçš„åŠ›å°±è¶Šå¤§ï¼Œè¿åŠ¨è¶Šå¿«</td>
</tr>
<tr>
<td>damping</td>
<td>é˜»å°¼ç³»æ•°ï¼Œé˜»æ­¢å¼¹ç°§ä¼¸ç¼©çš„ç³»æ•°ï¼Œé˜»å°¼ç³»æ•°è¶Šå¤§ï¼Œåœæ­¢è¶Šå¿«</td>
</tr>
<tr>
<td>initivelocity</td>
<td>åˆå§‹é€Ÿç‡ï¼ŒåŠ¨ç”»è§†å›¾çš„åˆå§‹é€Ÿåº¦å¤§å°;é€Ÿç‡ä¸ºæ­£æ•°æ—¶ï¼Œ<br>é€Ÿåº¦æ–¹å‘ä¸è¿åŠ¨æ–¹å‘ä¸€è‡´ï¼Œé€Ÿç‡ä¸ºè´Ÿæ•°æ—¶ï¼Œé€Ÿåº¦æ–¹å‘ä¸è¿åŠ¨æ–¹å‘ç›¸å</td>
</tr>
<tr>
<td>settingDuration</td>
<td>ç»“ç®—æ—¶é—´(æ ¹æ®åŠ¨ç”»ç›¸å…³å‚æ•°ä¼°ç®—å¼¹ç°§å¼€å§‹è¿åŠ¨åˆ°åœæ­¢çš„æ—¶é—´ï¼Œ<br>åŠ¨ç”»è®¾ç½®çš„æ—¶é—´æœ€å¥½æ ¹æ®æ­¤æ—¶é—´æ¥è®¾ç½®)</td>
</tr>
</tbody>
</table>
<p>CASpringAnimationæ˜¯ios9åŠä»¥ä¸Šç‰ˆæœ¬æ‰å¯ä»¥ä½¿ç”¨ï¼Œæƒ³è¦é€‚é…ios9ä»¥å‰ç‰ˆæœ¬çš„è¯  éœ€è¦è‡ªå·±åŠ¨æ‰‹æ¥å®Œæˆå¼¹æ€§åŠ¨ç”»</p>
<p>é˜»å°¼éœ‡è¡</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-b927346e11283948.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="496px-Damped_oscillation_graph.svg.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-6e299b7a4934bdfe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="D103F63B-50DE-4ED6-97AA-10FD39E4B5DB.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-29a97b4355b568b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="14981914785849.png"></p>
<p>å‚è€ƒèµ„æ–™<a href="http://kittenyang.com/deformationandgooey/" target="_blank" rel="external">ç²˜æ€§åŠ¨ç”»</a></p>
<p><a href="http://kittenyang.com/deformationandgooey/" target="_blank" rel="external">æŸ¥çœ‹æ•°å­¦å‡½æ•°å¯¹åº”çš„å›¾åƒçš„ç½‘ç«™</a></p>
<h3 id="CAKeyframeAnimation-å…³é”®å¸§åŠ¨ç”»"><a href="#CAKeyframeAnimation-å…³é”®å¸§åŠ¨ç”»" class="headerlink" title="CAKeyframeAnimation å…³é”®å¸§åŠ¨ç”»"></a>CAKeyframeAnimation å…³é”®å¸§åŠ¨ç”»</h3><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>values</td>
<td>æŒ‡å®šå…³é”®ç‚¹çš„å€¼</td>
</tr>
<tr>
<td>path</td>
<td>å¯ä»¥è®¾ç½®ä¸€ä¸ªCGPathRef / CGMutablePathRefï¼Œè®©å±‚è·Ÿç€è·¯å¾„ç§»åŠ¨ã€‚<br>pathåªå¯¹CALayerçš„anchorPointå’Œpositionèµ·ä½œç”¨ã€‚å¦‚æœä½ è®¾ç½®äº†pathï¼Œ<br>é‚£ä¹ˆvalueså°†è¢«å¿½ç•¥.</td>
</tr>
<tr>
<td>keyTimes</td>
<td>æ˜¯èµ°åˆ°æŸä¸€ä¸ªå…³é”®ç‚¹èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”(0ï½1)ï¼ŒkeyTimesä¸­çš„æ¯ä¸€ä¸ª<br>æ—¶é—´å€¼éƒ½å¯¹åº”valuesä¸­çš„æ¯ä¸€å¸§(ä¸¤ä¸ªæ•°ç»„çš„ä¸ªæ•°å¿…é¡»ä¸€è‡´)ï¼Œ<br>å½“keyTimesæ²¡æœ‰è®¾ç½®çš„æ—¶å€™,å„ä¸ªå…³é”®å¸§çš„æ—¶é—´æ˜¯å¹³åˆ†çš„ã€‚</td>
</tr>
<tr>
<td>é€šè¿‡ è®¾ç½®ä¸åŒçš„å±æ€§å€¼values åŠ¨ç”»</td>
<td>å…³é”®å¸§åŠ¨ç”»åˆ›å»ºç¬¬ä¸€ç§æ–¹å¼</td>
</tr>
<tr>
<td>é€šè¿‡ ç»˜åˆ¶è·¯å¾„path åŠ¨ç”»</td>
<td>å…³é”®å¸§åŠ¨ç”»åˆ›å»ºç¬¬äºŒç§æ–¹å¼</td>
</tr>
</tbody>
</table>
<h4 id="AnimationWithKeyPathçš„å€¼"><a href="#AnimationWithKeyPathçš„å€¼" class="headerlink" title="AnimationWithKeyPathçš„å€¼"></a>AnimationWithKeyPathçš„å€¼</h4><p>å±æ€§åé¢çš„æè¿°ä¸­å¸¦æœ‰Animatableçš„éƒ½å¯ä»¥ä½œä¸ºkeyPath<br>å¦‚CAlayerçš„transformï¼Œpositionç­‰ç­‰</p>
<h3 id="æ°´æ³¢åŠ¨ç”»"><a href="#æ°´æ³¢åŠ¨ç”»" class="headerlink" title="æ°´æ³¢åŠ¨ç”»"></a>æ°´æ³¢åŠ¨ç”»</h3><p>æ­£å¼¦å‹å‡½æ•°è§£æå¼ï¼šy=Asinï¼ˆÏ‰x+Ï†ï¼‰+h<br>å„å¸¸æ•°å€¼å¯¹å‡½æ•°å›¾åƒçš„å½±å“ï¼š<br>Ï†ï¼ˆåˆç›¸ä½ï¼‰ï¼šå†³å®šæ³¢å½¢ä¸Xè½´ä½ç½®å…³ç³»æˆ–æ¨ªå‘ç§»åŠ¨è·ç¦»ï¼ˆå·¦åŠ å³å‡ï¼‰<br>Ï‰ï¼šå†³å®šå‘¨æœŸï¼ˆæœ€å°æ­£å‘¨æœŸT=2Ï€/|Ï‰|ï¼‰<br>Aï¼šå†³å®šå³°å€¼ï¼ˆå³çºµå‘æ‹‰ä¼¸å‹ç¼©çš„å€æ•°ï¼‰<br>hï¼šè¡¨ç¤ºæ³¢å½¢åœ¨Yè½´çš„ä½ç½®å…³ç³»æˆ–çºµå‘ç§»åŠ¨è·ç¦»ï¼ˆä¸ŠåŠ ä¸‹å‡ï¼‰</p>
<h3 id="CATransFrom3D"><a href="#CATransFrom3D" class="headerlink" title="CATransFrom3D"></a>CATransFrom3D</h3><p>iOSè®¾å¤‡ä¸Šï¼Œæ˜¯æŒ‰ç…§å·¦æ‰‹ç³»çš„ä¸‰ç»´ç©ºé—´ï¼Œå³æ­£é¢é¢å¯¹è®¾å¤‡å±å¹•ï¼Œåæ ‡åŸç‚¹ä»å±å¹•å·¦ä¸Šæ–¹èµ·ï¼Œxè½´æŒ‡å‘å³æ–¹ï¼Œyè½´æŒ‡å‘ä¸‹æ–¹ï¼Œzè½´ä¸ºå±å¹•æŒ‡å‘çœ¼çƒã€‚è€ŒmacOSä¸Šæ˜¯å³æ‰‹ç³»ï¼ŒåŸç‚¹æ˜¯å±å¹•å·¦ä¸‹è§’ï¼Œxè½´æŒ‡å‘å³æ–¹ï¼Œyè½´æŒ‡å‘ä¸Šæ–¹ï¼ˆç›¸åï¼‰ï¼Œzè½´åŒæ ·ä¸ºå±å¹•æŒ‡å‘çœ¼çƒï¼Œè¦æ³¨æ„</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-464e079533c43c0d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="5c010c6b630ab7aa0892428016d7e.jpeg"></p>
<p>3Dæ•ˆæœä¸­å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ã€éƒ½æ˜¯é€šè¿‡çŸ©é˜µçš„å˜æ¢å¾—åˆ°çš„</p>
<pre><code>CATransform3Dç»“æ„ä½“
struct CATransform3D
{
  CGFloat m11, m12, m13, m14;
  CGFloat m21, m22, m23, m24;
  CGFloat m31, m32, m33, m34;
  CGFloat m41, m42, m43, m44;
};
</code></pre><p>è¿™ä¸ªç»“æ„ä½“å¯¹åº”è¿™æ ·ä¸€ä¸ª4x4çš„çŸ©é˜µ</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-a8d66f0e42d746ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="C8B0A3D9-796D-40BF-A5A8-7AB02E249230.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-8375d1ba7bb0713f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="4196_131230104304_1.png"></p>
<p>è¿™é‡Œçš„çŸ©é˜µå˜æ¢ä¸»è¦æ˜¯ä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜ï¼Œå°†åæ ‡å‘é‡ä¹˜ä»¥å˜æ¢çš„çŸ©é˜µï¼Œå¾—åˆ°å˜æ¢åçš„åæ ‡ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-0e294043de100831.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="4196_131230104316_1.png"></p>
<p>1.å¹³ç§»</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-d48100586f04c975.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2766C09E-7B01-48C2-B42B-77A1E56B29FB.png"></p>
<pre><code>å¯¹åº”API:
CATransform3D CATransform3DMakeTranslation(CGFloat tx, CGFloat ty, CGFloat tz);
</code></pre><p>2.ç¼©æ”¾</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-385974b615a1fec6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="BDCEC978-9B92-4149-8530-148A80C22C6B.png"></p>
<pre><code>å¯¹åº”API:
CATransform3D CATransform3DMakeScale(CGFloat sx, CGFloat sy, CGFloat sz);
</code></pre><p>3.æ—‹è½¬</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1716542-816022e915e29bf0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="59C76777-3EEB-4887-9C0E-18E6B3163D4E.png"></p>
<p>4.ä¸ºä»€ä¹ˆè®¾ç½®m34<br>å½“æˆ‘ä»¬è¦å®ç°è¿‘å¤§è¿œå°çš„æ•ˆæœçš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆåªéœ€è¦è®¾ç½®m34çš„å€¼å°±å¯ä»¥äº†ï¼Ÿ</p>
<p>é€è§†æŠ•å½±</p>
<pre><code>çœ¼ç›ä»å®é™…å¹³è¡Œçš„ä¸¤æ¡çº¿æ®µå‘å‡ºï¼ˆç›¸å½“äºzè½´æ–¹å‘çš„å‘é‡ï¼‰ï¼Œäººçœ¼çœ‹èµ·æ¥ä¼šç›¸äº¤äºä¸€ç‚¹ä¸Šï¼ˆç„¦ç‚¹ï¼ŒFocal pointï¼‰ï¼Œè¿™æ‰äº§ç”Ÿäº†3Dæ„Ÿ
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/1716542-15471fcddd4ea19f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="a7ed0efe4aebcddaef0d090c631b4.jpeg.png"></p>
<p>m34 = -1 / d (då€¼çš„æ˜¯äººçœ¼åˆ°å±å¹•çš„è·ç¦»,å€¼ä¸€èˆ¬åœ¨500 - 1000ä¹‹é—´æ¯”è¾ƒåˆé€‚)ï¼›</p>
<p><a href="http://dreampiggy.com/2016/11/01/core-animation-3dfang-she-bian-huan-zhi-shi/" target="_blank" rel="external">Core Animation 3Dä»¿å°„å˜æ¢çŸ¥è¯†</a></p>
<h3 id="ios7ä¹‹åæä¾›çš„ç‰©ç†åŠ¨æ•ˆ"><a href="#ios7ä¹‹åæä¾›çš„ç‰©ç†åŠ¨æ•ˆ" class="headerlink" title="ios7ä¹‹åæä¾›çš„ç‰©ç†åŠ¨æ•ˆ"></a>ios7ä¹‹åæä¾›çš„ç‰©ç†åŠ¨æ•ˆ</h3><p>UIGravityBehavior é‡åŠ›<br>UICollisionBehavior ç¢°æ’<br>UISnapBehavior    å¸é™„<br>UIPushBehavior    æ¨åŠ›<br>UIAttachmentBehavior å…³è”</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  

  

  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="ä¸€ä¸ªé¢å‘ç¨‹åºå‘˜äº¤æµåˆ†äº«çš„æ–°ä¸€ä»£ç¤¾åŒº">ç å†œåœˆ</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="å¾®åš"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> Â© 2017 
		
		<a href="/about" target="_blank" title="ZT0526">ZT0526</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
